<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>13&nbsp; Linear models with two categorical X – Factorial linear models (“two-way ANOVA”) – Statistics for the Experimental Bench Biologist</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/lmm.html" rel="next">
<link href="../chapters/multiple-testing.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/two-factors.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Statistics for the Experimental Bench Biologist</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Analyzing experimental data with a linear model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started – R Projects and R Markdown</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/reading-writing-wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data – Reading, Wrangling, and Writing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/plotting-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Plotting models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/uncertainty-sd-and-se.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Uncertainty – Standard Deviations, Standard Errors, and Confidence Intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/p-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">P-values</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/inference-errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Errors in inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/intro-stat-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">An introduction to linear models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/continuous_x.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Linear models with a single, continuous <em>X</em> (“linear regression”)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/one-factor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/model-checking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model checking</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/multiple-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Multiple tests – why and when to adjust <em>p</em>-values</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/two-factors.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/lmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Models for non-independence – linear mixed models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Linear models for counts, binary responses, skewed responses, and proportions – Generalized Linear Models</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#a-linear-model-with-crossed-factors-estimates-interaction-effects" id="toc-a-linear-model-with-crossed-factors-estimates-interaction-effects" class="nav-link active" data-scroll-target="#a-linear-model-with-crossed-factors-estimates-interaction-effects"><span class="header-section-number">13.1</span> A linear model with crossed factors estimates interaction effects</a>
  <ul>
  <li><a href="#an-interaction-is-a-difference-in-simple-effects" id="toc-an-interaction-is-a-difference-in-simple-effects" class="nav-link" data-scroll-target="#an-interaction-is-a-difference-in-simple-effects"><span class="header-section-number">13.1.1</span> An interaction is a difference in simple effects</a></li>
  <li><a href="#a-linear-model-with-crossed-factors-includes-interaction-effects" id="toc-a-linear-model-with-crossed-factors-includes-interaction-effects" class="nav-link" data-scroll-target="#a-linear-model-with-crossed-factors-includes-interaction-effects"><span class="header-section-number">13.1.2</span> A linear model with crossed factors includes interaction effects</a></li>
  <li><a href="#factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature" id="toc-factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature" class="nav-link" data-scroll-target="#factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature"><span class="header-section-number">13.1.3</span> factorial experiments are frequently analyzed as flattened linear models in the experimental biology literature</a></li>
  </ul></li>
  <li><a href="#example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data" id="toc-example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data" class="nav-link" data-scroll-target="#example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data"><span class="header-section-number">13.2</span> Example 1 – Estimation of a treatment effect relative to a control effect (“Something different”) (Experiment 2j glucose uptake data)</a>
  <ul>
  <li><a href="#twoway-understand1" id="toc-twoway-understand1" class="nav-link" data-scroll-target="#twoway-understand1"><span class="header-section-number">13.2.1</span> Understand the experimental design</a></li>
  <li><a href="#fit-the-linear-model" id="toc-fit-the-linear-model" class="nav-link" data-scroll-target="#fit-the-linear-model"><span class="header-section-number">13.2.2</span> Fit the linear model</a></li>
  <li><a href="#twoway-exp2j-inf" id="toc-twoway-exp2j-inf" class="nav-link" data-scroll-target="#twoway-exp2j-inf"><span class="header-section-number">13.2.3</span> Inference</a></li>
  <li><a href="#plot-the-model" id="toc-plot-the-model" class="nav-link" data-scroll-target="#plot-the-model"><span class="header-section-number">13.2.4</span> Plot the model</a></li>
  <li><a href="#alternaplot-the-model" id="toc-alternaplot-the-model" class="nav-link" data-scroll-target="#alternaplot-the-model"><span class="header-section-number">13.2.5</span> alternaPlot the model</a></li>
  </ul></li>
  <li><a href="#understanding-the-linear-model-with-crossed-factors-1" id="toc-understanding-the-linear-model-with-crossed-factors-1" class="nav-link" data-scroll-target="#understanding-the-linear-model-with-crossed-factors-1"><span class="header-section-number">13.3</span> Understanding the linear model with crossed factors 1</a>
  <ul>
  <li><a href="#twoway-what-coefs-are" id="toc-twoway-what-coefs-are" class="nav-link" data-scroll-target="#twoway-what-coefs-are"><span class="header-section-number">13.3.1</span> What the coefficients are</a></li>
  <li><a href="#the-interaction-effect-is-something-different" id="toc-the-interaction-effect-is-something-different" class="nav-link" data-scroll-target="#the-interaction-effect-is-something-different"><span class="header-section-number">13.3.2</span> The interaction effect is something different</a></li>
  <li><a href="#why-we-want-to-compare-the-treatment-effect-to-a-control-effect" id="toc-why-we-want-to-compare-the-treatment-effect-to-a-control-effect" class="nav-link" data-scroll-target="#why-we-want-to-compare-the-treatment-effect-to-a-control-effect"><span class="header-section-number">13.3.3</span> Why we want to compare the treatment effect to a control effect</a></li>
  <li><a href="#the-order-of-the-factors-in-the-model-tells-the-same-story-differently" id="toc-the-order-of-the-factors-in-the-model-tells-the-same-story-differently" class="nav-link" data-scroll-target="#the-order-of-the-factors-in-the-model-tells-the-same-story-differently"><span class="header-section-number">13.3.4</span> The order of the factors in the model tells the same story differently</a></li>
  <li><a href="#power-for-the-interaction-effect-is-less-than-that-for-simple-effects" id="toc-power-for-the-interaction-effect-is-less-than-that-for-simple-effects" class="nav-link" data-scroll-target="#power-for-the-interaction-effect-is-less-than-that-for-simple-effects"><span class="header-section-number">13.3.5</span> Power for the interaction effect is less than that for simple effects</a></li>
  <li><a href="#planned-comparisons-vs.-post-hoc-tests" id="toc-planned-comparisons-vs.-post-hoc-tests" class="nav-link" data-scroll-target="#planned-comparisons-vs.-post-hoc-tests"><span class="header-section-number">13.3.6</span> Planned comparisons vs.&nbsp;post-hoc tests</a></li>
  </ul></li>
  <li><a href="#example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data" id="toc-example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data" class="nav-link" data-scroll-target="#example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data"><span class="header-section-number">13.4</span> Example 2: Estimation of the effect of background condition on an effect (“it depends”) (Experiment 3e lesian area data)</a>
  <ul>
  <li><a href="#understand-the-experimental-design" id="toc-understand-the-experimental-design" class="nav-link" data-scroll-target="#understand-the-experimental-design"><span class="header-section-number">13.4.1</span> Understand the experimental design</a></li>
  <li><a href="#fit-the-linear-model-1" id="toc-fit-the-linear-model-1" class="nav-link" data-scroll-target="#fit-the-linear-model-1"><span class="header-section-number">13.4.2</span> Fit the linear model</a></li>
  <li><a href="#check-the-model" id="toc-check-the-model" class="nav-link" data-scroll-target="#check-the-model"><span class="header-section-number">13.4.3</span> Check the model</a></li>
  <li><a href="#inference-from-the-model" id="toc-inference-from-the-model" class="nav-link" data-scroll-target="#inference-from-the-model"><span class="header-section-number">13.4.4</span> Inference from the model</a></li>
  <li><a href="#plot-the-model-1" id="toc-plot-the-model-1" class="nav-link" data-scroll-target="#plot-the-model-1"><span class="header-section-number">13.4.5</span> Plot the model</a></li>
  <li><a href="#alternaplot-the-model-1" id="toc-alternaplot-the-model-1" class="nav-link" data-scroll-target="#alternaplot-the-model-1"><span class="header-section-number">13.4.6</span> alternaPlot the model</a></li>
  </ul></li>
  <li><a href="#understanding-the-linear-model-with-crossed-factors-2" id="toc-understanding-the-linear-model-with-crossed-factors-2" class="nav-link" data-scroll-target="#understanding-the-linear-model-with-crossed-factors-2"><span class="header-section-number">13.5</span> Understanding the linear model with crossed factors 2</a>
  <ul>
  <li><a href="#twoway-marginal-means" id="toc-twoway-marginal-means" class="nav-link" data-scroll-target="#twoway-marginal-means"><span class="header-section-number">13.5.1</span> Conditional and marginal means</a></li>
  <li><a href="#simple-conditional-effects" id="toc-simple-conditional-effects" class="nav-link" data-scroll-target="#simple-conditional-effects"><span class="header-section-number">13.5.2</span> Simple (conditional) effects</a></li>
  <li><a href="#sec-twoway-marginal-effects" id="toc-sec-twoway-marginal-effects" class="nav-link" data-scroll-target="#sec-twoway-marginal-effects"><span class="header-section-number">13.5.3</span> Marginal effects</a></li>
  <li><a href="#the-additive-model" id="toc-the-additive-model" class="nav-link" data-scroll-target="#the-additive-model"><span class="header-section-number">13.5.4</span> The additive model</a></li>
  <li><a href="#twoway-reduce" id="toc-twoway-reduce" class="nav-link" data-scroll-target="#twoway-reduce"><span class="header-section-number">13.5.5</span> Reduce models for the right reason</a></li>
  <li><a href="#the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird" id="toc-the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird" class="nav-link" data-scroll-target="#the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird"><span class="header-section-number">13.5.6</span> The marginal means of an additive linear model with two factors can be weird</a></li>
  </ul></li>
  <li><a href="#example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data" id="toc-example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data" class="nav-link" data-scroll-target="#example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data"><span class="header-section-number">13.6</span> Example 3: Estimation of synergy (“More than the sum of the parts”) (Experiment 1c JA data)</a>
  <ul>
  <li><a href="#examine-the-data" id="toc-examine-the-data" class="nav-link" data-scroll-target="#examine-the-data"><span class="header-section-number">13.6.1</span> Examine the data</a></li>
  <li><a href="#fit-the-model" id="toc-fit-the-model" class="nav-link" data-scroll-target="#fit-the-model"><span class="header-section-number">13.6.2</span> Fit the model</a></li>
  <li><a href="#model-check" id="toc-model-check" class="nav-link" data-scroll-target="#model-check"><span class="header-section-number">13.6.3</span> Model check</a></li>
  <li><a href="#inference-from-the-model-1" id="toc-inference-from-the-model-1" class="nav-link" data-scroll-target="#inference-from-the-model-1"><span class="header-section-number">13.6.4</span> Inference from the model</a></li>
  <li><a href="#plot-the-model-2" id="toc-plot-the-model-2" class="nav-link" data-scroll-target="#plot-the-model-2"><span class="header-section-number">13.6.5</span> Plot the model</a></li>
  <li><a href="#alternative-plot" id="toc-alternative-plot" class="nav-link" data-scroll-target="#alternative-plot"><span class="header-section-number">13.6.6</span> Alternative plot</a></li>
  </ul></li>
  <li><a href="#understanding-the-linear-model-with-crossed-factors-3" id="toc-understanding-the-linear-model-with-crossed-factors-3" class="nav-link" data-scroll-target="#understanding-the-linear-model-with-crossed-factors-3"><span class="header-section-number">13.7</span> Understanding the linear model with crossed factors 3</a>
  <ul>
  <li><a href="#thinking-about-the-coefficients-of-the-linear-model" id="toc-thinking-about-the-coefficients-of-the-linear-model" class="nav-link" data-scroll-target="#thinking-about-the-coefficients-of-the-linear-model"><span class="header-section-number">13.7.1</span> Thinking about the coefficients of the linear model</a></li>
  </ul></li>
  <li><a href="#issues-in-inference" id="toc-issues-in-inference" class="nav-link" data-scroll-target="#issues-in-inference"><span class="header-section-number">13.8</span> Issues in inference</a>
  <ul>
  <li><a href="#for-pairwise-inference-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model-but" id="toc-for-pairwise-inference-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model-but" class="nav-link" data-scroll-target="#for-pairwise-inference-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model-but"><span class="header-section-number">13.8.1</span> For pairwise inference, it doesn’t matter if you fit a factorial or a flattened linear model, but…</a></li>
  <li><a href="#for-interaction-interaction-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model-but" id="toc-for-interaction-interaction-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model-but" class="nav-link" data-scroll-target="#for-interaction-interaction-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model-but"><span class="header-section-number">13.8.2</span> For interaction interaction, it doesn’t matter if you fit a factorial or a flattened linear model, but…</a></li>
  <li><a href="#twoway-multiple-tests" id="toc-twoway-multiple-tests" class="nav-link" data-scroll-target="#twoway-multiple-tests"><span class="header-section-number">13.8.3</span> Adjusting <em>p</em>-values for multiple tests</a></li>
  </ul></li>
  <li><a href="#two-way-anova" id="toc-two-way-anova" class="nav-link" data-scroll-target="#two-way-anova"><span class="header-section-number">13.9</span> Two-way ANOVA</a>
  <ul>
  <li><a href="#how-to-read-a-two-way-anova-table" id="toc-how-to-read-a-two-way-anova-table" class="nav-link" data-scroll-target="#how-to-read-a-two-way-anova-table"><span class="header-section-number">13.9.1</span> How to read a two-way ANOVA table</a></li>
  <li><a href="#what-do-the-main-effects-in-an-anova-table-mean" id="toc-what-do-the-main-effects-in-an-anova-table-mean" class="nav-link" data-scroll-target="#what-do-the-main-effects-in-an-anova-table-mean"><span class="header-section-number">13.9.2</span> What do the main effects in an ANOVA table mean?</a></li>
  </ul></li>
  <li><a href="#more-issues-in-inference" id="toc-more-issues-in-inference" class="nav-link" data-scroll-target="#more-issues-in-inference"><span class="header-section-number">13.10</span> More issues in inference</a>
  <ul>
  <li><a href="#longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova" id="toc-longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova" class="nav-link" data-scroll-target="#longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova"><span class="header-section-number">13.10.1</span> Longitudinal experiments – include Time as a random factor (better than repeated measures ANOVA)</a></li>
  </ul></li>
  <li><a href="#working-in-r" id="toc-working-in-r" class="nav-link" data-scroll-target="#working-in-r"><span class="header-section-number">13.11</span> Working in R</a>
  <ul>
  <li><a href="#model-formula" id="toc-model-formula" class="nav-link" data-scroll-target="#model-formula"><span class="header-section-number">13.11.1</span> Model formula</a></li>
  <li><a href="#using-the-emmeans-function" id="toc-using-the-emmeans-function" class="nav-link" data-scroll-target="#using-the-emmeans-function"><span class="header-section-number">13.11.2</span> Using the emmeans function</a>
  <ul class="collapse">
  <li><a href="#conditional-means-table" id="toc-conditional-means-table" class="nav-link" data-scroll-target="#conditional-means-table"><span class="header-section-number">13.11.2.1</span> Conditional means table</a></li>
  <li><a href="#marginal-means" id="toc-marginal-means" class="nav-link" data-scroll-target="#marginal-means"><span class="header-section-number">13.11.2.2</span> Marginal means</a></li>
  </ul></li>
  <li><a href="#contrasts" id="toc-contrasts" class="nav-link" data-scroll-target="#contrasts"><span class="header-section-number">13.11.3</span> Contrasts</a>
  <ul class="collapse">
  <li><a href="#twoway-working-planned" id="toc-twoway-working-planned" class="nav-link" data-scroll-target="#twoway-working-planned"><span class="header-section-number">13.11.3.1</span> Planned contrasts</a></li>
  <li><a href="#all-pairwise-effects" id="toc-all-pairwise-effects" class="nav-link" data-scroll-target="#all-pairwise-effects"><span class="header-section-number">13.11.3.2</span> All pairwise effects</a></li>
  <li><a href="#simple-effects" id="toc-simple-effects" class="nav-link" data-scroll-target="#simple-effects"><span class="header-section-number">13.11.3.3</span> Simple effects</a></li>
  <li><a href="#twoway-working-ixn" id="toc-twoway-working-ixn" class="nav-link" data-scroll-target="#twoway-working-ixn"><span class="header-section-number">13.11.3.4</span> Interaction contrasts</a></li>
  <li><a href="#method-argument" id="toc-method-argument" class="nav-link" data-scroll-target="#method-argument"><span class="header-section-number">13.11.3.5</span> Method argument</a></li>
  <li><a href="#adjustment-for-multiple-tests" id="toc-adjustment-for-multiple-tests" class="nav-link" data-scroll-target="#adjustment-for-multiple-tests"><span class="header-section-number">13.11.3.6</span> Adjustment for multiple tests</a></li>
  </ul></li>
  <li><a href="#practice-safe-anova" id="toc-practice-safe-anova" class="nav-link" data-scroll-target="#practice-safe-anova"><span class="header-section-number">13.11.4</span> Practice safe ANOVA</a>
  <ul class="collapse">
  <li><a href="#the-afex-aov_4-function" id="toc-the-afex-aov_4-function" class="nav-link" data-scroll-target="#the-afex-aov_4-function"><span class="header-section-number">13.11.4.1</span> The afex aov_4 function</a></li>
  <li><a href="#twoway-car-anova" id="toc-twoway-car-anova" class="nav-link" data-scroll-target="#twoway-car-anova"><span class="header-section-number">13.11.4.2</span> The car Anova function</a></li>
  </ul></li>
  <li><a href="#better-to-avoid-these" id="toc-better-to-avoid-these" class="nav-link" data-scroll-target="#better-to-avoid-these"><span class="header-section-number">13.11.5</span> Better to avoid these</a></li>
  </ul></li>
  <li><a href="#hidden-code" id="toc-hidden-code" class="nav-link" data-scroll-target="#hidden-code"><span class="header-section-number">13.12</span> Hidden Code</a>
  <ul>
  <li><a href="#import-exp2j-example-1" id="toc-import-exp2j-example-1" class="nav-link" data-scroll-target="#import-exp2j-example-1"><span class="header-section-number">13.12.1</span> Import exp2j (Example 1)</a></li>
  <li><a href="#import-exp3e-lesian-area-data-example-2" id="toc-import-exp3e-lesian-area-data-example-2" class="nav-link" data-scroll-target="#import-exp3e-lesian-area-data-example-2"><span class="header-section-number">13.12.2</span> Import exp3e lesian area data (Example 2)</a></li>
  <li><a href="#import-exp1c-ja-data-example-3" id="toc-import-exp1c-ja-data-example-3" class="nav-link" data-scroll-target="#import-exp1c-ja-data-example-3"><span class="header-section-number">13.12.3</span> Import Exp1c JA data (Example 3)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-twoway" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="a-linear-model-with-crossed-factors-estimates-interaction-effects" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="a-linear-model-with-crossed-factors-estimates-interaction-effects"><span class="header-section-number">13.1</span> A linear model with crossed factors estimates interaction effects</h2>
<p>A factorial experiment is one in which there are two or more factor variables (categorical <span class="math inline">\(X\)</span>) that are <strong>crossed</strong>, resulting in a group for each combination of the levels of each factor. Each specific combination is a different treatment. A <strong>linear model with crossed factors</strong> is used to estimate <strong>interaction effects</strong>, which occur when the effect of the level of one factor is conditional on the level of the other factors. Estimation of the interaction effect is necessary for inferences about</p>
<ol type="1">
<li>“Something different” – Estimation of a treatment effect relative to a control effect (Example 1 – TLR9-/- mice)</li>
<li>“It depends” – Estimation of the effect of background condition on an effect (Example 2 – XX mice)</li>
<li>“More than the sum of the parts” – Estimation of <strong>synergy</strong>, a non-additive effect (Example 3 – plant root growth)</li>
</ol>
<p>Inferences like these are common in the experimental biology literature but they are made using the wrong statistics. The correct statistic – the interaction effect – is easy to compute but rarely computed.</p>
<div class="callout callout-style-default callout-note callout-titled" title="NHST Blues">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
NHST Blues
</div>
</div>
<div class="callout-body-container callout-body">
<p>NHST encourages dichotomous thinking such as “there is or isn’t an interaction effect.” Dichotomous thinking can only lead to disasters of biblical proportion, dogs and cats living together. Interaction effects in biology are ubiquitous. Sometimes they are small enough to ignore.</p>
</div>
</div>
<section id="an-interaction-is-a-difference-in-simple-effects" class="level3" data-number="13.1.1">
<h3 data-number="13.1.1" class="anchored" data-anchor-id="an-interaction-is-a-difference-in-simple-effects"><span class="header-section-number">13.1.1</span> An interaction is a difference in simple effects</h3>
<p>In this chapter, I’ll describe an interaction effect using different descriptions (Examples 1-3). Here, I want to emphasize that an interaction effect is a difference of differences. To clarify this, I’ll introduce a fake experiment. A research group has evidence that a certain gene product (CGP) is an intermediary between intestinal microbiota and obesity. The researchers transfer feces from either lean mice or obese mice into either wildtype mice or CGP-/- mice to investigate the effect of microbiota and CGP on body weight. The design has two factors (donor and genotype), each with two levels (donor: “Lean”, “Obese; genotype:”WT”, “KO”), which makes this a <span class="math inline">\(2 \times 2\)</span> (crossed or factorial) design. There are <span class="math inline">\(n=6\)</span> replicates for each treatment.</p>
<p>A good way to visualize the treatment combinations in a crossed design is with a <span class="math inline">\(m \times p\)</span> table showing all combinations of the <span class="math inline">\(m\)</span> levels of factor 1 (<code>donor</code>) against the <span class="math inline">\(p\)</span> levels of factor 2 (<code>genotype</code>) (<a href="#tbl-twoway-factorial-table" class="quarto-xref">Table&nbsp;<span>13.1</span></a>).</p>
<div class="cell">
<div id="tbl-twoway-factorial-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twoway-factorial-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.1: Mean body weight of mice in four treatment groups of the 2 x 2 factorial experiment.
</figcaption>
<div aria-describedby="tbl-twoway-factorial-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-paper lightable-hover do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">WT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">KO</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Lean</td>
<td style="text-align: right;">33.2</td>
<td style="text-align: right;">34.1</td>
<td style="text-align: right; font-weight: bold; color: rgba(105, 105, 105, 255) !important;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Obese</td>
<td style="text-align: right;">41.9</td>
<td style="text-align: right;">32.7</td>
<td style="text-align: right; font-weight: bold; color: rgba(105, 105, 105, 255) !important;">-9.2</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; font-weight: bold;">Effect</td>
<td style="text-align: right; font-weight: bold;">8.7</td>
<td style="text-align: right; font-weight: bold;">-1.4</td>
<td style="text-align: right; font-weight: bold; color: rgba(255, 0, 0, 255) !important; font-weight: bold;">-10.1</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<ol type="1">
<li>The upper-left <span class="math inline">\(2 \times 2\)</span> part of the table contains the fake mean body weight of each treatment group. These means are known as <strong>cell means</strong>.</li>
<li>The first two elements in the “Effect” column contains the difference of the two cells to the left – these are the <strong>effects of genotype conditional on the level of donor</strong>.</li>
<li>The first two elements in the “Effect” row contains the difference of the two cells above – these are the <strong>effects of donor conditional on the level of genotype</strong>.</li>
<li>The effects described in items 2 and 3 are known as the <strong>simple effects</strong>.</li>
<li>The value in red is the difference of the two simple effects above it. It is also the difference of the two simple effects to the left. These differences are equal. This is the interaction effect.</li>
<li>In an experiment with a single factor with four levels, all six pairwise comparisons may be of interest. In a <span class="math inline">\(2 \times 2\)</span> factorial experiment, it is the four simple effects and the interaction effect that should pique the interest of the researcher.</li>
</ol>
<p>In this fake experiment, we want to know the effect of obese donor treatment in the KO mice <em>compared to</em> the effect of obese donor treatment in the WT mice. That is, we want the contrast of these two simple effects.</p>
<p><span class="math display">\[
(\operatorname{Obese KO} - \operatorname{Lean KO}) - (\operatorname{Obese WT} - \operatorname{Lean WT})
\]</span></p>
<p>This contrast is the interaction effect. <strong>An interaction effect is a difference of differences</strong>.</p>
</section>
<section id="a-linear-model-with-crossed-factors-includes-interaction-effects" class="level3" data-number="13.1.2">
<h3 data-number="13.1.2" class="anchored" data-anchor-id="a-linear-model-with-crossed-factors-includes-interaction-effects"><span class="header-section-number">13.1.2</span> A linear model with crossed factors includes interaction effects</h3>
<p>The factorial linear model for the fake data is</p>
<p><span class="math display">\[
\begin{align}
\texttt{body\_weight} &amp;= \beta_0\ + \\
&amp;\quad \ \beta_1 (\texttt{donor}_{\texttt{Obese}})\ + \\
&amp;\quad \ \beta_2 (\texttt{genotype}_{\texttt{KO}})\ + \\
&amp;\quad \ \beta_3 (\texttt{donor}_{\texttt{Obese}} : \texttt{genotype}_{\texttt{KO}})
\end{align}
\]</span></p>
<p>What are the variables?</p>
<ol type="1">
<li><span class="math inline">\(\texttt{donor}_{\texttt{Obese}}\)</span> is the indicator variable for the “Obese” level of the factor <span class="math inline">\(\texttt{donor}\)</span>. It contains the value 1 if the donor was “Obese” and 0 otherwise.</li>
<li><span class="math inline">\(\texttt{genotype}_{\texttt{KO}}\)</span> is the indicator variable for the “KO” level of the factor <span class="math inline">\(\texttt{genotype}\)</span>. It contains the value 1 if the genotype is “KO” and 0 otherwise.</li>
<li><span class="math inline">\(\texttt{donor}_{\texttt{Obese}}\)</span> : _{<code>is the indicator variable for the interaction between the "Obese" level of $\texttt{donor</code> and the “KO” level of <span class="math inline">\(\texttt{genotype}\)</span>. This “:” character to indicate interaction follows the R formula convention in the LME4 package. Many sources use a <span class="math inline">\(\times\)</span> symbol instead of the colon. The variable contains the value 1 if the mouse is assigned to both “Obese” and “KO” and 0 otherwise. This value is the product of the values in <span class="math inline">\(\texttt{donor}_{\texttt{Obese}}\)</span> and <span class="math inline">\(\texttt{genotype}_{\texttt{KO}}\)</span>.</li>
</ol>
<p>What are the parameters?</p>
<p>This linear model has set “Lean” as the reference level of <code>donor</code> and “WT” as the reference level of <code>genotype</code>. This make the “Lean WT” mice the control.</p>
<ol type="1">
<li><span class="math inline">\(\beta_0\)</span> is the true mean of the control, which is the “Lean WT” group.</li>
<li><span class="math inline">\(\beta_1\)</span> is the true effect of donor in the WT mice (the effect of manipulating the donor factor but not the genotype factor). It is the difference between the true means of the “Obese WT” group and the “Lean WT” group.</li>
</ol>
<p>The mean of the “Obese WT” group is <span class="math inline">\(\beta_0 + \beta_1\)</span>. This is the expectation if we start with the control and then add the effect of Obese donor.</p>
<ol start="3" type="1">
<li><span class="math inline">\(\beta_2\)</span> is the true effect of genotype in the mice given feces from lean donors (the effect of manipulating the genotype factor but not the donor factor). It is the difference between the true means of the “Lean KO” group and the “Lean WT” group.</li>
</ol>
<p>The mean of the “Lean KO” group is <span class="math inline">\(\beta_0 + \beta_2\)</span>. This is the expectation if we start with the control and then add the effect of KO genotype.</p>
<ol start="4" type="1">
<li><span class="math inline">\(\beta_3\)</span> is the true interaction effect of <span class="math inline">\(\texttt{donor}_{\texttt{Obese}}\)</span> : _{}$</li>
</ol>
<p>The mean of the “Obese KO” group is <span class="math inline">\(\beta_0 + \beta_1 + \beta_2 + \beta_3\)</span>. The expected mean of the “Obese KO” group, <em>if the factors are additive, which means the interaction effect is zero</em>, is <span class="math inline">\(\beta_0 + \beta_1 + \beta_2\)</span>. <strong>The interaction effect is the difference between the actual mean of the “Obese KO” group and this additive mean</strong>. The interaction effect is what’s left-over, after you’ve added Obese effect and the KO effect to the control.</p>
</section>
<section id="factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature" class="level3" data-number="13.1.3">
<h3 data-number="13.1.3" class="anchored" data-anchor-id="factorial-experiments-are-frequently-analyzed-as-flattened-linear-models-in-the-experimental-biology-literature"><span class="header-section-number">13.1.3</span> factorial experiments are frequently analyzed as flattened linear models in the experimental biology literature</h3>
<p>Often, researchers analyze data from a factorial experiment with a one-way ANOVA followed by pairwise tests (or by a simple series of separate <em>t</em>-tests). For the fake experiment, this linear model is</p>
<p><span class="math display">\[
\begin{align}
\texttt{body\_weight} &amp;= \beta_0 \ + \\
&amp; \quad \ \beta_1 (\texttt{treatment}_{\texttt{Obese}}) \ + \\
&amp; \quad \ \beta_2 (\texttt{treatment}_{\texttt{KO}}) \ + \\
&amp; \quad \ \beta_3 (\texttt{treatment}_{\texttt{Obese + KO}})
\end{align}
\]</span></p>
<p>I refer to this as a <strong>flattened</strong> model (the table of treatment combinations has been flattened into a single row). Inference from a factorial or flattened model is the same. We can get the same pairwise contrasts or interaction contrasts from either model. That said, a factorial model nudges researchers to think about the analysis as a factorial design, which is good, because interaction effects are an explicit component of a factorial model.</p>
</section>
</section>
<section id="example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="example-1-estimation-of-a-treatment-effect-relative-to-a-control-effect-something-different-experiment-2j-glucose-uptake-data"><span class="header-section-number">13.2</span> Example 1 – Estimation of a treatment effect relative to a control effect (“Something different”) (Experiment 2j glucose uptake data)</h2>
<p>To introduce a linear model with crossed factors (categorical <span class="math inline">\(X\)</span> variables), I’ll use data from a set of experiments designed to measure the effect of the toll-like receptor protein TLR9 on the activation of excercise-induced AMP-activated protein kinase (AMPK) and downstream sequelae of this activation, including glucose transport (from outside to inside the cell) by skeletal muscle cells.</p>
<p>Article source: <a href="https://www.nature.com/articles/s41586-020-1992-7" target="_blank">TLR9 and beclin 1 crosstalk regulates muscle AMPK activation in exercise</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7047589/" target="_blank">Public source</a></p>
<p>The data are from multiple experiments in Figure 2.</p>
<p><a href="https://www.nature.com/articles/s41586-020-1992-7#Sec27" target="_blank">Data source</a></p>
<section id="twoway-understand1" class="level3" data-number="13.2.1">
<h3 data-number="13.2.1" class="anchored" data-anchor-id="twoway-understand1"><span class="header-section-number">13.2.1</span> Understand the experimental design</h3>
<p><strong>Background</strong>. Exercise (muscle activity) stimulates AMPK activated glucose uptake (transport from outside to inside the muscle cell). Instead of natural exercise, which can stimulate multiple systems, the researchers directly activate the muscle with electrical stimulation.</p>
<p><strong>Research question</strong> There are two ways to think about the question – both produce the same answer.</p>
<ol type="1">
<li>How much does TLR9 knockout inhibit the expected increase of glucose uptake following electrical stimulation? The expected increase comes from the contrast of the positive and negative controls. Call this the knockout-induced stimulation effect.</li>
<li>How much does TLR9 knockout inhibit glucose uptake during muscle stimulation compared to effect of TLR9 knockout during muscle rest? Call this the <strong>stimulation-induced TLR9-/- effect</strong>.</li>
</ol>
<p><strong>Response variable</strong> <code>glucose_uptake</code> (nmol per mg protein per 15 min) – the rate of glucose transported into the cell.</p>
<p><strong>Factor 1</strong> – <code>genotype</code> (“WT”, “KO”).</p>
<ul>
<li>“WT” (reference level) – C57BL/6J mice with intact TLR gene (TLR+/+)</li>
<li>“KO” – TLR-/- mice on a C57BL/6J background</li>
</ul>
<p><strong>Factor 2</strong> <code>stimulation</code> (“Rest”, “Active”) – Two levels:</p>
<ul>
<li>“Rest” (reference level) – muscle that has not been stimulated.</li>
<li>“Active” – electrical stimulation of muscle to induce contraction and contractile-related cell changes</li>
</ul>
<p>These two factors create the three control treatments and the one focal treatment:</p>
<ul>
<li><p>“WT Rest” – <strong>Negative control</strong>. Expect non-exercise (low) level uptake.</p></li>
<li><p>“WT Active” – <strong>Positive control</strong>. Expect high uptake.</p></li>
<li><p>“KO Rest” – <strong>Method control</strong>. Unsure of KO effect on uptake in Rest, which is why we need this control.</p></li>
<li><p>“KO Active” – <strong>Focal treatment</strong>. At about same level of KO Rest if TLR9-/- completely inhibits electrical stimulation of glucose uptake</p></li>
</ul>
<p><strong>Design</strong> – <span class="math inline">\(2 \times 2\)</span>, that is, two crossed factors each with two levels. This results in four groups, each with a unique combination of the levels from each factor.</p>
<p><strong>Planned Contrasts</strong></p>
<p>The two ways of framing the research question suggest either of the following sets of contrasts. Both ways of framing generate a <strong>treatment</strong> contrast that includes the focal treatment and a <strong>control contrast</strong> that does not include the focal treatment. The question pursued by the experiment is addressed with the contrast of the treatment and control contrasts, which is is the estimate of the interaction effect. There is no difference in inference between the two ways of framing the question – the interaction effects are equivalent. The two framings simply give two different ways of viewing an interaction effect.</p>
<p><strong>Framing 1</strong>: How much does TLR9 knockout inhibit the expected increase of glucose uptake during stimulation?</p>
<ol type="1">
<li><p>(KO Active - KO Rest) – effect of Stimulation in KO mice. This is our <strong>treatment contrast</strong>. If TLR9 is necessary for glucose uptake, then this should be zero. If positive, there are non-TLR9 paths.</p></li>
<li><p>(WT Active - WT Rest) – This is the <strong>positive control contrast</strong> – it is what we know based on prior knowledge and what we want to compare the treatment effect to. This should be positive based on prior knowledge.</p></li>
</ol>
<p>We need to control for the expected increase in 2 using the contrast:</p>
<ol start="3" type="1">
<li>(KO Active - KO Rest) - (WT Active - WT Rest) – This contrast is the interaction effect. This <strong>focal contrast</strong> is what we need to estimate the knockout-induced stimulation effect.</li>
</ol>
<p><strong>Framing 2</strong>: What is stimulation-induced TLR9-/- effect?</p>
<ol type="1">
<li><p>(KO Active - WT Active) – effect of KO during muscle stimulation. This is our <strong>treatment contrast</strong>. If TLR9 is necessary for glucose uptake, then this should be big and negative <em>if</em> the KO effect at rest is small.</p></li>
<li><p>(KO Rest - WT Rest) – effect of KO when the muscle is not stimulated. This is the <strong>methodological control contrast</strong>. If TLR9-/- KO has non-muscle-stimulation paths to glucose uptake, this will be something other than zero.</p></li>
</ol>
<p>We need to control for any (KO Rest - WT Rest) effect using the contrast:</p>
<ol start="3" type="1">
<li>(KO Active - WT Active) - (KO Rest - WT Rest) – This contrast is the interaction effect. This <strong>focal contrast</strong> is what we need to estimate the stimulation-induced TLR9-/- effect.</li>
</ol>
<p>Our planned contrasts are:</p>
<ol type="1">
<li>(WT Active - WT Rest) – positive control contrast</li>
<li>(KO Rest - WT Rest) – methodological control contrast</li>
<li>(KO Active - WT Active) – treatment contrast</li>
<li>(KO Active - WT Active) - (KO Rest - WT Rest) – interaction contrast</li>
</ol>
</section>
<section id="fit-the-linear-model" class="level3" data-number="13.2.2">
<h3 data-number="13.2.2" class="anchored" data-anchor-id="fit-the-linear-model"><span class="header-section-number">13.2.2</span> Fit the linear model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>exp2j_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose_uptake <span class="sc">~</span> stimulation <span class="sc">*</span> genotype,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> exp2j)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="twoway-exp2j-inf" class="level3" data-number="13.2.3">
<h3 data-number="13.2.3" class="anchored" data-anchor-id="twoway-exp2j-inf"><span class="header-section-number">13.2.3</span> Inference</h3>
<p><strong>The coefficient table</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>exp2j_m1_coef <span class="ot">&lt;-</span> <span class="fu">tidy</span>(exp2j_m1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>exp2j_m1_coef <span class="sc">|&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">6.75</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">16.1</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">5.89</td>
<td style="text-align: right;">7.61</td>
</tr>
<tr class="even">
<td style="text-align: left;">stimulationActive</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">4.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">genotypeKO</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.2338</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">2.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">stimulationActive:genotypeKO</td>
<td style="text-align: right;">-2.31</td>
<td style="text-align: right;">0.885</td>
<td style="text-align: right;">-2.6</td>
<td style="text-align: right;">0.0152</td>
<td style="text-align: right;">-4.13</td>
<td style="text-align: right;">-0.48</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>emmeans table</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>exp2j_m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(exp2j_m1,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">"stimulation"</span>, <span class="st">"genotype"</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>exp2j_m1_emm <span class="sc">|&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">stimulation</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">genotype</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">emmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rest</td>
<td style="text-align: left;">WT</td>
<td style="text-align: right;">6.75</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">5.89</td>
<td style="text-align: right;">7.61</td>
</tr>
<tr class="even">
<td style="text-align: left;">Active</td>
<td style="text-align: left;">WT</td>
<td style="text-align: right;">10.20</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">9.34</td>
<td style="text-align: right;">11.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rest</td>
<td style="text-align: left;">KO</td>
<td style="text-align: right;">7.53</td>
<td style="text-align: right;">0.483</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">6.53</td>
<td style="text-align: right;">8.53</td>
</tr>
<tr class="even">
<td style="text-align: left;">Active</td>
<td style="text-align: left;">KO</td>
<td style="text-align: right;">8.67</td>
<td style="text-align: right;">0.447</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">7.75</td>
<td style="text-align: right;">9.59</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>The contrasts table</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exp2j_m1_emm # print in console to get row numbers</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set the mean as the row number from the emmeans table</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>wt_rest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>wt_active <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ko_rest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>ko_active <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts are the difference in the vectors created above</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># these planned contrasts are described above</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. (WT Active - WT Rest) -- positive control contrast</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. (KO Rest - WT Rest) -- methodological control contrast</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. (KO Active - WT Active) -- treatment contrast</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. (KO Active - WT Active) - (KO Rest - WT Rest) -- interaction </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>exp2j_m1_planned <span class="ot">&lt;-</span> <span class="fu">contrast</span>(</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  exp2j_m1_emm,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">list</span>(</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"(WT Active - WT Rest)"</span> <span class="ot">=</span> <span class="fu">c</span>(wt_active <span class="sc">-</span> wt_rest),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"(KO Rest - WT Rest)"</span> <span class="ot">=</span> <span class="fu">c</span>(ko_rest <span class="sc">-</span> wt_rest),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"(KO Active - WT Active)"</span> <span class="ot">=</span> <span class="fu">c</span>(ko_active <span class="sc">-</span> wt_active),</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"KO:Active Ixn"</span> <span class="ot">=</span> <span class="fu">c</span>(ko_active <span class="sc">-</span> wt_active) <span class="sc">-</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>      (ko_rest <span class="sc">-</span> wt_rest)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">adjust =</span> <span class="st">"none"</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>exp2j_m1_planned <span class="sc">|&gt;</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>)) <span class="sc">|&gt;</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(WT Active - WT Rest)</td>
<td style="text-align: right;">3.448</td>
<td style="text-align: right;">0.5919</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">2.229</td>
<td style="text-align: right;">4.667</td>
<td style="text-align: right;">5.83</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(KO Rest - WT Rest)</td>
<td style="text-align: right;">0.780</td>
<td style="text-align: right;">0.6393</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-0.537</td>
<td style="text-align: right;">2.097</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">0.23379</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(KO Active - WT Active)</td>
<td style="text-align: right;">-1.527</td>
<td style="text-align: right;">0.6127</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-2.789</td>
<td style="text-align: right;">-0.265</td>
<td style="text-align: right;">-2.49</td>
<td style="text-align: right;">0.01967</td>
</tr>
<tr class="even">
<td style="text-align: left;">KO:Active Ixn</td>
<td style="text-align: right;">-2.307</td>
<td style="text-align: right;">0.8855</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-4.131</td>
<td style="text-align: right;">-0.484</td>
<td style="text-align: right;">-2.61</td>
<td style="text-align: right;">0.01523</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># double check with automated contrasts</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># contrast(exp2b.2_m1_emm, method = c("revpairwise"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-the-model" class="level3" data-number="13.2.4">
<h3 data-number="13.2.4" class="anchored" data-anchor-id="plot-the-model"><span class="header-section-number">13.2.4</span> Plot the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_the_model</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  exp2j_m1,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  exp2j_m1_emm,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  exp2j_m1_planned,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="st">"Glucose uptake</span><span class="sc">\n</span><span class="st">(nmol per mg protein</span><span class="sc">\n</span><span class="st">per 15 min)"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">effect_label =</span> <span class="st">"Difference in glucose uptake"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.44</span>,<span class="dv">1</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="two-factors_files/figure-html/twoway-exp2j_m1_plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="alternaplot-the-model" class="level3" data-number="13.2.5">
<h3 data-number="13.2.5" class="anchored" data-anchor-id="alternaplot-the-model"><span class="header-section-number">13.2.5</span> alternaPlot the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>exp2j_m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(exp2j_m1_emm,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"revpairwise"</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">simple =</span> <span class="st">"each"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">combine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">emm_b</span>(exp2j_m1_emm)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>dodge_width <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot_the_response</span>(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  exp2j_m1,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  exp2j_m1_emm,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  exp2j_m1_pairs[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>),],</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="st">"Glucose uptake</span><span class="sc">\n</span><span class="st">(nmol per mg protein</span><span class="sc">\n</span><span class="st">per 15 min)"</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_pos =</span> <span class="fu">c</span>(<span class="fl">13.6</span>, <span class="fl">13.2</span>, <span class="fl">13.3</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">2</span> <span class="sc">+</span> dodge_width<span class="sc">/</span><span class="dv">2</span> <span class="sc">-</span> <span class="fl">0.05</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">3</span>],</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">xend =</span> <span class="dv">2</span> <span class="sc">+</span> dodge_width<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.05</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">yend =</span> b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">3</span>],</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bracket</span>(</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">2.25</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">3</span>],</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">3</span>] <span class="sc">+</span> b[<span class="dv">4</span>],</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"ixn p = "</span>,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">fmt_p_value_rmd</span>(exp2j_m1_planned[<span class="dv">4</span>,<span class="st">"p.value"</span>])),</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.size =</span> <span class="dv">3</span>,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.hjust =</span> <span class="dv">0</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="two-factors_files/figure-html/twoway-exp2j-altplot-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption>Dashed gray line is expected additive mean of KO Active</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="understanding-the-linear-model-with-crossed-factors-1" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="understanding-the-linear-model-with-crossed-factors-1"><span class="header-section-number">13.3</span> Understanding the linear model with crossed factors 1</h2>
<p>Researchers in experimental biology report almost exclusively the <em>p</em>-values of the simple effects (<a href="#tbl-twoway-factorial-table" class="quarto-xref">Table&nbsp;<span>13.1</span></a>) in data from factorial experiments. These can be computed even if the data are flattened into a single “treatment” factor. But it is the interaction effect that is necessary to make many of the inferences made by the researchers. To see why, we need to understand what the coefficients in the coefficient table are.</p>
<section id="twoway-what-coefs-are" class="level3" data-number="13.3.1">
<h3 data-number="13.3.1" class="anchored" data-anchor-id="twoway-what-coefs-are"><span class="header-section-number">13.3.1</span> What the coefficients are</h3>
<p>To understand the coefficients, it helps to use the means in the emmeans table to construct a factorial table of the cell means</p>
<div class="cell">
<div id="tbl-twoway-exp2j-cellmeans" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twoway-exp2j-cellmeans-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.2: Cell mean table
</figcaption>
<div aria-describedby="tbl-twoway-exp2j-cellmeans-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-paper lightable-hover do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Rest</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Active</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">WT</td>
<td style="text-align: right;">6.75</td>
<td style="text-align: right;">7.53</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">KO</td>
<td style="text-align: right;">10.20</td>
<td style="text-align: right;">8.67</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p>The linear model fit to the <code>exp2j</code> data is</p>
<p><span class="math display">\[
\begin{align}
\texttt{glucose\_uptake} &amp;= \beta_{0} \ + \\
&amp;\quad \ \beta_{1}(\texttt{stimulation}_{\texttt{Active}}) \ + \\
&amp;\quad \ \beta_{2}(\texttt{genotype}_{\texttt{KO}}) \ + \\
&amp;\quad \ \beta_{3}(\texttt{stimulation}_{\texttt{Active}} : \texttt{genotype}_{\texttt{KO}})
\end{align}
\]</span></p>
<p>and the fit coefficients are</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">6.7501</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">16.1280</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">5.888</td>
<td style="text-align: right;">7.612</td>
</tr>
<tr class="even">
<td style="text-align: left;">stimulationActive</td>
<td style="text-align: right;">3.4482</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">5.8258</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.229</td>
<td style="text-align: right;">4.667</td>
</tr>
<tr class="odd">
<td style="text-align: left;">genotypeKO</td>
<td style="text-align: right;">0.7801</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">1.2202</td>
<td style="text-align: right;">0.234</td>
<td style="text-align: right;">-0.537</td>
<td style="text-align: right;">2.097</td>
</tr>
<tr class="even">
<td style="text-align: left;">stimulationActive:genotypeKO</td>
<td style="text-align: right;">-2.3072</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">-2.6056</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">-4.131</td>
<td style="text-align: right;">-0.484</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Explainer</p>
<ol type="1">
<li>Understand what the rows of the coefficient table are. There are four parameters in the fit linear model – the rows are the statistics for the estimates of these parameters. These estimates are the <strong>coefficients</strong> of the model.</li>
<li>The <code>(Intercept)</code> coefficient (<span class="math inline">\(b_0\)</span>) is the mean <code>glucose_uptake</code> of the reference level, which was set to the “WT Rest” group (<a href="#fig-twoway-what-coefs-are" class="quarto-xref">Figure&nbsp;<span>13.1</span></a>). This is the mean in the upper left cell in <a href="#tbl-twoway-exp2j-cellmeans" class="quarto-xref">Table&nbsp;<span>13.2</span></a>.</li>
<li>The <code>stimulationActive</code> coefficient (<span class="math inline">\(b_2\)</span>) is the estimate of the <strong>the added effect of Stimulation when the genotype factor is at its reference level</strong>, and so is the mean in the upper right cell minus the mean in the upper left cell in <a href="#tbl-twoway-exp2j-cellmeans" class="quarto-xref">Table&nbsp;<span>13.2</span></a>. This coefficient is not a mean – it is a difference of means (<a href="#fig-twoway-what-coefs-are" class="quarto-xref">Figure&nbsp;<span>13.1</span></a>). The mean of the “WT Active” group is <span class="math inline">\(b_0 + b_2\)</span>.</li>
<li>The <code>genotypeKO</code> coefficient (<span class="math inline">\(b_1\)</span>) is the estimate of the <strong>the added effect of knocking out TLR9 when the stimulation factor is at its reference level</strong>, and so is the mean in the lower left cell minus the mean in the upper left cell in <a href="#tbl-twoway-exp2j-cellmeans" class="quarto-xref">Table&nbsp;<span>13.2</span></a>. This coefficient is not a mean – it is a difference of means (<a href="#fig-twoway-what-coefs-are" class="quarto-xref">Figure&nbsp;<span>13.1</span></a>). The mean of the “KO Rest” group is <span class="math inline">\(b_0 + b_1\)</span>.</li>
<li>The <code>stimulationActive:genotypeKO</code> coefficient (<span class="math inline">\(b_3\)</span>) is the estimate of the interaction effect between <code>genotype</code> and <code>stimulation</code>. It is <em>not</em> the mean in the lower right cell minus the mean in the upper left cell. Instead, <strong>it is the mean in the lower right cell minus the expected mean in the lower right cell if the genotype and activity treatment effects were additive</strong>. The expected additive-mean in the lower right cell (“KO Active”) is <span class="math inline">\(b_0 + b_1 + b_2\)</span>. The mean of KO stimulation is <span class="math inline">\(b_0 + b_1 + b_2 + b_3\)</span> (<a href="#fig-twoway-what-coefs-are" class="quarto-xref">Figure&nbsp;<span>13.1</span></a>).</li>
<li>The interaction effect is a <strong>non-additive effect</strong>. Think about this. Adding the Stimulation alone adds 3.45 nmol glucose per protein per 15 min to the uptake rate of the reference. Adding KO alone adds 0.78 glucose per protein per 15 min to the uptake rate of the reference. If these effects were purely additive, then adding both Stimulation and KO to the reference rate should result in a mean of 6.75 + 3.45 + 0.78 = 10.98 glucose per protein per 15 min. The modeled mean for “KO Active” is 8.67 glucose per protein per 15 min. The difference observed - additive is 8.67 - 10.98 = -2.31 glucose per protein per 15 min. Compare this difference to the interaction coefficient in the coefficient table.</li>
<li>Reinforce your understanding of <em>non-additive</em> in item 5. The interaction is a non-additive effect because the mean of the combined treatment is something different than if we were to just add the KO and Active effects. But this effect is additive in the linear model. This is what linear models are – a reference mean plus the sum of a bunch of effects.</li>
<li>Understand what these rows <strong>are not</strong>. The <code>stimulationActive</code> row is not the same as the “stimulation” term in a Type III ANOVA table (the ANOVA table produced in GraphPad Prism or JMP). The <em>p</em>-values will be different because the <em>p</em>-values are testing different hypotheses. In the coefficient table, the <code>stimulationActive</code> <em>p</em>-value is testing the difference of the means of WT Active and WT Rest. The stimulation term in a Type III ANOVA table is testing if there is an overall stimulation effect, which is estimated as the average of the two stimulation contrasts (WT Active - WT Rest) and (KO Active - KO Rest). The average of these two contrasts is not often of interest (but sometimes is – see below).</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div id="fig-twoway-what-coefs-are" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-twoway-what-coefs-are-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="two-factors_files/figure-html/fig-twoway-what-coefs-are-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoway-what-coefs-are-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.1: The coefficients of a linear model with two crossed factors, explained.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-interaction-effect-is-something-different" class="level3" data-number="13.3.2">
<h3 data-number="13.3.2" class="anchored" data-anchor-id="the-interaction-effect-is-something-different"><span class="header-section-number">13.3.2</span> The interaction effect is something different</h3>
<p>Item 6 in the coefficient table explainer stated “The interaction is a non-additive effect because the mean of the combined treatment is <strong>something different</strong> than if we were to just add the KO and Active effects. The something different is the interaction effect. If the interaction effect were zero, the expected effect of stimulation in the KO mice would be the same as the expected effect of stimulation in the WT mice (<a href="#fig-twoway-something-different" class="quarto-xref">Figure&nbsp;<span>13.2</span></a>). This would suggest the underlying physiological changes between Rest and Active in the KO mice is”more of the same” physiological changes in the WT mice. But, because of the interaction, the underlying physiological changes between Rest and Active in the KO mice is “something different” to that of physiological changes in the WT mice (<a href="#fig-twoway-something-different" class="quarto-xref">Figure&nbsp;<span>13.2</span></a>).</p>
<p>The biological reasons causing interaction effects are highly variable and are what makes Biology fun. Additive effects (no interaction) may occur when combined treatments act independently of each other. This might occur in the glucose uptake response if knocking out TLR9 opens a path to glucose uptake that is different from and independent of the paths activated by electrial stimulation. Positive, or <strong>synergistic</strong> interaction effects may occur when combined treatments augment each other’s ability to affect the response (see Example 3 below). This could occur in the glucose uptake response if knocking out TLR9 opens a path to glucose uptake that is different the paths activated by electrial stimulation but also makes the paths activated by stimulation more sensitive to stimulation. Negative, or <strong>antagonistic</strong> interaction effects may occur when combined treatments interfere with each other’s ability to affect the response. This could occur in the glucose uptake response if TLR9 is on the path from stimulation to glucose uptake. Knocking out TLR9 interferes with this path. If TLR9 is required, we’d expect the interaction effect to be the same magnitude but opposite sign of the control effect – that is, complete antagonism of the control effect. Previous experiments suggested this negative interaction. The measurement of this effect was the purpose of experiment <code>exp2j</code>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-twoway-something-different" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-twoway-something-different-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="two-factors_files/figure-html/fig-twoway-something-different-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoway-something-different-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.2: The interaction is something different, not more of the same. To get the observed difference (4), take the expected difference (3) and add something different (5).
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="why-we-want-to-compare-the-treatment-effect-to-a-control-effect" class="level3" data-number="13.3.3">
<h3 data-number="13.3.3" class="anchored" data-anchor-id="why-we-want-to-compare-the-treatment-effect-to-a-control-effect"><span class="header-section-number">13.3.3</span> Why we want to compare the treatment effect to a control effect</h3>
<p>The purpose of the experiment is to infer a TLR9 role in the regulation of muscle-stimulated glucose transport, that is, a <strong>stimulation-induced TLR9-/- effect</strong>. If TLR9 is in the pathway from muscle activity to glucose transport, we expect some kind of recovery to baseline (Rest) values in the KO Active group. But TLR9 may also (or alternatively) have a role in non-stimulation-induced glucose uptake.</p>
<p>How do we make an inference about a stimulation-induced TLR9-/- effect using this experiment? Researchers typically look at the <strong>treatment effect</strong></p>
<p>(KO Active - WT Active)</p>
<p>and conclude a stimulation-induced TLR9-/- effect if it’s big (and negative)</p>
<p>If the treatment effect is the correct contrast for inference, why bother with the measures of glucose uptake during Rest? The reason the treatment effect alone is the wrong contrast for inferring the <em>stimulation-induced</em> TLR9 effect is because it is confounded by the <strong>control effect</strong>, which is the contrast (KO Rest - WT Rest) (<a href="#fig-twoway-what-we-want" class="quarto-xref">Figure&nbsp;<span>13.3</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-twoway-what-we-want" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-twoway-what-we-want-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="two-factors_files/figure-html/fig-twoway-what-we-want-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoway-what-we-want-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.3: Why the interaction effect is the stimulation-induced TLR9-/- effect
</figcaption>
</figure>
</div>
</div>
</div>
<p>To unconfound the inference, subtract the confounder:</p>
<p>(KO Active - WT Active) - (KO Rest - WT Rest)</p>
<p>This is the interaction effect. Consequences of interpreting the treatment effect KO Active - WT Active as the stimulation-induced TLR9-/- effect are highlighted in <a href="#fig-twoway-scenarios" class="quarto-xref">Figure&nbsp;<span>13.4</span></a>. In these plots, the data are those from <code>exp2j</code> but with the values in the KO groups shifted up or down to create the scenarios.</p>
<p>Scenario 1. The positive control has big effect AND KO has no effect during rest AND the stimulation-induced TLR9-/- effect is equal in magnitude but opposite direction to the Active effect in WT (<a href="#fig-twoway-scenarios" class="quarto-xref">Figure&nbsp;<span>13.4</span></a> A). The stimulation-induced TLR9-/- effect is conspicuous from the plot, if our sample means are close to the true means and we have high precision. The simple effect measures the stimulation-induced TLR9-/- effect correctly – but this is because the simple effect is equal in magnitude (but opposite sign) to the interaction effect. Many experiments in the literature are pretty similar to this scenario.</p>
<p>Scenario 2. The positive control has big effect AND KO has a negative effect during rest BUT there is zero stimulation-induced TLR9-/- effect – that is, the interaction is zero (<a href="#fig-twoway-scenarios" class="quarto-xref">Figure&nbsp;<span>13.4</span></a> B). There is an effect of KO during stimulation but this effect is no different that that occuring during Rest. So this cannot be a <em>contraction induced</em> TLR9 effect. Simple effect 1 <em>inflates</em> the effect.</p>
<p>Scenario 3. The positive control has big effect AND KO has a positive effect during rest AND there is a stimulation-induced TLR9-/- effect that is equal to that in scenario 1 (<a href="#fig-twoway-scenarios" class="quarto-xref">Figure&nbsp;<span>13.4</span></a> C). The positive effect of KO during Rest masks the stimulation-induced TLR9-/- effect. The simple effect <em>underestimates</em> the stimulation-induced TLR9-/- effect. This is similar to what is happening in Experiment 2j.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-twoway-scenarios" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-twoway-scenarios-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="two-factors_files/figure-html/fig-twoway-scenarios-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoway-scenarios-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.4: Scenarios to show the consequence of inferring the stimulation-induced TLR9-/- effect from the simple effect (KO Active - WT Active). The simple effect and interaction effect lines extend from the KO Active mean to either the KO Rest mean (simple) or the expected mean of KO Active if the two factors were additive (interaction).
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-order-of-the-factors-in-the-model-tells-the-same-story-differently" class="level3" data-number="13.3.4">
<h3 data-number="13.3.4" class="anchored" data-anchor-id="the-order-of-the-factors-in-the-model-tells-the-same-story-differently"><span class="header-section-number">13.3.4</span> The order of the factors in the model tells the same story differently</h3>
<p>The order of the factors in the model formula doesn’t matter for the coefficients, the estimated marginal means, or the contrasts. It can matter for ANOVA (more on this below) but not “tests after ANOVA”. But the order does matter to how the researchers communicates the results to themselves and in the report (<a href="#fig-twoway-same-story" class="quarto-xref">Figure&nbsp;<span>13.5</span></a>). The order is also a natural consequence of the <a href="#twoway-understand1">two different ways of framing the research question</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-twoway-same-story" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-twoway-same-story-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="two-factors_files/figure-html/fig-twoway-same-story-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoway-same-story-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.5: It may take some work but these plots show the same four means and effects. The only difference is how we communicate the story to ourselves and to others. A) the order of the factors in the model is stimulation * genotype. B) the order of the factors in the model is genotype * stimulation.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="power-for-the-interaction-effect-is-less-than-that-for-simple-effects" class="level3" data-number="13.3.5">
<h3 data-number="13.3.5" class="anchored" data-anchor-id="power-for-the-interaction-effect-is-less-than-that-for-simple-effects"><span class="header-section-number">13.3.5</span> Power for the interaction effect is less than that for simple effects</h3>
<p>The interaction contrast is the difference of two simple contrasts and, consequently, the variance of the interaction contrast is <a href="https://en.wikipedia.org/wiki/Variance#Sum_of_uncorrelated_variables_(Bienaymé_formula)" target="_blank">twice that of the simple contrasts</a>. And, consequently, the SE of the interaction estimate is <span class="math inline">\(\sim 1.4 \times\)</span> larger than the precision of the two simple effects that form the contrast (1.4 is $sqrt{2}. The exact value will depend on differences in sample size among groups). The consequence of this is wider confidence intervals and larger <em>p</em>-values for the interaction contrast compared to a simple contrast of the same effect size.</p>
</section>
<section id="planned-comparisons-vs.-post-hoc-tests" class="level3" data-number="13.3.6">
<h3 data-number="13.3.6" class="anchored" data-anchor-id="planned-comparisons-vs.-post-hoc-tests"><span class="header-section-number">13.3.6</span> Planned comparisons vs.&nbsp;post-hoc tests</h3>
<p>The contrasts computed above were planned based on questions motivating the experiment. The planned contrasts contain three of the four simple effects. The four simple effects are</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>exp2j_m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(exp2j_m1_emm,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"revpairwise"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">simple =</span> <span class="st">"each"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">combine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>exp2j_m1_pairs <span class="sc">|&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">genotype</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">stimulation</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">WT</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">Active - Rest</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">4.67</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">0.000004</td>
</tr>
<tr class="even">
<td style="text-align: left;">KO</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">Active - Rest</td>
<td style="text-align: right;">1.14</td>
<td style="text-align: right;">0.659</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.095500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">.</td>
<td style="text-align: left;">Rest</td>
<td style="text-align: left;">KO - WT</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">2.10</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.233785</td>
</tr>
<tr class="even">
<td style="text-align: left;">.</td>
<td style="text-align: left;">Active</td>
<td style="text-align: left;">KO - WT</td>
<td style="text-align: right;">-1.53</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-2.79</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-2.5</td>
<td style="text-align: right;">0.019668</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There are six pairwise comparisons for this experiment. Two of these are not a simple effect:</p>
<ol type="1">
<li>KO Active - WT Rest</li>
<li>WT Active - KO Rest</li>
</ol>
<p>These are the contrasts of the diagonal pairs in the cell-means table (<a href="#tbl-twoway-exp2j-cellmeans" class="quarto-xref">Table&nbsp;<span>13.2</span></a>). In a factorial design, we generally are not interested in these diagonal contrasts. They could be reported in a supplement. Recognize that if you are adjusting <em>p</em>-values for multiple tests, and you do not care about these contrasts but have included them in the computation of the adjustment, then your adjusted <em>p</em>-values are conservative.</p>
</section>
</section>
<section id="example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="example-2-estimation-of-the-effect-of-background-condition-on-an-effect-it-depends-experiment-3e-lesian-area-data"><span class="header-section-number">13.4</span> Example 2: Estimation of the effect of background condition on an effect (“it depends”) (Experiment 3e lesian area data)</h2>
<section id="understand-the-experimental-design" class="level3" data-number="13.4.1">
<h3 data-number="13.4.1" class="anchored" data-anchor-id="understand-the-experimental-design"><span class="header-section-number">13.4.1</span> Understand the experimental design</h3>
<p><strong>Research question</strong> 1. What is the effect of the X chromosome complement on lipid-related disease markers? 2. What is the effect of sex (female or male gonad) on lipid-related disease markers? 3. How conditional is the sex effect on the chromosome complement? 4. How conditional is the effect of X chromosome complement on the level of sex?</p>
<p><strong>Response variable</strong> <code>lesian_area</code> – atherosclerotic lesian area in aortic sinus.</p>
<p><strong>Factor 1</strong> – <code>sex</code> (“Female”, “Male”). This is not the typical sex factor that is merely observed but is a manipulated factor. Sex is determined by the presence or absence of <em>SRY</em> on an autosome using the Four Core Genotype mouse model. <em>SRY</em> determines the gonad that develops (ovary or testis). “Female” does not have the autosome with <em>SRY</em>. “Male” has the autosome with <em>SRY</em>.</p>
<p><strong>Factor 2</strong> – <code>chromosome</code> (“XX”, “XY”). The sex chromosome complement is not observed but manipulated. In “XX”, neither sex chromosome has <em>SRY</em> as the natural condition. In “XY”, <em>SRY</em> has been removed from the Y chromosome.</p>
<p><strong>Design</strong> – <span class="math inline">\(2 \times 2\)</span>, that is, two crossed factors each with two levels. This results in four groups, each with a unique combination of the levels from each factor. “Female XX” is the control. “Male XX” adds the autosomal <em>SRY</em> gene (and testes instead of an ovary). “Female XY” replaces the “X” complement with the engineered Y complement. “Male XY” has both the autosomal <em>SRY</em> and the engineered Y complement.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sex</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">chromosome</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">treatment</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">chromosome complement</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">autosome</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">gonad</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">XX</td>
<td style="text-align: left;">FXX</td>
<td style="text-align: left;">X</td>
<td style="text-align: left;">WT</td>
<td style="text-align: left;">ovary</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">XX</td>
<td style="text-align: left;">MXX</td>
<td style="text-align: left;">X</td>
<td style="text-align: left;">SRY+</td>
<td style="text-align: left;">testis</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">XY</td>
<td style="text-align: left;">FXY</td>
<td style="text-align: left;">Y (sry-)</td>
<td style="text-align: left;">WT</td>
<td style="text-align: left;">ovary</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">XY</td>
<td style="text-align: left;">MXY</td>
<td style="text-align: left;">Y (sry-)</td>
<td style="text-align: left;">SRY+</td>
<td style="text-align: left;">testis</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The research question suggest the following planned contrasts</p>
<p>What is the effect of <code>chromosome</code> on lipid-related disease markers?</p>
<ol type="1">
<li>(Female XX - Female XY) – effect of XX in mice with female gonad. If hypothesis is true, this should be large, negative.</li>
<li>(Male XX - Male XY) – effect of XX in mice with male gonad. If hypothesis is true, this should be large, negative.</li>
</ol>
<p>What is the effect of <code>sex</code> on lipid-related disease markers?</p>
<ol start="3" type="1">
<li>(Male XX - Female XX) – effect of sex in XX mice.</li>
<li>(Male XY - Female XY) – effect of sex in XY in mice.</li>
</ol>
<p>How conditional are the effects?</p>
<ol start="5" type="1">
<li>(Male XX - Male XY) - (Female XX - Female XY) – Interaction.</li>
</ol>
<p>In this experiment, there is no treatment contrast or control contrast. Instead, all four simple contrasts are of equal interest.</p>
</section>
<section id="fit-the-linear-model-1" class="level3" data-number="13.4.2">
<h3 data-number="13.4.2" class="anchored" data-anchor-id="fit-the-linear-model-1"><span class="header-section-number">13.4.2</span> Fit the linear model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>exp3e_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lesian_area <span class="sc">~</span> sex<span class="sc">*</span>chromosome, <span class="at">data =</span> exp3e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-the-model" class="level3" data-number="13.4.3">
<h3 data-number="13.4.3" class="anchored" data-anchor-id="check-the-model"><span class="header-section-number">13.4.3</span> Check the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcheck_the_model</span>(exp3e_m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="two-factors_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="inference-from-the-model" class="level3" data-number="13.4.4">
<h3 data-number="13.4.4" class="anchored" data-anchor-id="inference-from-the-model"><span class="header-section-number">13.4.4</span> Inference from the model</h3>
<p><strong>The coefficient table</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step 2 - get the coefficient table</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>exp3e_m1_coef <span class="ot">&lt;-</span> <span class="fu">tidy</span>(exp3e_m1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.540</td>
<td style="text-align: right;">0.0353</td>
<td style="text-align: right;">15.29</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.464</td>
<td style="text-align: right;">0.616</td>
</tr>
<tr class="even">
<td style="text-align: left;">sexMale</td>
<td style="text-align: right;">-0.018</td>
<td style="text-align: right;">0.0500</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">0.7172</td>
<td style="text-align: right;">-0.126</td>
<td style="text-align: right;">0.089</td>
</tr>
<tr class="odd">
<td style="text-align: left;">chromosomeXY</td>
<td style="text-align: right;">-0.290</td>
<td style="text-align: right;">0.0530</td>
<td style="text-align: right;">-5.48</td>
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;">-0.404</td>
<td style="text-align: right;">-0.177</td>
</tr>
<tr class="even">
<td style="text-align: left;">sexMale:chromosomeXY</td>
<td style="text-align: right;">0.143</td>
<td style="text-align: right;">0.0749</td>
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">0.0776</td>
<td style="text-align: right;">-0.018</td>
<td style="text-align: right;">0.303</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>The emmeans table</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step 3 - get the modeled means</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>exp3e_m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(exp3e_m1, <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">"sex"</span>, <span class="st">"chromosome"</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>exp3e_m1_emm <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">|&gt;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sex</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">chromosome</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">emmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">XX</td>
<td style="text-align: right;">0.540</td>
<td style="text-align: right;">0.0353</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.464</td>
<td style="text-align: right;">0.616</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">XX</td>
<td style="text-align: right;">0.522</td>
<td style="text-align: right;">0.0353</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.446</td>
<td style="text-align: right;">0.597</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">XY</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.0395</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.165</td>
<td style="text-align: right;">0.335</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">XY</td>
<td style="text-align: right;">0.374</td>
<td style="text-align: right;">0.0395</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.289</td>
<td style="text-align: right;">0.459</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>The contrasts table</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m1_emm # print in console to get row numbers</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set the mean as the row number from the emmeans table</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>fxx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>mxx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>fxy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>mxy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts are the difference in the vectors created above</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># the focal contrasts are in the understand the experiment section</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. (FXY - FXX) </span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. (MXY - MXX)</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. (MXX - FXX)</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. (MXY - FXY)</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Interaction</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>exp3e_m1_planned <span class="ot">&lt;-</span> <span class="fu">contrast</span>(exp3e_m1_emm,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="fu">list</span>(</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"FXY - FXX"</span> <span class="ot">=</span> <span class="fu">c</span>(fxy <span class="sc">-</span> fxx),</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"MXY - MXX"</span> <span class="ot">=</span> <span class="fu">c</span>(mxy <span class="sc">-</span> mxx),</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"MXX - FXX"</span> <span class="ot">=</span> <span class="fu">c</span>(mxx <span class="sc">-</span> fxx),</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"MXY - FXY"</span> <span class="ot">=</span> <span class="fu">c</span>(mxy <span class="sc">-</span> fxy),</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Interaction"</span> <span class="ot">=</span> <span class="fu">c</span>(mxy <span class="sc">-</span> mxx) <span class="sc">-</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">c</span>(fxy <span class="sc">-</span> fxx)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>                           </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>                       ),</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">adjust =</span> <span class="st">"none"</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a> <span class="co"># exp3e_m1_ixn &lt;- contrast(exp3e_m1_emm,</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a> <span class="co">#                           interaction = c("revpairwise"),</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a> <span class="co">#                           by = NULL)</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>exp3e_m1_planned <span class="sc">|&gt;</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>)) <span class="sc">|&gt;</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FXY - FXX</td>
<td style="text-align: right;">-0.290</td>
<td style="text-align: right;">0.0530</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">-0.404</td>
<td style="text-align: right;">-0.177</td>
<td style="text-align: right;">-5.48</td>
<td style="text-align: right;">0.00008</td>
</tr>
<tr class="even">
<td style="text-align: left;">MXY - MXX</td>
<td style="text-align: right;">-0.148</td>
<td style="text-align: right;">0.0530</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">-0.261</td>
<td style="text-align: right;">-0.034</td>
<td style="text-align: right;">-2.79</td>
<td style="text-align: right;">0.01458</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MXX - FXX</td>
<td style="text-align: right;">-0.018</td>
<td style="text-align: right;">0.0500</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">-0.126</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">0.71716</td>
</tr>
<tr class="even">
<td style="text-align: left;">MXY - FXY</td>
<td style="text-align: right;">0.124</td>
<td style="text-align: right;">0.0559</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.244</td>
<td style="text-align: right;">2.22</td>
<td style="text-align: right;">0.04309</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Interaction</td>
<td style="text-align: right;">0.143</td>
<td style="text-align: right;">0.0749</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">-0.018</td>
<td style="text-align: right;">0.303</td>
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">0.07762</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Explainer</p>
<ol type="1">
<li>The two simple effects and the interaction are computed separately. If we want to adjust for three comparisons, I would use the Holm method.</li>
<li>The magnitude of the estimated effect of XX in mice with male gonads is about 1/2 that in mice with female gonads. This difference is the magnitude of the interaction.</li>
<li>Don’t infer “no effect” given the p-value of the interaction. The estimate of the interaction effect has the same magnitude as the estimated effect of XX in mice with male gonads and about 1/2 the magnitude as the estimated effect of XX in mice with female gonads. The interaction <em>p</em>-value suggests caution in our confidence of the sign of this effect.</li>
</ol>
</section>
<section id="plot-the-model-1" class="level3" data-number="13.4.5">
<h3 data-number="13.4.5" class="anchored" data-anchor-id="plot-the-model-1"><span class="header-section-number">13.4.5</span> Plot the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>exp3e_m1_plot <span class="ot">&lt;-</span> <span class="fu">ggplot_the_model</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> exp3e_m1,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_emm =</span> exp3e_m1_emm,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_pairs =</span> exp3e_m1_planned,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Lesian area ("</span>, mm<span class="sc">^</span><span class="dv">2</span>, <span class="st">")"</span>)),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">effect_label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Effect ("</span>, mm<span class="sc">^</span><span class="dv">2</span>, <span class="st">")"</span>)),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">contrast_rows =</span> <span class="st">"all"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>exp3e_m1_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="two-factors_files/figure-html/plot_the_model-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="alternaplot-the-model-1" class="level3" data-number="13.4.6">
<h3 data-number="13.4.6" class="anchored" data-anchor-id="alternaplot-the-model-1"><span class="header-section-number">13.4.6</span> alternaPlot the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>exp3e_m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(exp3e_m1_emm,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"revpairwise"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">simple =</span> <span class="st">"each"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">combine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">emm_b</span>(exp3e_m1_emm)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>dodge_width <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot_the_response</span>(</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  exp3e_m1,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  exp3e_m1_emm,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  exp3e_m1_pairs[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,],</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Lesian area ("</span>, mm<span class="sc">^</span><span class="dv">2</span>, <span class="st">")"</span>)),</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_pos =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.78</span>, <span class="fl">0.72</span>, <span class="fl">0.72</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">2</span> <span class="sc">+</span> dodge_width<span class="sc">/</span><span class="dv">2</span> <span class="sc">-</span> <span class="fl">0.05</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">3</span>],</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">xend =</span> <span class="dv">2</span> <span class="sc">+</span> dodge_width<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.05</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">yend =</span> b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">3</span>],</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bracket</span>(</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">2.25</span>,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">3</span>],</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">3</span>] <span class="sc">+</span> b[<span class="dv">4</span>],</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"ixn p = "</span>,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">fmt_p_value_rmd</span>(exp3e_m1_planned[<span class="dv">5</span>,<span class="st">"p.value"</span>])),</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.size =</span> <span class="dv">3</span>,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.hjust =</span> <span class="dv">0</span>,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="two-factors_files/figure-html/twoway-exp3e-altplot-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption>Dashed gray line is expected additive mean of KO Active</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="understanding-the-linear-model-with-crossed-factors-2" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="understanding-the-linear-model-with-crossed-factors-2"><span class="header-section-number">13.5</span> Understanding the linear model with crossed factors 2</h2>
<section id="twoway-marginal-means" class="level3" data-number="13.5.1">
<h3 data-number="13.5.1" class="anchored" data-anchor-id="twoway-marginal-means"><span class="header-section-number">13.5.1</span> Conditional and marginal means</h3>
<div class="cell">
<div id="tbl-twoway-conditional-means" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twoway-conditional-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.3: Conditional (white background) and marginal (color background) means from full factorial model fit to lesian area data
</figcaption>
<div aria-describedby="tbl-twoway-conditional-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Female</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Male</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">XX</td>
<td style="text-align: right; background-color: white !important;">0.540</td>
<td style="text-align: right; background-color: white !important;">0.522</td>
<td style="text-align: right; background-color: rgba(230, 159, 0, 255) !important;">0.531</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">XY</td>
<td style="text-align: right; background-color: white !important;">0.250</td>
<td style="text-align: right; background-color: white !important;">0.374</td>
<td style="text-align: right; background-color: rgba(230, 159, 0, 255) !important;">0.312</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">mean</td>
<td style="text-align: right; background-color: rgba(86, 180, 233, 255) !important;">0.395</td>
<td style="text-align: right; background-color: rgba(86, 180, 233, 255) !important;">0.448</td>
<td style="text-align: right; background-color: white !important;"></td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p>The conditional means from the fit model are shown in the upper left <span class="math inline">\(2 \times 2\)</span> block (white background) of <a href="#tbl-twoway-conditional-means" class="quarto-xref">Table&nbsp;<span>13.3</span></a>. These means are conditional on the level of <code>sex</code> and <code>chromosome</code>. For the linear model with two crossed factor here (with no continuous covariates), these conditional means are equal to the sample means of the treatment. The values in the last row and column are the <strong>marginal means</strong>, which are the means of the associated row or column cells (these values are in the margins of the table). More generally, <em>marginal</em> refers to a statistic averaged across multiple levels of another variable. The marginal means of the <code>chromosome</code> levels (orange background) are the means of the “XX” and “XY” rows. The marginal means of the <code>sex</code> levels (blue background) are the means of the “Female” and “Male” columns. Note that the marginal means are simple averages across cell means and not weighted averages where the weights are the sample size used to compute the conditional (cell) means.</p>
</section>
<section id="simple-conditional-effects" class="level3" data-number="13.5.2">
<h3 data-number="13.5.2" class="anchored" data-anchor-id="simple-conditional-effects"><span class="header-section-number">13.5.2</span> Simple (conditional) effects</h3>
<p>In a factorial experiment with crossed A and B factors, there is an effect of factor A (relative to the reference, or another level of factor A) for each of the <em>p</em> levels of factor B. And, there is an effect of factor B (relative to the reference, or another level of factor B) for each of the <em>m</em> levels of factor A. These effects of one factor at each of the levels of the other factor are called the <strong>simple effects</strong>. I prefer <strong>conditional effects</strong>, since the value of the effect is conditional on the level of the other factor.</p>
<p>For the mouse lesian area experiment, there is a chromosome effect at <code>sex = Female</code> and a different effect at <code>sex = Male</code>. Similarly, there is a sex effect at <code>chromosome = XX</code> and a different effect at <code>chromosome = XY</code>.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Conditional (or "simple") effects of the factorial model.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">chromosome</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sex</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">XX</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">Male - Female</td>
<td style="text-align: right;">-0.018</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">-0.126</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">-0.370</td>
<td style="text-align: right;">0.71716</td>
</tr>
<tr class="even">
<td style="text-align: left;">XY</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">Male - Female</td>
<td style="text-align: right;">0.124</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.244</td>
<td style="text-align: right;">2.224</td>
<td style="text-align: right;">0.04309</td>
</tr>
<tr class="odd">
<td style="text-align: left;">.</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">XY - XX</td>
<td style="text-align: right;">-0.290</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">-0.404</td>
<td style="text-align: right;">-0.177</td>
<td style="text-align: right;">-5.479</td>
<td style="text-align: right;">0.00008</td>
</tr>
<tr class="even">
<td style="text-align: left;">.</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">XY - XX</td>
<td style="text-align: right;">-0.148</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">-0.261</td>
<td style="text-align: right;">-0.034</td>
<td style="text-align: right;">-2.786</td>
<td style="text-align: right;">0.01458</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The first two rows are the conditional effects of <code>sex</code> in each of the levels of <code>chromosome</code>. The last two rows are the conditional effects of <code>chromosome</code> in each of the levels of <code>sex</code>.</p>
<p>To help understand conditional effects, I add these to the <span class="math inline">\(m \times p\)</span> table of treatment combination means (<span class="citation" data-cites="tab-twoway-simple-effects">(<a href="#ref-tab-twoway-simple-effects" role="doc-biblioref"><strong>tab-twoway-simple-effects?</strong></a>)</span>). The values in the right-side column (orange) are the conditional effects of <code>sex</code> at each level of <code>chromosome</code> These values are the difference of the means in the associated row. For example, the conditional effect of <code>sex</code> when <code>chromosome = XY</code> is 0.124 (second value in orange column). The values in the bottom row (blue) are the conditional effects of <code>chromosome</code> at each level of <code>sex</code>. These values are the difference of the means in the associated column. For example, the conditional effect of <code>chromosome</code> when <code>sex = Female</code> is -0.29 (first value in blue row). Note that the first conditional effect for each factor has a corresponding row in the table of coefficients of the fit model because these are the effects for that factor at the reference level of the other factor.</p>
<div class="cell">
<div id="tbl-twoway-simple-effects" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twoway-simple-effects-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.4: Conditional ("simple") effects of sex (orange background) and chromosome (blue background) on lesian area. The conditional means of each combination of the factor levels are in the cells with the white background. The simple effect is the difference in the means of the associated row or column.
</figcaption>
<div aria-describedby="tbl-twoway-simple-effects-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Female</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Male</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">simple</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">XX</td>
<td style="text-align: right; background-color: white !important;">0.54</td>
<td style="text-align: right; background-color: white !important;">0.522</td>
<td style="text-align: right; background-color: rgba(230, 159, 0, 255) !important;">-0.018</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">XY</td>
<td style="text-align: right; background-color: white !important;">0.25</td>
<td style="text-align: right; background-color: white !important;">0.374</td>
<td style="text-align: right; background-color: rgba(230, 159, 0, 255) !important;">0.124</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">simple</td>
<td style="text-align: right; background-color: rgba(86, 180, 233, 255) !important;">-0.29</td>
<td style="text-align: right; background-color: rgba(86, 180, 233, 255) !important;">-0.148</td>
<td style="text-align: right; background-color: white !important;"></td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
</section>
<section id="sec-twoway-marginal-effects" class="level3" data-number="13.5.3">
<h3 data-number="13.5.3" class="anchored" data-anchor-id="sec-twoway-marginal-effects"><span class="header-section-number">13.5.3</span> Marginal effects</h3>
<p>The average of the conditional effects for a factor are the <strong>marginal effects</strong>, or the <strong>main effects</strong> in ANOVA terminology.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(exp3e_m1, <span class="at">specs =</span> <span class="st">"sex"</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"revpairwise"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast      estimate     SE df t.ratio p.value
 Male - Female   0.0529 0.0375 14   1.411  0.1800

Results are averaged over the levels of: chromosome </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(exp3e_m1, <span class="at">specs =</span> <span class="st">"chromosome"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"revpairwise"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast estimate     SE df t.ratio p.value
 XY - XX    -0.219 0.0375 14  -5.844  &lt;.0001

Results are averaged over the levels of: sex </code></pre>
</div>
</div>
<p>I’m showing the full output from the emmeans package output to highlight the warning that the inference “may be misleading” because of the interaction effect in the linear model. This is a healthy warning that I follow up on below.</p>
<p>In <a href="#tbl-twoway-main" class="quarto-xref">Table&nbsp;<span>13.5</span></a>, I add the marginal effects to the table of conditional effects from above (<a href="#tbl-twoway-simple-effects" class="quarto-xref">Table&nbsp;<span>13.4</span></a>).</p>
<div class="cell">
<div id="tbl-twoway-main" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twoway-main-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.5: Marginal effects of sex (orange) and chromosome (blue) on lesian area. Simple effects are in grey cells. The conditional means of each combination of the factor levels are in the white cells.
</figcaption>
<div aria-describedby="tbl-twoway-main-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Female</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Male</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">simple</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">marginal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">XX</td>
<td style="text-align: right; background-color: white !important;">0.54</td>
<td style="text-align: right; background-color: white !important;">0.522</td>
<td style="text-align: right; background-color: rgba(134, 134, 134, 153) !important;">-0.018</td>
<td style="text-align: right; background-color: white !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">XY</td>
<td style="text-align: right; background-color: white !important;">0.25</td>
<td style="text-align: right; background-color: white !important;">0.374</td>
<td style="text-align: right; background-color: rgba(134, 134, 134, 153) !important;">0.124</td>
<td style="text-align: right; background-color: white !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">simple</td>
<td style="text-align: right; background-color: rgba(134, 134, 134, 153) !important;">-0.29</td>
<td style="text-align: right; background-color: rgba(134, 134, 134, 153) !important;">-0.148</td>
<td style="text-align: right; background-color: white !important;"></td>
<td style="text-align: right; background-color: rgba(86, 180, 233, 255) !important;">-0.219</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">marginal</td>
<td style="text-align: right; background-color: white !important;"></td>
<td style="text-align: right; background-color: white !important;"></td>
<td style="text-align: right; background-color: rgba(230, 159, 0, 255) !important;">0.053</td>
<td style="text-align: right; background-color: white !important;"></td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
</section>
<section id="the-additive-model" class="level3" data-number="13.5.4">
<h3 data-number="13.5.4" class="anchored" data-anchor-id="the-additive-model"><span class="header-section-number">13.5.4</span> The additive model</h3>
<p>Marginal effects can be useful for summarizing a general trend, but, like any average, might not be especially meaningful if there is large heterogeneity of the simple effects, which occurs when the interaction effect is large.</p>
<p>If an interaction effect is small, and we want to summarize the results as general trends (“sex does this, chromosome does that”), then the best practice strategy is to refit a new linear model that estimates the effects of the two factors as if the interaction were equal to zero.</p>
<p><span id="eq-twoway-reduced"><span class="math display">\[
\begin{align}
\texttt{lesian\_area} &amp;= \beta_0 \ + \\
&amp;\quad \ \beta_1 \texttt{sex}_\texttt{Male} \ + \\
&amp;\quad \ \beta_2 \texttt{chromosome}_\texttt{XY}
\end{align}
\tag{13.1}\]</span></span></p>
<p>Model <a href="#eq-twoway-reduced" class="quarto-xref">Equation&nbsp;<span>13.1</span></a> is a <strong>reduced model</strong> because one of the terms has been removed from the model. This particular reduced model is often referred to as the <strong>additive model</strong>, since it excludes the interaction term, which is non-additive effect (the indicator variable is the product of two “main” indicator variables). In R, this model is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>exp3e_m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lesian_area <span class="sc">~</span> sex <span class="sc">+</span> chromosome, <span class="at">data =</span> exp3e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model coefficients of the additive model are</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Model coefficients of additive model.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.508</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">15.06</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.436</td>
<td style="text-align: right;">0.580</td>
</tr>
<tr class="even">
<td style="text-align: left;">sexMale</td>
<td style="text-align: right;">0.045</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">0.283</td>
<td style="text-align: right;">-0.041</td>
<td style="text-align: right;">0.131</td>
</tr>
<tr class="odd">
<td style="text-align: left;">chromosomeXY</td>
<td style="text-align: right;">-0.219</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">-5.39</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-0.306</td>
<td style="text-align: right;">-0.132</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Explainer</p>
<ol type="1">
<li><code>sexMale</code> is the average of the two conditional effects of “Male” (one at <code>chromosome = "XX"</code> and one at <code>chromosome = "XY</code>).</li>
<li><code>chromosomeXY</code> is the average of the two conditional effects of “XY” (one at <code>sex = "Female"</code> and one at <code>sex = "Male</code>).</li>
<li><code>(Intercept)</code> is the expected value without the added <code>sexMale</code> or <code>chromosomeXY</code> effects. This is a very abstract “average” of Female XX and is not the average value in the Female XX group.</li>
</ol>
<p>The conditional effects of the reduced model are</p>
<div class="cell">
<div id="tbl-twoway-exp3e-m2-pairs" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twoway-exp3e-m2-pairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.6: Conditional effects of additive model.
</figcaption>
<div aria-describedby="tbl-twoway-exp3e-m2-pairs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">chromosome</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sex</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">XX</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">Male - Female</td>
<td style="text-align: right;">0.04495</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-0.041</td>
<td style="text-align: right;">0.131</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">0.28292</td>
</tr>
<tr class="even">
<td style="text-align: left;">XY</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">Male - Female</td>
<td style="text-align: right;">0.04495</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-0.041</td>
<td style="text-align: right;">0.131</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">0.28292</td>
</tr>
<tr class="odd">
<td style="text-align: left;">.</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">XY - XX</td>
<td style="text-align: right;">-0.21895</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-0.306</td>
<td style="text-align: right;">-0.132</td>
<td style="text-align: right;">-5.39</td>
<td style="text-align: right;">0.00007</td>
</tr>
<tr class="even">
<td style="text-align: left;">.</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">XY - XX</td>
<td style="text-align: right;">-0.21895</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">-0.306</td>
<td style="text-align: right;">-0.132</td>
<td style="text-align: right;">-5.39</td>
<td style="text-align: right;">0.00007</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p>Explainer</p>
<ol type="1">
<li>In an additive model, all conditional effects for one factor are the same for each level of the other factor. This makes sense. If the model fit is additive, the interaction effect is set to zero by the model and there cannot be differences in conditional effects among the contrasts at each of the levels of the other factor (otherwise, there would be an interaction). A more sensible way of thinking about this is, it doesn’t make sense to compute or discuss conditional effects in an additive model. Instead, an additive model automatically estimates marginal effects.</li>
<li>Compare the table of marginal effects of the additive model to the table of marginal effects of the full model. The estimates for the chromosome effect are the same but the <em>t</em>-values and <em>p</em>-values differ because of different degrees of freedom (the full model estimates one more parameter, the interaction effect). The estimates for the sex effect are not the same between the two tables because of an imbalance of sample size. In the computation of the marginal effect of chromosome, the two simple effects both have sample size of 5 and 4. But in the computation of the marginal effect of sex, one simple effect has sample size of 5 and 5 while the other has a simple effect of 4 and 4.</li>
</ol>
</section>
<section id="twoway-reduce" class="level3" data-number="13.5.5">
<h3 data-number="13.5.5" class="anchored" data-anchor-id="twoway-reduce"><span class="header-section-number">13.5.5</span> Reduce models for the right reason</h3>
<p>Unless one factor truly has no effect, there will always be an interaction. As stated above, interactions are ubiquitous. If an interaction is small, it can make sense to drop the interaction term and re-fit an additive model to estimate marginal effects in order to present a simplified picture of what is going on, with the recognition that these estimates are smoothing over the heterogenity in conditional (simple) effects that truly exist.</p>
<p>Aided and abetted by statistics textbooks for biologists, there is a long history of researchers dropping an interaction effect because the interaction <span class="math inline">\(p&gt;0.05\)</span>. A good rule of thumb is, don’t make model decisions based on <em>p</em>-values. It doesn’t make any sense.</p>
<ol type="1">
<li>The <span class="math inline">\(p\)</span>-value is an arbitrary dichotomization of a continuous variable. Would it make sense to behave differently if the interaction were <span class="math inline">\(p=0.06\)</span> vs.&nbsp;<span class="math inline">\(p=0.04\)</span>, given that these two p-values are effectively identical?</li>
<li>A <span class="math inline">\(p\)</span>-value is not evidence that an effect is zero, or “doesn’t exist”, or even that an effect is “trivially small”. This is because <span class="math inline">\(p\)</span>-values are a function of measurement error, sampling error, and sample size, in addition to effect size.</li>
</ol>
<p>The interaction <em>p</em>-value for the lesion-area data is 0.078. Should we refit the additive model and report a simpler story of “a” chromosome effect and “a” sex effect? This reduced model isn’t invalid and it is useful. Some considerations.</p>
<ol type="1">
<li>there is certainly a real interaction between these two factors and this interaction reflects interesting biology.</li>
<li>For this example, I might report both – the additive effect in the main paper (since the big chromosome complement effect is the story) and the conditional effects in the supplement, which might further work on investigating the underlying biology. Or maybe two sets of <em>p</em>-values on the plot? There are lots of unexplored ways to provide more “ways” of looking at the results.</li>
<li>Regardless, for this example, I would not avoid reporting the interaction effect and the conditional effects somewhere. The estimated interaction effect (0.14 mm<span class="math inline">\(^2\)</span>) is moderately large relative to the four simple effects. It’s much bigger than the marginal effect of sex and about 2/3 the size of the marginal effect of chromosome (<a href="#tbl-twoway-exp3e-m2-pairs" class="quarto-xref">Table&nbsp;<span>13.6</span></a>).</li>
<li>A response plot of both models (<a href="#fig-twoway-additive-plot" class="quarto-xref">Figure&nbsp;<span>13.6</span></a>) can help understanding and the decision of which model to report.</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div id="fig-twoway-additive-plot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-twoway-additive-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="two-factors_files/figure-html/fig-twoway-additive-plot-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoway-additive-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.6: A. Conditional means and p-values of conditional effects. B. Marginal means and p-values of marginal effects.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird" class="level3" data-number="13.5.6">
<h3 data-number="13.5.6" class="anchored" data-anchor-id="the-marginal-means-of-an-additive-linear-model-with-two-factors-can-be-weird"><span class="header-section-number">13.5.6</span> The marginal means of an additive linear model with two factors can be weird</h3>
<p>To better understand the marginal effects computed from the additive model, let’s compare the emmeans table of the factorial and additive models.</p>
<div class="cell">
<div id="tbl-twoway-exp3e_m1_emm" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twoway-exp3e_m1_emm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.7: Conditional means of the lesian area data computed from the factorial model.
</figcaption>
<div aria-describedby="tbl-twoway-exp3e_m1_emm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sex</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">chromosome</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">emmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">XX</td>
<td style="text-align: right;">0.540</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.464</td>
<td style="text-align: right;">0.616</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">XX</td>
<td style="text-align: right;">0.522</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.446</td>
<td style="text-align: right;">0.597</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">XY</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.165</td>
<td style="text-align: right;">0.335</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">XY</td>
<td style="text-align: right;">0.374</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.289</td>
<td style="text-align: right;">0.459</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div id="tbl-twoway-exp3e_m2_emm" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twoway-exp3e_m2_emm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.8: Marginal means of the lesian area data computed from the additive model.
</figcaption>
<div aria-describedby="tbl-twoway-exp3e_m2_emm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sex</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">chromosome</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">emmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">XX</td>
<td style="text-align: right;">0.508</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.436</td>
<td style="text-align: right;">0.580</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">XX</td>
<td style="text-align: right;">0.553</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.481</td>
<td style="text-align: right;">0.625</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">XY</td>
<td style="text-align: right;">0.289</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.212</td>
<td style="text-align: right;">0.367</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">XY</td>
<td style="text-align: right;">0.334</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.257</td>
<td style="text-align: right;">0.412</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p>Explainer</p>
<ol type="1">
<li>The means in the conditional means table (<a href="#tbl-twoway-exp3e_m1_emm" class="quarto-xref">Table&nbsp;<span>13.7</span></a>) are equal to the sample means. These are conditional on <code>sex</code> and <code>chromosome</code>.</li>
<li>The means in the marginal means table (<a href="#tbl-twoway-exp3e_m2_emm" class="quarto-xref">Table&nbsp;<span>13.8</span></a>) are not equal to the sample means. These are modeled means of the four groups from a model in which there is no interaction effect, so all conditional effects for one factor are the same for each level of the other factor. If you take the difference of Male - Female for both the XX and the XY groups, these will be the same. All data has some measured interaction (even if there is no true interaction. But remember, interaction is ubiquitous in biology). The larger this interaction, the more weird the marginal means because these are less compatible with the data.</li>
</ol>
</section>
</section>
<section id="example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="example-3-estimation-of-synergy-more-than-the-sum-of-the-parts-experiment-1c-ja-data"><span class="header-section-number">13.6</span> Example 3: Estimation of synergy (“More than the sum of the parts”) (Experiment 1c JA data)</h2>
<p>To explain what synergy is and why it is estimated by the interaction effect, this example uses data from an experiment measuring the effect of two defense signals on the defense response in Maize plants. In response to herbivory from insects, maize, and other plants, release multiple, chemical signals into the air (chemicals that evaporate into the air are known as volatile compounds). These chemicals signal the plant, and neighboring plants, to secrete anti-herbivory hormones, including abcisic acid and jasmonic acid. The researchers investigated the effects of two volatile compounds, (Z)‐3‐hexenyl acetate (HAC) and Indole, on the defense response both each without the other and in combination.</p>
<p>The example data come from Figure 1c, which is the effect of HAC and Indole on tissue concentrations of the hormone jasmonic acid (JA). The design is fully crossed with two factors, each with two levels: <code>hac</code>, with levels “HAC-” and “HAC+”, and <code>indole</code>, with levels (“Indole-” and “Indole+”).</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">HAC-</th>
<th style="text-align: left;">HAC+</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Indole-</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">HAC</td>
</tr>
<tr class="even">
<td style="text-align: left;">Indole+</td>
<td style="text-align: left;">Indole</td>
<td style="text-align: left;">HAC+Indole</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="examine-the-data" class="level3" data-number="13.6.1">
<h3 data-number="13.6.1" class="anchored" data-anchor-id="examine-the-data"><span class="header-section-number">13.6.1</span> Examine the data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> ja, <span class="at">data =</span> exp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `qplot()` was deprecated in ggplot2 3.4.0.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="two-factors_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Too few points for box plot. control variance is small. No obvious implausible points. fit with lm but recognize small n warning for any inference.</p>
</section>
<section id="fit-the-model" class="level3" data-number="13.6.2">
<h3 data-number="13.6.2" class="anchored" data-anchor-id="fit-the-model"><span class="header-section-number">13.6.2</span> Fit the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>exp1c_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ja <span class="sc">~</span> hac <span class="sc">*</span> indole, <span class="at">data =</span> exp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-check" class="level3" data-number="13.6.3">
<h3 data-number="13.6.3" class="anchored" data-anchor-id="model-check"><span class="header-section-number">13.6.3</span> Model check</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcheck_the_model</span>(exp1c_m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in rlm.default(x, y, weights, method = method, wt.method = wt.method, :
'rlm' failed to converge in 20 steps</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="two-factors_files/figure-html/twoway-ja-check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The distribution looks like a sample from a Normal. The variance looks like it increases with the mean. This suggest gls modeling heterogeneity.</p>
</section>
<section id="inference-from-the-model-1" class="level3" data-number="13.6.4">
<h3 data-number="13.6.4" class="anchored" data-anchor-id="inference-from-the-model-1"><span class="header-section-number">13.6.4</span> Inference from the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>exp1c_m1_coef <span class="ot">&lt;-</span> <span class="fu">tidy</span>(exp1c_m1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>exp1c_m1_coef <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">43.862</td>
<td style="text-align: right;">4.881</td>
<td style="text-align: right;">8.986</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">33.515</td>
<td style="text-align: right;">54.210</td>
</tr>
<tr class="even">
<td style="text-align: left;">hacHAC+</td>
<td style="text-align: right;">15.615</td>
<td style="text-align: right;">6.903</td>
<td style="text-align: right;">2.262</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.982</td>
<td style="text-align: right;">30.249</td>
</tr>
<tr class="odd">
<td style="text-align: left;">indoleIndole+</td>
<td style="text-align: right;">13.104</td>
<td style="text-align: right;">6.903</td>
<td style="text-align: right;">1.898</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">-1.529</td>
<td style="text-align: right;">27.738</td>
</tr>
<tr class="even">
<td style="text-align: left;">hacHAC+:indoleIndole+</td>
<td style="text-align: right;">29.813</td>
<td style="text-align: right;">9.762</td>
<td style="text-align: right;">3.054</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">9.118</td>
<td style="text-align: right;">50.508</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>exp1c_m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(exp1c_m1, <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">"hac"</span>, <span class="st">"indole"</span>))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>exp1c_m1_emm <span class="sc">|&gt;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">hac</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">indole</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">emmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">HAC-</td>
<td style="text-align: left;">Indole-</td>
<td style="text-align: right;">43.9</td>
<td style="text-align: right;">4.88</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">33.5</td>
<td style="text-align: right;">54.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">HAC+</td>
<td style="text-align: left;">Indole-</td>
<td style="text-align: right;">59.5</td>
<td style="text-align: right;">4.88</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">49.1</td>
<td style="text-align: right;">69.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HAC-</td>
<td style="text-align: left;">Indole+</td>
<td style="text-align: right;">57.0</td>
<td style="text-align: right;">4.88</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">46.6</td>
<td style="text-align: right;">67.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">HAC+</td>
<td style="text-align: left;">Indole+</td>
<td style="text-align: right;">102.4</td>
<td style="text-align: right;">4.88</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">92.0</td>
<td style="text-align: right;">112.7</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exp1c_m1_emm # print in console to get row numbers</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set the mean as the row number from the emmeans table</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>ref <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>hac <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>indole <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>hac_indole <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts are the difference in the vectors created above</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># these planned contrasts are described above</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. (hac+/indole- - hac-/indole-) # add hac</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. (hac-/indole+ -  hac-/indole-) # add indole</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. (hac+/indole+ - hac-/indole+) - (hac+/indole- - hac-/indole-) # Interaction</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>exp1c_m1_planned <span class="ot">&lt;-</span> <span class="fu">contrast</span>(</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  exp1c_m1_emm,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">list</span>(</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hac+"</span> <span class="ot">=</span> <span class="fu">c</span>(hac <span class="sc">-</span> ref),</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"indole+"</span> <span class="ot">=</span> <span class="fu">c</span>(indole <span class="sc">-</span> ref),</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"HAC/Indole Ixn"</span> <span class="ot">=</span> <span class="fu">c</span>(hac_indole <span class="sc">-</span> indole) <span class="sc">-</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>      (hac <span class="sc">-</span> ref)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">adjust =</span> <span class="st">"none"</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>exp1c_m1_planned <span class="sc">|&gt;</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>)) <span class="sc">|&gt;</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">hac+</td>
<td style="text-align: right;">15.62</td>
<td style="text-align: right;">6.903</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">30.25</td>
<td style="text-align: right;">2.26</td>
<td style="text-align: right;">0.03796</td>
</tr>
<tr class="even">
<td style="text-align: left;">indole+</td>
<td style="text-align: right;">13.10</td>
<td style="text-align: right;">6.903</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">-1.53</td>
<td style="text-align: right;">27.74</td>
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">0.07583</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HAC/Indole Ixn</td>
<td style="text-align: right;">29.81</td>
<td style="text-align: right;">9.762</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">9.12</td>
<td style="text-align: right;">50.51</td>
<td style="text-align: right;">3.05</td>
<td style="text-align: right;">0.00758</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="plot-the-model-2" class="level3" data-number="13.6.5">
<h3 data-number="13.6.5" class="anchored" data-anchor-id="plot-the-model-2"><span class="header-section-number">13.6.5</span> Plot the model</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="two-factors_files/figure-html/twoway-ja-plot-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="alternative-plot" class="level3" data-number="13.6.6">
<h3 data-number="13.6.6" class="anchored" data-anchor-id="alternative-plot"><span class="header-section-number">13.6.6</span> Alternative plot</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="two-factors_files/figure-html/twoway-ja-alternaplot-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption>An alternative plot for showing the estimate of synergy. Gray, dashed line is the expected mean of the HAC + Indole group if the interaction is zero.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="understanding-the-linear-model-with-crossed-factors-3" class="level2" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="understanding-the-linear-model-with-crossed-factors-3"><span class="header-section-number">13.7</span> Understanding the linear model with crossed factors 3</h2>
<section id="thinking-about-the-coefficients-of-the-linear-model" class="level3" data-number="13.7.1">
<h3 data-number="13.7.1" class="anchored" data-anchor-id="thinking-about-the-coefficients-of-the-linear-model"><span class="header-section-number">13.7.1</span> Thinking about the coefficients of the linear model</h3>
<p><span id="eq-factorial-full"><span class="math display">\[
\begin{align}
\texttt{ja} &amp;= \beta_0  \ + \\
&amp;\quad \ \beta_1 (\texttt{hac}_\texttt{HAC+}) \ + \\  
&amp;\quad \ \beta_2 (\texttt{indole}_\texttt{Indole+}) \ + \\  
&amp;\quad \ \beta_3 (\texttt{hac}_\texttt{HAC+}:\texttt{indole}_\texttt{Indole+})
\end{align}
\tag{13.2}\]</span></span></p>
<p>The linear model makes it easy to understand synergy in the <span class="math inline">\(2 \times 2\)</span> design. If we start with the mean of the reference (the group without the added HAC or Indole), then <span class="math inline">\(\beta_1\)</span> is the extra bit due to adding HAC, <span class="math inline">\(\beta_2\)</span> is the extra bit due to adding Indole, and <span class="math inline">\(\beta_3\)</span> is the extra bit due to synergy between HAC and Indole. A positive <span class="math inline">\(\beta_3\)</span> means the combined treatment effect is more than the sum of the parts.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Coefficient table of the factorial model</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">43.86</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">8.986</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">33.51</td>
<td style="text-align: right;">54.21</td>
</tr>
<tr class="even">
<td style="text-align: left;">hacHAC+</td>
<td style="text-align: right;">15.62</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">2.262</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">30.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">indoleIndole+</td>
<td style="text-align: right;">13.10</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">1.898</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-1.53</td>
<td style="text-align: right;">27.74</td>
</tr>
<tr class="even">
<td style="text-align: left;">hacHAC+:indoleIndole+</td>
<td style="text-align: right;">29.81</td>
<td style="text-align: right;">9.8</td>
<td style="text-align: right;">3.054</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">9.12</td>
<td style="text-align: right;">50.51</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Again, the interaction is a <strong>non-additive effect</strong>. Adding HAC alone increases JA concentration by 15.6 ng per g FW. Adding Indole alone increases JA concentration by 13.1 ng per g FW. If these effects were purely additive, then adding both HAC and Indole to the Control mean should result in a mean of 43.9 + 15.6 + 13.1 = 72.6 ng per g FW in the HAC+Indole group. The modeled mean is 102.4 ng per g FW. The difference (observed - additive) is 102.4 - 72.6 = 29.8 ng per g FW. This is the estimated interaction effect in the coefficient table.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="two-factors_files/figure-html/twoway-synergy-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Synergy is the bit needed to get to the HAC + Indole mean after adding the HAC effect and the Indole effect to the Control mean</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="issues-in-inference" class="level2" data-number="13.8">
<h2 data-number="13.8" class="anchored" data-anchor-id="issues-in-inference"><span class="header-section-number">13.8</span> Issues in inference</h2>
<section id="for-pairwise-inference-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model-but" class="level3" data-number="13.8.1">
<h3 data-number="13.8.1" class="anchored" data-anchor-id="for-pairwise-inference-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model-but"><span class="header-section-number">13.8.1</span> For pairwise inference, it doesn’t matter if you fit a factorial or a flattened linear model, but…</h3>
<p>Compare the pairwise comparisons of the Experiment 2j glucose uptake data using a factorial linear model and a flattened linear model.</p>
<p>Factorial:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose_uptake <span class="sc">~</span> stimulation <span class="sc">*</span> genotype, <span class="at">data =</span> exp2j)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">"stimulation"</span>, <span class="st">"genotype"</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"revpairwise"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">"tukey"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>m1_pairs <span class="sc">|&gt;</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Active WT - Rest WT</td>
<td style="text-align: right;">3.448</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1.820</td>
<td style="text-align: right;">5.076</td>
<td style="text-align: right;">5.826</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rest KO - Rest WT</td>
<td style="text-align: right;">0.780</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-0.978</td>
<td style="text-align: right;">2.539</td>
<td style="text-align: right;">1.220</td>
<td style="text-align: right;">0.620</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rest KO - Active WT</td>
<td style="text-align: right;">-2.668</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-4.427</td>
<td style="text-align: right;">-0.910</td>
<td style="text-align: right;">-4.173</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">Active KO - Rest WT</td>
<td style="text-align: right;">1.921</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">0.236</td>
<td style="text-align: right;">3.606</td>
<td style="text-align: right;">3.136</td>
<td style="text-align: right;">0.021</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Active KO - Active WT</td>
<td style="text-align: right;">-1.527</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-3.212</td>
<td style="text-align: right;">0.158</td>
<td style="text-align: right;">-2.493</td>
<td style="text-align: right;">0.086</td>
</tr>
<tr class="even">
<td style="text-align: left;">Active KO - Rest KO</td>
<td style="text-align: right;">1.141</td>
<td style="text-align: right;">0.659</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-0.671</td>
<td style="text-align: right;">2.953</td>
<td style="text-align: right;">1.733</td>
<td style="text-align: right;">0.329</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Flattened:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose_uptake <span class="sc">~</span> treatment, <span class="at">data =</span> exp2j)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>m2_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m2, <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">"treatment"</span>))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>m2_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m2_emm,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"revpairwise"</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">"tukey"</span>) <span class="sc">|&gt;</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>m2_pairs <span class="sc">|&gt;</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">WT Active - WT Rest</td>
<td style="text-align: right;">3.448</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1.820</td>
<td style="text-align: right;">5.076</td>
<td style="text-align: right;">5.826</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">KO Rest - WT Rest</td>
<td style="text-align: right;">0.780</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-0.978</td>
<td style="text-align: right;">2.539</td>
<td style="text-align: right;">1.220</td>
<td style="text-align: right;">0.620</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KO Rest - WT Active</td>
<td style="text-align: right;">-2.668</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-4.427</td>
<td style="text-align: right;">-0.910</td>
<td style="text-align: right;">-4.173</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">KO Active - WT Rest</td>
<td style="text-align: right;">1.921</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">0.236</td>
<td style="text-align: right;">3.606</td>
<td style="text-align: right;">3.136</td>
<td style="text-align: right;">0.021</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KO Active - WT Active</td>
<td style="text-align: right;">-1.527</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-3.212</td>
<td style="text-align: right;">0.158</td>
<td style="text-align: right;">-2.493</td>
<td style="text-align: right;">0.086</td>
</tr>
<tr class="even">
<td style="text-align: left;">KO Active - KO Rest</td>
<td style="text-align: right;">1.141</td>
<td style="text-align: right;">0.659</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-0.671</td>
<td style="text-align: right;">2.953</td>
<td style="text-align: right;">1.733</td>
<td style="text-align: right;">0.329</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>::: {.callout-tip, title=“Here’s the but…} But…just fit the factorial model. This makes it much easier to get the best practice mindless contrasts (the simple effects) and the interaction effect (either from the coefficient table or the emmeans package) and if Reviewer 2/PI/boss/old-school colleague demands p-value adjustment you will have slightly more power adjusting for a family of four simple effects than six pairwise comparisons (see below). :::</p>
</section>
<section id="for-interaction-interaction-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model-but" class="level3" data-number="13.8.2">
<h3 data-number="13.8.2" class="anchored" data-anchor-id="for-interaction-interaction-it-doesnt-matter-if-you-fit-a-factorial-or-a-flattened-linear-model-but"><span class="header-section-number">13.8.2</span> For interaction interaction, it doesn’t matter if you fit a factorial or a flattened linear model, but…</h3>
<p>Factorial model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using m1 from above</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>m1_ixn <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">interaction =</span> <span class="st">"revpairwise"</span>) <span class="sc">|&gt;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>m1_ixn <span class="sc">|&gt;</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">stimulation_revpairwise</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">genotype_revpairwise</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Active - Rest</td>
<td style="text-align: left;">KO - WT</td>
<td style="text-align: right;">-2.307</td>
<td style="text-align: right;">0.885</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-4.131</td>
<td style="text-align: right;">-0.484</td>
<td style="text-align: right;">-2.606</td>
<td style="text-align: right;">0.015</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Flattened model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># need to compute the interaction as a contrast</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using m2 from the previous chunk</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># m2_emm # print in console to get row numbers</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set the mean as the row number from the emmeans table</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>wt_rest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>wt_active <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>ko_rest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>ko_active <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts are the difference in the vectors created above</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. (KO Active - WT Active) - (KO Rest - WT Rest) -- interaction </span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>m2_ixn <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m2_emm,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="fu">list</span>(</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"KO:Active Ixn"</span> <span class="ot">=</span> <span class="fu">c</span>(ko_active <span class="sc">-</span> wt_active) <span class="sc">-</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>                       (ko_rest <span class="sc">-</span> wt_rest)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>                   )) <span class="sc">|&gt;</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>m2_ixn <span class="sc">|&gt;</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">KO:Active Ixn</td>
<td style="text-align: right;">-2.307</td>
<td style="text-align: right;">0.885</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-4.131</td>
<td style="text-align: right;">-0.484</td>
<td style="text-align: right;">-2.606</td>
<td style="text-align: right;">0.015</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>::: {.callout-tip, title=“Here’s the but…} But…see the previous tip :::</p>
</section>
<section id="twoway-multiple-tests" class="level3" data-number="13.8.3">
<h3 data-number="13.8.3" class="anchored" data-anchor-id="twoway-multiple-tests"><span class="header-section-number">13.8.3</span> Adjusting <em>p</em>-values for multiple tests</h3>
<p>First, you probably don’t want to adjust for multiple tests in a 2 x 2 (or larger) design (<a href="multiple-testing.html" class="quarto-xref"><span>Chapter 12</span></a>). Or, if you do, you want to adjust for multiple responses, not multiple contrasts within one response (<a href="multiple-testing.html" class="quarto-xref"><span>Chapter 12</span></a>). Understand that the norm in experimental bench biology misunderstands what a <strong>family of tests</strong> is (<a href="multiple-testing.html" class="quarto-xref"><span>Chapter 12</span></a>).</p>
<p>But, if Reviewer 2, or your PI, or an older colleague demands <em>p</em>-value adjustment, <a href="https://en.wikipedia.org/wiki/Just_Say_No" target="_blank">just say no</a>. If you cannot, then read on.</p>
<p>Here are seven different adjustment methods (including no adjustment) for the simple effects of the <code>exp2j</code> data.</p>
<div class="cell">
<div id="tbl-twoway-exp2j-p-adjust" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twoway-exp2j-p-adjust-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.9: P-values from seven different methods of adjustment. The Tukey-all p-value is from all six pairwise comparisons. All other p-values are from the four simple effects.
</figcaption>
<div aria-describedby="tbl-twoway-exp2j-p-adjust-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">None</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Tukey-all</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Bonferroni</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sidak</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Holm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MvT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Active WT - Rest WT</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Active KO - Rest KO</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.329</td>
<td style="text-align: right;">0.382</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: right;">0.127</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rest KO - Rest WT</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.935</td>
<td style="text-align: right;">0.655</td>
<td style="text-align: right;">0.234</td>
<td style="text-align: right;">0.561</td>
<td style="text-align: right;">0.234</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(230, 159, 0, 255) !important;">Active KO - Active WT</td>
<td style="text-align: right; background-color: rgba(230, 159, 0, 255) !important;">0.02</td>
<td style="text-align: right; background-color: rgba(230, 159, 0, 255) !important;">0.086</td>
<td style="text-align: right; background-color: rgba(230, 159, 0, 255) !important;">0.079</td>
<td style="text-align: right; background-color: rgba(230, 159, 0, 255) !important;">0.076</td>
<td style="text-align: right; background-color: rgba(230, 159, 0, 255) !important;">0.059</td>
<td style="text-align: right; background-color: rgba(230, 159, 0, 255) !important;">0.066</td>
<td style="text-align: right; background-color: rgba(230, 159, 0, 255) !important;">0.039</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<ol type="1">
<li><strong>None</strong> – no adjustment</li>
<li><strong>Tukey</strong> – <a href="https://en.wikipedia.org/wiki/Tukey%27s_range_test" target="_blank">Tukey’s HSD method</a> is the most common method used to compare all pairwise comparisons.</li>
<li><strong>Bonferroni</strong> – <a href="https://en.wikipedia.org/wiki/Bonferroni_correction" target="_blank">Bonferroni</a> is a general purpose method to compare any set of multiple tests. The test is conservative. Use the Holm modification instead.</li>
<li><strong>Sidak</strong> – <a href="https://en.wikipedia.org/wiki/Šidák_correction" target="_blank">Sidak correction</a> is a modification of Bonferroni with slightly more power.</li>
<li><strong>Holm</strong> – <a href="https://en.wikipedia.org/wiki/Holm–Bonferroni_method" target="_blank">Holm-Bonferroni</a> is a modification of Bonferroni with more power. Use this instead of Bonferroni.</li>
<li><strong>BH</strong> – controls the <a href="https://en.wikipedia.org/wiki/False_discovery_rate" target="_blank">false discovery rate</a> not the Type I error rate for a family of tests. See <span class="quarto-unresolved-ref">?sec-mult-tests-fdr</span> for full explanation of FDR and when we would want to use it.</li>
<li><strong>Mvt</strong> – based on the multivariate <em>t</em> distribution and using covariance structure of the variables.</li>
</ol>
<p>Further thoughts on multiple adjustment, focusing on the highlighted row in the table.</p>
<ol type="1">
<li>Report the focal p-values on the figure. Then, report all pairwise and interaction, <em>p</em>-values in a supplement. Reporting all <em>p</em>-values on the figure overwhelms the principal message of a figure. There should be a table of these for every experiment in the supplement.</li>
<li>If you’re following best practice, report the focal <em>none-adjusted</em> p-values in the figure. Then, in the supplement, report the none-adjusted and adjusted value for all pairwise comparisons <strong>and interaction effects</strong>.</li>
<li>If you’ve adjusted for multiple response variables (<a href="multiple-testing.html" class="quarto-xref"><span>Chapter 12</span></a>), report the focal, adjusted values on the figure (adjusted for multple responses, not multiple tests within a response). Then, in the supplement, report the none-adjusted and adjusted value for all pairwise comparisons <strong>and interaction effects</strong>, again, using the adjustment for multiple responses not multiple tests within a response.</li>
<li>In a Fisherian world-view of <em>p</em>-values, there just isn’t any real difference in inference between <span class="math inline">\(p = 0.02\)</span> (no adjustment) and <span class="math inline">\(p = 0.086\)</span> (Tukey adjustment from all pairwise comparisons). Fisher expected decisions based on multiple replications of the experiment, all (or nearly) with <span class="math inline">\(p &lt; 0.05\)</span>. From a Fisherian-world-view, then, we have bigger how-to-do-science issues than multiple testing if we are making decisions entirely on <span class="math inline">\(p = 0.02\)</span> versus <span class="math inline">\(p = 0.086\)</span>.</li>
<li>From a Neyman-Pearson testing world-view, there is a consequential difference in inference between <span class="math inline">\(p = 0.02\)</span> (no adjustment) and <span class="math inline">\(p = 0.086\)</span> (Tukey adjustment from all pairwise comparisons) but I don’t think experimental bench biologists are practicing pure Neyman-Pearson.</li>
</ol>
</section>
</section>
<section id="two-way-anova" class="level2" data-number="13.9">
<h2 data-number="13.9" class="anchored" data-anchor-id="two-way-anova"><span class="header-section-number">13.9</span> Two-way ANOVA</h2>
<p>Both wet-bench and ecology/evolution experimental biologists do ANOVA. Many textbooks, advisors, and colleagues tell researchers to report “tests after ANOVA” – what I call pairwise contrasts – but in modern computing, pairwise contrasts and ANOVA tables are both computed from the same underlying regression model. The ANOVA is not necessary for any inference, a point I return to below.</p>
<p>Let’s use the glucose uptake experiment (Example 1) to explore the ANOVA table.</p>
<section id="how-to-read-a-two-way-anova-table" class="level3" data-number="13.9.1">
<h3 data-number="13.9.1" class="anchored" data-anchor-id="how-to-read-a-two-way-anova-table"><span class="header-section-number">13.9.1</span> How to read a two-way ANOVA table</h3>
<div class="cell">
<div id="tbl-twoway-anova-explainer" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twoway-anova-explainer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.10: ANOVA table of glucose uptake experiment (Example 1).
</figcaption>
<div aria-describedby="tbl-twoway-anova-explainer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Effect</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">F</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">stimulation</td>
<td style="text-align: left;">1, 25</td>
<td style="text-align: left;">26.86</td>
<td style="text-align: left;">&lt;.0001</td>
</tr>
<tr class="even">
<td style="text-align: left;">genotype</td>
<td style="text-align: left;">1, 25</td>
<td style="text-align: left;">0.71</td>
<td style="text-align: left;">.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stimulation:genotype</td>
<td style="text-align: left;">1, 25</td>
<td style="text-align: left;">6.79</td>
<td style="text-align: left;">.02</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p>Explainer</p>
<ol type="1">
<li>This ANOVA table is computed using Type III sum of squares and should match the output from most statistics software including Graphpad Prism. The relevance of this is addressed below.</li>
<li>In general, an ANOVA table has a row for each term in the underlying linear model. ANOVA is a method for decomposing the total variance into batches and each of these terms is a batch. For the linear model with two crossed factors, there is a term for each factor and a term for the interaction. <code>stimulation</code> and <code>genotype</code> are the <strong>main</strong> (or 1st order) effects. <code>stimulation:genotype</code> is the interaction (or 2nd order) effect. These terms are the row names of the table.</li>
<li>Some ANOVA functions in R also include a row for the variance of the residuals from the fit model. This row can be useful for learning what the values in ANOVA table are but only one statistic from the row (the residual df) is especially useful for reporting. In <a href="#tbl-twoway-anova-explainer" class="quarto-xref">Table&nbsp;<span>13.10</span></a>, this residual df is included in the statistics for each term.</li>
<li>Many ANOVA tables contain additional SS (sum of squares) and MSE (mean square error) columns. The MSE is the variance of the term and used to compute the <em>F</em> statistic. The SS is used to compute the MSE. Since these columns are used for computation but not reporting, <a href="#tbl-twoway-anova-explainer" class="quarto-xref">Table&nbsp;<span>13.10</span></a> excludes these.</li>
<li><strong>df</strong> (Degree of freedom) – If the term is a factor, the df will equal the number of levels (<span class="math inline">\(k\)</span>) for the factor minus 1. Think of it this way: the contribution of the variance due to a factor is a function of the variability of the <span class="math inline">\(k\)</span> level means around the grand mean. How many degrees of independent variation do these level means have, given that we know the grand mean? The answer is <span class="math inline">\(k-1\)</span> – once the values of <span class="math inline">\(k-1\)</span> level means are written down, the <span class="math inline">\(k\)</span>th level mean has no freedom to vary; its value has to be <span class="math inline">\(k\bar{\bar{Y}} - \sum_i^{k-1}{Y_i}\)</span>. For an interaction term, the df is the product of the df of each of the factors in the interaction.</li>
<li><strong>F</strong> (<em>F</em>-value or <em>F</em>-ratio) – This is the test statistic. It is the ratio of the MSE for the term divided by the MSE of the residual (this is strictly true for only “Fixed effects” ANOVA, which we have here).</li>
<li><strong>p.value</strong> – the <em>p</em>-value for the test statistic. <em>F</em> is compared to an <em>F</em>-distribution, which is a distribution of <em>F</em>-values under the null.</li>
</ol>
</section>
<section id="what-do-the-main-effects-in-an-anova-table-mean" class="level3" data-number="13.9.2">
<h3 data-number="13.9.2" class="anchored" data-anchor-id="what-do-the-main-effects-in-an-anova-table-mean"><span class="header-section-number">13.9.2</span> What do the main effects in an ANOVA table mean?</h3>
<p>It is very common in the literature to see researchers report the rows of an ANOVA table by stating something like “We found an effect of stimulation on glucose uptake (<span class="math inline">\(F_{1,25} = 26.9\)</span>, <span class="math inline">\(p &lt; 0.0001\)</span>)”. Thinking of a main effect term in an ANOVA table as “an effect” can be misleading. What does “an effect” mean? Afterall, there are <em>two</em> effects of <code>stimulation</code> in this experiment, one in the wildtype mice and one in the TLR9-/- mice.</p>
<p>Main effects in ANOVA tables are about average effects. A main effect in a two-way ANOVA table is an “overall” marginal effect. Recall that a marginal effect of the level of Factor A is the average of the conditional effects at each level of B (<a href="#sec-twoway-marginal-effects" class="quarto-xref"><span>Section 13.5.3</span></a>). For a <span class="math inline">\(2 \times 2\)</span> table, there is only one marginal effect for each factor and, as a consquence, the <em>p</em> value for the main effect term of <code>stimulation</code> in the ANOVA table (<a href="#tbl-twoway-anova-table" class="quarto-xref">Table&nbsp;<span>13.11</span></a>) is equal to the <em>p</em>-value of the marginal effect of <code>stimulation</code> in the contrast table (<a href="#tbl-twoway-marginal-table" class="quarto-xref">Table&nbsp;<span>13.12</span></a>). The “main term” effect of stimulation is illustrated in <a href="#fig-twoway-anova-explainer-plot" class="quarto-xref">Figure&nbsp;<span>13.7</span></a>.</p>
<div class="cell">
<div id="tbl-twoway-anova-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twoway-anova-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.11: Reprinting the ANOVA table of the glucose uptake experiment (Example 1) to show more decimal places of the p-value.
</figcaption>
<div aria-describedby="tbl-twoway-anova-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">num Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">den Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">stimulation</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">26.86</td>
<td style="text-align: right;">0.0000232</td>
</tr>
<tr class="even">
<td style="text-align: left;">genotype</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.4068630</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stimulation:genotype</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">6.79</td>
<td style="text-align: right;">0.0152305</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div id="tbl-twoway-marginal-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twoway-marginal-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.12: Marginal effect of stimulation on glucose uptake.
</figcaption>
<div aria-describedby="tbl-twoway-marginal-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Active - Rest</td>
<td style="text-align: right;">2.29</td>
<td style="text-align: right;">0.443</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">5.183</td>
<td style="text-align: right;">0.0000232</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p>Again, main effects in ANOVA tables are about average effects. Is the average effect what we want to report? The answer is, it depends. It does <em>not</em> depend on the <em>p</em>-value of the interaction (the answer in many textbooks and websites) although the <em>p</em>-value is, perhaps, not irrelevant. Rather, it depends on the research question motivating the experiment. The research question in Experiment 2j specifically predicted a different treatment (KO Active - KO Rest) and control effect (WT Active - WT Rest). The average of these two effects isn’t of interest. Any inference about the average effect of stimulation (the <em>p</em>-value from the ANOVA table or the marginal effect size or CIs) doesn’t answer any question motivating the experiment. A more general discussion of when we might be interested in the main effect term of an ANOVA table (or better, marginal effects) was in section xxx and below in section xxx.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-twoway-anova-explainer-plot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-twoway-anova-explainer-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="two-factors_files/figure-html/fig-twoway-anova-explainer-plot-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twoway-anova-explainer-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.7: The main effect of stimulation in the ANOVA table tests the average of the conditional effects of stimulation. The average of the conditional effects is the difference between the marginal means of Active and of Rest.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="more-issues-in-inference" class="level2" data-number="13.10">
<h2 data-number="13.10" class="anchored" data-anchor-id="more-issues-in-inference"><span class="header-section-number">13.10</span> More issues in inference</h2>
<section id="longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova" class="level3" data-number="13.10.1">
<h3 data-number="13.10.1" class="anchored" data-anchor-id="longitudinal-experiments-include-time-as-a-random-factor-better-than-repeated-measures-anova"><span class="header-section-number">13.10.1</span> Longitudinal experiments – include Time as a random factor (better than repeated measures ANOVA)</h3>
</section>
</section>
<section id="working-in-r" class="level2" data-number="13.11">
<h2 data-number="13.11" class="anchored" data-anchor-id="working-in-r"><span class="header-section-number">13.11</span> Working in R</h2>
<section id="model-formula" class="level3" data-number="13.11.1">
<h3 data-number="13.11.1" class="anchored" data-anchor-id="model-formula"><span class="header-section-number">13.11.1</span> Model formula</h3>
<p>A linear model with two crossed factors is specified in the model formula as <code>y ~ A*B</code> where <code>A</code> is the first factor, and <code>B</code> is the second factor. R expands this formula to <code>y ~ 1 + A + B + A:B</code> where the colon indicates an interaction (multiplicative) effect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose_uptake <span class="sc">~</span> stimulation <span class="sc">*</span> genotype, <span class="at">data =</span> exp2j)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">6.75</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">16.13</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">5.89</td>
<td style="text-align: right;">7.61</td>
</tr>
<tr class="even">
<td style="text-align: left;">stimulationActive</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">5.83</td>
<td style="text-align: right;">0.0000045</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">4.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">genotypeKO</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">0.2337850</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">2.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">stimulationActive:genotypeKO</td>
<td style="text-align: right;">-2.31</td>
<td style="text-align: right;">0.885</td>
<td style="text-align: right;">-2.61</td>
<td style="text-align: right;">0.0152305</td>
<td style="text-align: right;">-4.13</td>
<td style="text-align: right;">-0.48</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The order of the factors in the model formula doesn’t matter for the values of the coefficients, the estimated marginal means, or the contrasts. It can matter for ANOVA (more on this below) but not “tests after ANOVA”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>m1_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose_uptake <span class="sc">~</span> genotype <span class="sc">*</span> stimulation, <span class="at">data =</span> exp2j)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">6.75</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">16.13</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">5.89</td>
<td style="text-align: right;">7.61</td>
</tr>
<tr class="even">
<td style="text-align: left;">genotypeKO</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">0.2337850</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">2.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stimulationActive</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">5.83</td>
<td style="text-align: right;">0.0000045</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">4.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">genotypeKO:stimulationActive</td>
<td style="text-align: right;">-2.31</td>
<td style="text-align: right;">0.885</td>
<td style="text-align: right;">-2.61</td>
<td style="text-align: right;">0.0152305</td>
<td style="text-align: right;">-4.13</td>
<td style="text-align: right;">-0.48</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The additive model is specified by the formula <code>y ~ A + B</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose_uptake <span class="sc">~</span> stimulation <span class="sc">+</span> genotype, <span class="at">data =</span> exp2j)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">7.27</td>
<td style="text-align: right;">0.408</td>
<td style="text-align: right;">17.82</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">6.43</td>
<td style="text-align: right;">8.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">stimulationActive</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">0.487</td>
<td style="text-align: right;">4.97</td>
<td style="text-align: right;">0.0000368</td>
<td style="text-align: right;">1.42</td>
<td style="text-align: right;">3.42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">genotypeKO</td>
<td style="text-align: right;">-0.42</td>
<td style="text-align: right;">0.489</td>
<td style="text-align: right;">-0.86</td>
<td style="text-align: right;">0.3954703</td>
<td style="text-align: right;">-1.43</td>
<td style="text-align: right;">0.58</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="using-the-emmeans-function" class="level3" data-number="13.11.2">
<h3 data-number="13.11.2" class="anchored" data-anchor-id="using-the-emmeans-function"><span class="header-section-number">13.11.2</span> Using the emmeans function</h3>
<section id="conditional-means-table" class="level4" data-number="13.11.2.1">
<h4 data-number="13.11.2.1" class="anchored" data-anchor-id="conditional-means-table"><span class="header-section-number">13.11.2.1</span> Conditional means table</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model m1 fit above</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># m1 &lt;- lm(glucose_uptake ~ stimulation * genotype, data = exp2j)</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">"stimulation"</span>, <span class="st">"genotype"</span>))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>m1_emm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> stimulation genotype emmean    SE df lower.CL upper.CL
 Rest        WT         6.75 0.419 25     5.89     7.61
 Active      WT        10.20 0.419 25     9.34    11.06
 Rest        KO         7.53 0.483 25     6.53     8.53
 Active      KO         8.67 0.447 25     7.75     9.59

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Notes</p>
<ol type="1">
<li>Printing the <code>emmeans</code> object displays useful information. Here, this information includes the confidence level used. If the object is printed using <code>kable() |&gt; kable_styling()</code> (as in the “Inference” and “Understanding” sections above), only the table is printed and the additional information is lost.</li>
<li><code>emmeans</code> computes the modeled means of all combinations of the levels of the factor variables specified in <code>specs</code>.</li>
<li>If there are two factor variables in the model, and both are passed to <code>specs</code>, then the modeled means of all combinations of the levels of the two variables are computed. If only one factor variable is passed, then the marginal means (averaged over all levels of the missing factor) are computed (see below).</li>
</ol>
</section>
<section id="marginal-means" class="level4" data-number="13.11.2.2">
<h4 data-number="13.11.2.2" class="anchored" data-anchor-id="marginal-means"><span class="header-section-number">13.11.2.2</span> Marginal means</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>m1_emm_stimulation <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">"stimulation"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>m1_emm_stimulation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> stimulation emmean    SE df lower.CL upper.CL
 Rest          7.14 0.320 25     6.48      7.8
 Active        9.43 0.306 25     8.80     10.1

Results are averaged over the levels of: genotype 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Notes</p>
<ol type="1">
<li>In a model with two crossed factors, <code>y ~ A * B</code>, the marginal means of the levels of <code>A</code>, averaged over all levels of <code>B</code> are computed by setting <code>specs =</code> to <code>A</code> only.</li>
<li>Remember that the <code>specs</code> argument sets the values of the predictors for which we want a mean. By excluding <code>B</code>, we don’t get the means of the levels of <code>A</code> at each level of <code>B</code> but averaged across the levels of <code>B</code>.<code>emmeans</code> “knows” to average across the levels of <code>B</code> because <code>B</code> is in the model.</li>
</ol>
</section>
</section>
<section id="contrasts" class="level3" data-number="13.11.3">
<h3 data-number="13.11.3" class="anchored" data-anchor-id="contrasts"><span class="header-section-number">13.11.3</span> Contrasts</h3>
<section id="twoway-working-planned" class="level4" data-number="13.11.3.1">
<h4 data-number="13.11.3.1" class="anchored" data-anchor-id="twoway-working-planned"><span class="header-section-number">13.11.3.1</span> Planned contrasts</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>wt_rest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>wt_active <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>ko_rest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>ko_active <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>m1_planned <span class="ot">&lt;-</span> <span class="fu">contrast</span>(</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  m1_emm,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">list</span>(</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"(WT Active - WT Rest)"</span> <span class="ot">=</span> <span class="fu">c</span>(wt_active <span class="sc">-</span> wt_rest),</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"(KO Rest - WT Rest)"</span> <span class="ot">=</span> <span class="fu">c</span>(ko_rest <span class="sc">-</span> wt_rest),</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"(KO Active - WT Active)"</span> <span class="ot">=</span> <span class="fu">c</span>(ko_active <span class="sc">-</span> wt_active),</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"KO:Active Ixn"</span> <span class="ot">=</span> <span class="fu">c</span>(ko_active <span class="sc">-</span> wt_active) <span class="sc">-</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>      (ko_rest <span class="sc">-</span> wt_rest)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">adjust =</span> <span class="st">"none"</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(WT Active - WT Rest)</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">4.67</td>
<td style="text-align: right;">5.83</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">(KO Rest - WT Rest)</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">2.10</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">0.2338</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(KO Active - WT Active)</td>
<td style="text-align: right;">-1.53</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-2.79</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-2.49</td>
<td style="text-align: right;">0.0197</td>
</tr>
<tr class="even">
<td style="text-align: left;">KO:Active Ixn</td>
<td style="text-align: right;">-2.31</td>
<td style="text-align: right;">0.885</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-4.13</td>
<td style="text-align: right;">-0.48</td>
<td style="text-align: right;">-2.61</td>
<td style="text-align: right;">0.0152</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="all-pairwise-effects" class="level4" data-number="13.11.3.2">
<h4 data-number="13.11.3.2" class="anchored" data-anchor-id="all-pairwise-effects"><span class="header-section-number">13.11.3.2</span> All pairwise effects</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"revpairwise"</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">"tukey"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">level =</span> <span class="fl">0.95</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>) <span class="co"># add the 95% CIs</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>m1_pairs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast              estimate    SE df lower.CL upper.CL t.ratio p.value
 Active WT - Rest WT       3.45 0.592 25    1.820    5.076   5.826  &lt;.0001
 Rest KO - Rest WT         0.78 0.639 25   -0.978    2.539   1.220  0.6202
 Rest KO - Active WT      -2.67 0.639 25   -4.427   -0.910  -4.173  0.0017
 Active KO - Rest WT       1.92 0.613 25    0.236    3.606   3.136  0.0212
 Active KO - Active WT    -1.53 0.613 25   -3.212    0.158  -2.493  0.0857
 Active KO - Rest KO       1.14 0.659 25   -0.671    2.953   1.733  0.3287

Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 4 estimates 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
</div>
<p>Notes</p>
<ol type="1">
<li>Note that printing the <code>contrast</code> object displays useful information, including the method of adjustment for multiple tests. If the object is printed using <code>kable() |&gt; kable_styling()</code> (as in the “Inference” and “Understanding” sections above), only the table is printed and the additional information is lost.</li>
<li>The <code>method</code> argument is used to control the set of contrasts that are computed. See below.</li>
<li>The <code>adjust</code> argument controls if and how to adjust for multiple tests. Each <code>method</code> has a default adjustment method. See below.</li>
<li>The <code>level</code> argument controls the percentile boundaries of the confidence interval. The default is 0.95. Including this argument with this value makes this level transparent.</li>
</ol>
</section>
<section id="simple-effects" class="level4" data-number="13.11.3.3">
<h4 data-number="13.11.3.3" class="anchored" data-anchor-id="simple-effects"><span class="header-section-number">13.11.3.3</span> Simple effects</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>m1_simple <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"revpairwise"</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">simple =</span> <span class="st">"each"</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">combine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">"fdr"</span>) <span class="sc">|&gt;</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>) <span class="co"># add the 95% CIs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">genotype</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">stimulation</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">WT</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">Active - Rest</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">5.04</td>
<td style="text-align: right;">5.83</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">KO</td>
<td style="text-align: left;">.</td>
<td style="text-align: left;">Active - Rest</td>
<td style="text-align: right;">1.14</td>
<td style="text-align: right;">0.659</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-0.63</td>
<td style="text-align: right;">2.91</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">0.1273</td>
</tr>
<tr class="odd">
<td style="text-align: left;">.</td>
<td style="text-align: left;">Rest</td>
<td style="text-align: left;">KO - WT</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-0.94</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">0.2338</td>
</tr>
<tr class="even">
<td style="text-align: left;">.</td>
<td style="text-align: left;">Active</td>
<td style="text-align: left;">KO - WT</td>
<td style="text-align: right;">-1.53</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-3.18</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-2.49</td>
<td style="text-align: right;">0.0393</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="twoway-working-ixn" class="level4" data-number="13.11.3.4">
<h4 data-number="13.11.3.4" class="anchored" data-anchor-id="twoway-working-ixn"><span class="header-section-number">13.11.3.4</span> Interaction contrasts</h4>
<p>The interaction contrasts can be computed as in <a href="#twoway-working-planned">Planned contrasts</a> above or using the argument “interaction =”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>m1_ixn <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">interaction =</span> <span class="st">"revpairwise"</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>) <span class="co"># add the 95% CIs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">stimulation_revpairwise</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">genotype_revpairwise</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Active - Rest</td>
<td style="text-align: left;">KO - WT</td>
<td style="text-align: right;">-2.31</td>
<td style="text-align: right;">0.885</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-4.13</td>
<td style="text-align: right;">-0.48</td>
<td style="text-align: right;">-2.61</td>
<td style="text-align: right;">0.0152</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="method-argument" class="level4" data-number="13.11.3.5">
<h4 data-number="13.11.3.5" class="anchored" data-anchor-id="method-argument"><span class="header-section-number">13.11.3.5</span> Method argument</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"pairwise"</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">"fdr"</span>) <span class="sc">|&gt;</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>) <span class="co"># add the 95% CIs</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>m1_pairs <span class="sc">|&gt;</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rest WT - Active WT</td>
<td style="text-align: right;">-3.4482471</td>
<td style="text-align: right;">0.5918936</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-5.1439551</td>
<td style="text-align: right;">-1.7525392</td>
<td style="text-align: right;">-5.825789</td>
<td style="text-align: right;">0.0000269</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rest WT - Rest KO</td>
<td style="text-align: right;">-0.7800781</td>
<td style="text-align: right;">0.6393182</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-2.6116520</td>
<td style="text-align: right;">1.0514958</td>
<td style="text-align: right;">-1.220172</td>
<td style="text-align: right;">0.2337850</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rest WT - Active KO</td>
<td style="text-align: right;">-1.9211230</td>
<td style="text-align: right;">0.6126681</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-3.6763474</td>
<td style="text-align: right;">-0.1658985</td>
<td style="text-align: right;">-3.135667</td>
<td style="text-align: right;">0.0086970</td>
</tr>
<tr class="even">
<td style="text-align: left;">Active WT - Rest KO</td>
<td style="text-align: right;">2.6681690</td>
<td style="text-align: right;">0.6393182</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">0.8365951</td>
<td style="text-align: right;">4.4997430</td>
<td style="text-align: right;">4.173460</td>
<td style="text-align: right;">0.0009510</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Active WT - Active KO</td>
<td style="text-align: right;">1.5271242</td>
<td style="text-align: right;">0.6126681</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-0.2281003</td>
<td style="text-align: right;">3.2823486</td>
<td style="text-align: right;">2.492580</td>
<td style="text-align: right;">0.0295018</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rest KO - Active KO</td>
<td style="text-align: right;">-1.1410449</td>
<td style="text-align: right;">0.6585984</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-3.0278545</td>
<td style="text-align: right;">0.7457647</td>
<td style="text-align: right;">-1.732535</td>
<td style="text-align: right;">0.1145997</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"trt.vs.ctrl"</span>,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>) <span class="co"># add the 95% CIs</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>m1_pairs <span class="sc">|&gt;</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Active WT - Rest WT</td>
<td style="text-align: right;">3.4482471</td>
<td style="text-align: right;">0.5918936</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">2.2292194</td>
<td style="text-align: right;">4.667275</td>
<td style="text-align: right;">5.825789</td>
<td style="text-align: right;">0.0000045</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rest KO - Rest WT</td>
<td style="text-align: right;">0.7800781</td>
<td style="text-align: right;">0.6393182</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-0.5366223</td>
<td style="text-align: right;">2.096779</td>
<td style="text-align: right;">1.220172</td>
<td style="text-align: right;">0.2337850</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Active KO - Rest WT</td>
<td style="text-align: right;">1.9211230</td>
<td style="text-align: right;">0.6126681</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">0.6593094</td>
<td style="text-align: right;">3.182936</td>
<td style="text-align: right;">3.135667</td>
<td style="text-align: right;">0.0043485</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Notes</p>
<ol type="1">
<li><code>method = "pairwise"</code> and <code>method = "revpairwise"</code> compute all pairwise comparisons. I prefer “revpairwise” because the contrasts that include the reference are in the direction non-reference minus reference.</li>
<li><code>method = "trt.vs.ctrl"</code> gives a very flattened picture of the model results and constrains what we can infer from the results.</li>
</ol>
</section>
<section id="adjustment-for-multiple-tests" class="level4" data-number="13.11.3.6">
<h4 data-number="13.11.3.6" class="anchored" data-anchor-id="adjustment-for-multiple-tests"><span class="header-section-number">13.11.3.6</span> Adjustment for multiple tests</h4>
<div class="callout callout-style-default callout-warning callout-titled" title="NHST Blues">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
NHST Blues
</div>
</div>
<div class="callout-body-container callout-body">
<p>See <a href="multiple-testing.html#sec-mult-tests-tukey" class="quarto-xref"><span>Section 12.3</span></a> for why Tukey (or any) <em>p</em>-value adjustment for multiple tests <strong>is unjustified</strong> in many bench biology experiments, even though adjustment is the norm</p>
<p>See <a href="multiple-testing.html#sec-mult-tests-eg3-fdr" class="quarto-xref"><span>Section 12.4</span></a> for why we often want to use a FDR method to adjust <em>p</em>-values in many bench biology experiments, even though not adjusting is the norm.</p>
<p>Seriously, you’d be better off ignoring what’s below and clicking these links or just reading all of <a href="multiple-testing.html" class="quarto-xref"><span>Chapter 12</span></a></p>
</div>
</div>
<p>set the <code>adjust =</code> argument to</p>
<ol type="1">
<li>“none” – no adjustment.</li>
<li>“BH” or “fdr” – controls the <a href="https://en.wikipedia.org/wiki/False_discovery_rate" target="_blank">false discovery rate</a> using the logic of Benjamini &amp; Hochberg. The BH method assumes independent tests. This or BY should be used for most uses of <em>p</em>-value adjustment in experimental bench biology.</li>
<li>“BY” – is a modification of BH using the logic of Benjamini &amp; Yekutieli. The BY method relaxes the independent test assumption and consequently is more consertive than BH. This or BY should be used for most uses of <em>p</em>-value adjustment in experimental bench biology.</li>
<li>“holm” – <a href="https://en.wikipedia.org/wiki/Holm–Bonferroni_method" target="_blank">Holm-Bonferroni</a> is the Holm modification of Bonferroni and is used to control the FWER. It is more powerful than Bonferroni while still holding FWER at or below alpha. For most uses of <em>p</em>-value adjustment in experimental bench biology, we are less interested in controling the FWER than the FDR.</li>
<li>“bonferroni” – <a href="https://en.wikipedia.org/wiki/Bonferroni_correction" target="_blank">Bonferroni</a> is the original, general-purpose adjustment for a set of <em>p</em>-values to control the FWER. It has less power than the Holm modification, so it’s use should be historic only.</li>
<li>“mvt” – based on the multivariate <em>t</em> distribution and using covariance structure of the variables.</li>
<li>“dunnettx” – <a href="https://en.wikipedia.org/wiki/Dunnett%27s_test" target="_blank">Dunnett’s test</a> is a method used when comparing all treatments to a single control.</li>
<li>“tukey” – <a href="https://en.wikipedia.org/wiki/Tukey%27s_range_test" target="_blank">Tukey’s HSD method</a> is the most common method used to compare all pairwise comparisons.</li>
</ol>
</section>
</section>
<section id="practice-safe-anova" class="level3" data-number="13.11.4">
<h3 data-number="13.11.4" class="anchored" data-anchor-id="practice-safe-anova"><span class="header-section-number">13.11.4</span> Practice safe ANOVA</h3>
<p>Many researchers are unaware of the different ways of computing the sum of squares in an ANOVA table. The <em>F</em>-value and <em>p</em>-value are both functions of the sum of squares. When the cells of a two-way ANOVA are not balanced (different sample sizes among the cells), the different ways of computing the sum of squares can matter. There is a great deal of sound and fury about which methods should be used and which avoided. For many research questions and the experiments used to address these, these arguments are moot because the ANOVA table is simply unnecessary for inference. Instead, fit the linear model and compute the contrasts of interest.</p>
<p>If your reviewer/advisor/boss wants an ANOVA table and wants this table to match that in Graphpad Prism or JMP, then you need a table computed from Type III sum of squares. If using a linear model to compute the ANOVA (remember that ANOVA was developed without fitting linear models), then the linear model needs to be fit using a model matrix constructed with indicator variables using effects coding. There are two safe ways to do this in R.</p>
<section id="the-afex-aov_4-function" class="level4" data-number="13.11.4.1">
<h4 data-number="13.11.4.1" class="anchored" data-anchor-id="the-afex-aov_4-function"><span class="header-section-number">13.11.4.1</span> The afex aov_4 function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .I is a data.table function that returns the row number</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>exp2j[, fake_id <span class="sc">:</span><span class="er">=</span> <span class="fu">paste</span>(<span class="st">"mouse"</span>, .I)]</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>m1_aov4 <span class="ot">&lt;-</span> <span class="fu">aov_4</span>(glucose_uptake <span class="sc">~</span> stimulation <span class="sc">*</span> genotype <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span><span class="sc">|</span>fake_id),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> exp2j)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">nice</span>(m1_aov4, <span class="at">MSE =</span> <span class="cn">FALSE</span>)[,<span class="sc">-</span><span class="dv">4</span>] <span class="sc">|&gt;</span> <span class="co"># delete ges column</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Effect</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">F</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">stimulation</td>
<td style="text-align: left;">1, 25</td>
<td style="text-align: left;">26.86 ***</td>
<td style="text-align: left;">&lt;.0001</td>
</tr>
<tr class="even">
<td style="text-align: left;">genotype</td>
<td style="text-align: left;">1, 25</td>
<td style="text-align: left;">0.71</td>
<td style="text-align: left;">.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stimulation:genotype</td>
<td style="text-align: left;">1, 25</td>
<td style="text-align: left;">6.79 *</td>
<td style="text-align: left;">.02</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Notes</p>
<ol type="1">
<li>The afex package has three function names for generating the same ANOVA table and statistics – here I’m using <code>aov_4</code> because this functions uses a linear model formula argument (specifically, that used in the lme4 package), which is consistent with the rest of this text.</li>
<li>The formula includes the addition of a random factor (<code>(1|id)</code>) even though there really is no random factor in this model. See <a href="#lmm">Models with random factors – Blocking and pseudoreplication</a> for more information on random factors. The random factor (the factor variable “id” created in the line before the fit model line) identifies the individual mouse from which the response variable was measured. Because the response was only measured once on each individual mouse, “id” is not really a random factor but the addition of this in the model formula is necessary for the <code>aov_4</code> function to work.</li>
</ol>
</section>
<section id="twoway-car-anova" class="level4" data-number="13.11.4.2">
<h4 data-number="13.11.4.2" class="anchored" data-anchor-id="twoway-car-anova"><span class="header-section-number">13.11.4.2</span> The car Anova function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>type3 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">stimulation =</span> contr.sum,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">genotype =</span> contr.sum)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>m1_type3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose_uptake <span class="sc">~</span> stimulation <span class="sc">*</span> genotype,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> exp2j,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">contrasts =</span> type3)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m1_type3, <span class="at">type=</span><span class="st">"3"</span>)[<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">|&gt;</span> <span class="co"># delete row 1 and col 1</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>)) <span class="sc">|&gt;</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">stimulation</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">26.86</td>
<td style="text-align: right;">0.00002</td>
</tr>
<tr class="even">
<td style="text-align: left;">genotype</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.40686</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stimulation:genotype</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.79</td>
<td style="text-align: right;">0.01523</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Notes</p>
<ol type="1">
<li><code>car::Anova</code> has arguments for reporting the Type II and Type III sum of squares.</li>
<li>Background: The default model matrix in the <code>lm</code> function uses dummy (or treatment) coding. For a Type 3 SS ANOVA (the kind that matches that in Graphpad Prism or JMP), we need to tell <code>lm</code> to use sum (or deviation) coding.</li>
<li>The best practice method for changing the contrasts in the model matrix is using the <code>contrasts</code> argument within the <code>lm</code> function, as in the code above to fit <code>m1_type3</code>. This is the safest practice because this sets the contrasts only for this specific fit.</li>
<li>The coefficients of <code>m1_type3</code> will be different from those using the default contrasts. Except when computing a Type III ANOVA, this text uses the default contrasts throughout because the coefficients make sense for the kinds of experiments in experimental biology. If using sum (“type III”) coding, the intercept will be the grand mean and the coefficients of the non-reference levels (the effects) will be their deviations from the grand mean. I don’t find this definition of “effects” very useful for most experiments in biology (but “useful” is largely a function of “used to”).</li>
<li>The contrasts (differences in the means among pairs of groups) in the contrast table will be the same, regardless of the contrast coding.</li>
</ol>
<div style="background-color:#cccccc; text-align:left; vertical-align: middle; padding:20px 47px;">
<p>Danger!. Many online sites suggest this bit of code before a Type III ANOVA using car::Anova:</p>
<p><code>options(contrasts = c("contr.sum", "contr.poly")</code></p>
<p>If you’re reading this book, you almost certainly don’t want to do this because this code resets how R computes coefficients of linear models and SS of ANOVA tables. This will effect all future analysis until the contrasts are set to something else or a new R session is started.</p>
</div>
</section>
</section>
<section id="better-to-avoid-these" class="level3" data-number="13.11.5">
<h3 data-number="13.11.5" class="anchored" data-anchor-id="better-to-avoid-these"><span class="header-section-number">13.11.5</span> Better to avoid these</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>m1_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(glucose_uptake <span class="sc">~</span> stimulation <span class="sc">*</span> genotype,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> exp2j)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Df Sum Sq Mean Sq F value   Pr(&gt;F)    
stimulation           1  41.75   41.75  29.796 1.14e-05 ***
genotype              1   1.28    1.28   0.913   0.3485    
stimulation:genotype  1   9.51    9.51   6.789   0.0152 *  
Residuals            25  35.03    1.40                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same as exp2j_m1 in the Example 1 section</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose_uptake <span class="sc">~</span> stimulation <span class="sc">*</span> genotype,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> exp2j)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: glucose_uptake
                     Df Sum Sq Mean Sq F value    Pr(&gt;F)    
stimulation           1 41.755  41.755 29.7959 1.143e-05 ***
genotype              1  1.279   1.279  0.9128   0.34853    
stimulation:genotype  1  9.514   9.514  6.7890   0.01523 *  
Residuals            25 35.034   1.401                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Notes</p>
<ol type="1">
<li>Note the differences from the the afex table and the car Anova table. The <em>p</em>-values for the interaction term is the same – this will always be the case for the highest order interaction term in the model. The <em>p</em>-values for <code>stimulation</code> and <code>genotype</code> terms are different. The difference will be a function of the degree of imbalance. Here, this difference doesn’t make a difference for inference. In some data sets, the difference is catastrophic.</li>
<li>Many introduction to statistics textbooks and websites teach the base R <code>aov</code> function. This function is only useful if 1) the data are balanced and 2) we care about ANOVA. Don’t use this. If you need the ANOVA table use either afex or car Anova.</li>
<li>The base R <code>anova</code> is useful if you know what you are doing with it. Otherwise, use either afex or car Anova.</li>
</ol>
</section>
</section>
<section id="hidden-code" class="level2" data-number="13.12">
<h2 data-number="13.12" class="anchored" data-anchor-id="hidden-code"><span class="header-section-number">13.12</span> Hidden Code</h2>
<section id="import-exp2j-example-1" class="level3" data-number="13.12.1">
<h3 data-number="13.12.1" class="anchored" data-anchor-id="import-exp2j-example-1"><span class="header-section-number">13.12.1</span> Import exp2j (Example 1)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">"TLR9 and beclin 1 crosstalk regulates muscle AMPK activation in exercise"</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">"41586_2020_1992_MOESM4_ESM.xlsx"</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>treatment_levels  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"WT Rest"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"WT Active"</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"KO Rest"</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"KO Active"</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>exp2j_wide <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sheet =</span> <span class="st">"2j"</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">range =</span> <span class="st">"A5:D13"</span>,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>()</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(exp2j_wide) <span class="ot">&lt;-</span> treatment_levels</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>exp2j <span class="ot">&lt;-</span> <span class="fu">melt</span>(exp2j_wide,</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure.vars =</span> treatment_levels,</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">variable.name =</span> <span class="st">"treatment"</span>,</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">value.name =</span> <span class="st">"glucose_uptake"</span>) <span class="sc">|&gt;</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="co"># danger!</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>exp2j[, <span class="fu">c</span>(<span class="st">"genotype"</span>, <span class="st">"stimulation"</span>) <span class="sc">:</span><span class="er">=</span> <span class="fu">tstrsplit</span>(treatment,</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">" "</span>,</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">fixed =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>genotype_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"KO"</span>)</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>stimulation_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Rest"</span>, <span class="st">"Active"</span>)</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>exp2j[, genotype <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(genotype,</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> genotype_levels)]</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>exp2j[, stimulation <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(stimulation,</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> stimulation_levels)]</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a><span class="co"># View(exp2j)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-exp3e-lesian-area-data-example-2" class="level3" data-number="13.12.2">
<h3 data-number="13.12.2" class="anchored" data-anchor-id="import-exp3e-lesian-area-data-example-2"><span class="header-section-number">13.12.2</span> Import exp3e lesian area data (Example 2)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">"XX sex chromosome complement promotes atherosclerosis in mice"</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">"41467_2019_10462_MOESM6_ESM.xlsx"</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fig 3e</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>exp3e_wide <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sheet =</span> <span class="st">"Figure 3E"</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">range =</span> <span class="st">"A3:K4"</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transpose</span>(<span class="at">make.names =</span> <span class="dv">1</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>sex_levels <span class="ot">&lt;-</span> <span class="fu">colnames</span>(exp3e_wide)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>exp3e <span class="ot">&lt;-</span> <span class="fu">melt</span>(exp3e_wide,</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure.vars =</span> sex_levels,</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">variable.name =</span> <span class="st">"sex"</span>,</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">value.name =</span> <span class="st">"lesian_area"</span>)</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="co"># convert lesian_area to mm^2 from µm^2</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>exp3e[, lesian_area <span class="sc">:</span><span class="er">=</span> lesian_area<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>]</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="co"># convert sex variable to factor</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>exp3e[, sex <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(sex,</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> sex_levels)]</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="co"># create chromosome column and convert to factor</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>chromosome_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"XX"</span>, <span class="st">"XY"</span>)</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>exp3e[, chromosome <span class="sc">:</span><span class="er">=</span> <span class="fu">rep</span>(<span class="fu">rep</span>(chromosome_levels, <span class="at">each =</span> <span class="dv">5</span>), <span class="dv">2</span>)]</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>exp3e[, chromosome <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(chromosome,</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> chromosome_levels)]</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a><span class="co"># researchers treatment levels</span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>exp3e[, treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"FXX"</span>, <span class="st">"FXY"</span>, <span class="st">"MXX"</span>, <span class="st">"MXY"</span>), <span class="at">each =</span> <span class="dv">5</span>)]</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a><span class="co"># two rows with missing response so delte these rows as there is </span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a><span class="co"># no useful information in them</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>exp3e <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(exp3e) <span class="co"># be careful with a global na.omit</span></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a><span class="co"># View(exp3e) # highlight and run to see data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-exp1c-ja-data-example-3" class="level3" data-number="13.12.3">
<h3 data-number="13.12.3" class="anchored" data-anchor-id="import-exp1c-ja-data-example-3"><span class="header-section-number">13.12.3</span> Import Exp1c JA data (Example 3)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">"Integration of two herbivore-induced plant volatiles results in synergistic effects on plant defense and resistance"</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">"Data for Dryad.xlsx"</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>exp1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sheet =</span> <span class="st">"Fig. 1"</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">range =</span> <span class="st">"A3:K23"</span>, <span class="co"># 1 blank column</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(exp1, <span class="at">old =</span> <span class="st">"treat"</span>, <span class="at">new =</span> <span class="st">"treatment"</span>)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>exp1[treatment <span class="sc">==</span> <span class="st">"Control"</span>, <span class="fu">c</span>(<span class="st">"hac"</span>, <span class="st">"indole"</span>) <span class="sc">:</span><span class="er">=</span> <span class="fu">list</span>(<span class="st">"HAC-"</span>, <span class="st">"Indole-"</span>)]</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>exp1[treatment <span class="sc">==</span> <span class="st">"HAC"</span>, <span class="fu">c</span>(<span class="st">"hac"</span>, <span class="st">"indole"</span>) <span class="sc">:</span><span class="er">=</span> <span class="fu">list</span>(<span class="st">"HAC+"</span>, <span class="st">"Indole-"</span>)]</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>exp1[treatment <span class="sc">==</span> <span class="st">"Indole"</span>, <span class="fu">c</span>(<span class="st">"hac"</span>, <span class="st">"indole"</span>) <span class="sc">:</span><span class="er">=</span> <span class="fu">list</span>(<span class="st">"HAC-"</span>, <span class="st">"Indole+"</span>)]</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>exp1[treatment <span class="sc">==</span> <span class="st">"HAC+Indole"</span>, <span class="fu">c</span>(<span class="st">"hac"</span>, <span class="st">"indole"</span>) <span class="sc">:</span><span class="er">=</span> <span class="fu">list</span>(<span class="st">"HAC+"</span>, <span class="st">"Indole+"</span>)]</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"HAC"</span>, <span class="st">"Indole"</span>, <span class="st">"HAC+Indole"</span>)</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>exp1[, treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(treatment,</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> treatment_levels)]</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>exp1[, hac <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(hac)] <span class="co"># levels in correct order</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>exp1[, indole <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(indole)] <span class="co"># levels in correct order</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="co"># View(exp1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/multiple-testing.html" class="pagination-link" aria-label="Multiple tests -- why and when to adjust *p*-values">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Multiple tests – why and when to adjust <em>p</em>-values</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/lmm.html" class="pagination-link" aria-label="Models for non-independence -- linear mixed models">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Models for non-independence – linear mixed models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>