<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Linear models with a single, categorical X (“t-tests” and “ANOVA”) – Statistics for the Experimental Bench Biologist</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/model-checking.html" rel="next">
<link href="../chapters/continuous_x.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/one-factor.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Statistics for the Experimental Bench Biologist</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Front Matter</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Analyzing experimental data with a linear model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started – R Projects and R Markdown</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/reading-writing-wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data – Reading, Wrangling, and Writing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/plotting-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Plotting Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/uncertainty-sd-and-se.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Variability and Uncertainty (Standard Deviations, Standard Errors, and Confidence Intervals)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/p-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">P-values</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/inference-errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Errors in inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/intro-stat-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">An introduction to linear models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/continuous_x.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Linear models with a single, continuous <em>X</em> (“linear regression”)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/one-factor.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/model-checking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model checking</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/multiple-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Multiple tests – why and when to adjust <em>p</em>-values</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/inference-issues.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Issues in inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/two-factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Linear models with two categorical <span class="math inline">\(X\)</span> – Factorial linear models (“two-way ANOVA”)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Linear models with added covariates (“ANCOVA”)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/lmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Models for non-independence – linear mixed models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Models for counts, binary responses, skewed responses, and proportions – Generalized Linear Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/longitudinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Linear models for longitudinal experiments</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#oneway-data" id="toc-oneway-data" class="nav-link active" data-scroll-target="#oneway-data"><span class="header-section-number">10.1</span> A linear model with a single factor (categorical <em>X</em>variable) estimates the effects of the levels of factor on the response</a>
  <ul>
  <li><a href="#oneway-example1" id="toc-oneway-example1" class="nav-link" data-scroll-target="#oneway-example1"><span class="header-section-number">10.1.1</span> Example 1 (fig3d) – two treatment levels (“groups”)</a>
  <ul class="collapse">
  <li><a href="#step-1-understand-the-experiment-design-and-the-focal-comparisons" id="toc-step-1-understand-the-experiment-design-and-the-focal-comparisons" class="nav-link" data-scroll-target="#step-1-understand-the-experiment-design-and-the-focal-comparisons"><span class="header-section-number">10.1.1.1</span> Step 1 – Understand the experiment design and the focal comparisons</a></li>
  <li><a href="#step-2-import" id="toc-step-2-import" class="nav-link" data-scroll-target="#step-2-import"><span class="header-section-number">10.1.1.2</span> Step 2 – import</a></li>
  <li><a href="#step-3-inspect-the-data" id="toc-step-3-inspect-the-data" class="nav-link" data-scroll-target="#step-3-inspect-the-data"><span class="header-section-number">10.1.1.3</span> Step 3 – inspect the data</a></li>
  <li><a href="#step-4-fit-the-model" id="toc-step-4-fit-the-model" class="nav-link" data-scroll-target="#step-4-fit-the-model"><span class="header-section-number">10.1.1.4</span> Step 4 – fit the model</a></li>
  <li><a href="#step-5-check-the-model" id="toc-step-5-check-the-model" class="nav-link" data-scroll-target="#step-5-check-the-model"><span class="header-section-number">10.1.1.5</span> Step 5 – check the model</a></li>
  <li><a href="#step-6-inference" id="toc-step-6-inference" class="nav-link" data-scroll-target="#step-6-inference"><span class="header-section-number">10.1.1.6</span> Step 6 – inference</a></li>
  <li><a href="#step-6-plot-the-model" id="toc-step-6-plot-the-model" class="nav-link" data-scroll-target="#step-6-plot-the-model"><span class="header-section-number">10.1.1.7</span> Step 6 – plot the model</a></li>
  <li><a href="#step-7-report-the-model-results" id="toc-step-7-report-the-model-results" class="nav-link" data-scroll-target="#step-7-report-the-model-results"><span class="header-section-number">10.1.1.8</span> Step 7 – report the model results</a></li>
  </ul></li>
  <li><a href="#understanding-the-analysis-with-two-treatment-levels" id="toc-understanding-the-analysis-with-two-treatment-levels" class="nav-link" data-scroll-target="#understanding-the-analysis-with-two-treatment-levels"><span class="header-section-number">10.1.2</span> Understanding the analysis with two treatment levels</a>
  <ul class="collapse">
  <li><a href="#linear-models-are-regression-models" id="toc-linear-models-are-regression-models" class="nav-link" data-scroll-target="#linear-models-are-regression-models"><span class="header-section-number">10.1.2.1</span> Linear models are regression models</a></li>
  <li><a href="#the-estimates-in-the-coefficient-table-are-estimates-of-the-parameters-of-the-linear-model-fit-to-the-data." id="toc-the-estimates-in-the-coefficient-table-are-estimates-of-the-parameters-of-the-linear-model-fit-to-the-data." class="nav-link" data-scroll-target="#the-estimates-in-the-coefficient-table-are-estimates-of-the-parameters-of-the-linear-model-fit-to-the-data."><span class="header-section-number">10.1.2.2</span> The Estimates in the coefficient table are estimates of the parameters of the linear model fit to the data.</a></li>
  <li><a href="#oneway-what-coefs-are" id="toc-oneway-what-coefs-are" class="nav-link" data-scroll-target="#oneway-what-coefs-are"><span class="header-section-number">10.1.2.3</span> The coefficients of a linear model using dummy coding have a useful interpretation</a></li>
  <li><a href="#better-know-the-coefficient-table" id="toc-better-know-the-coefficient-table" class="nav-link" data-scroll-target="#better-know-the-coefficient-table"><span class="header-section-number">10.1.2.4</span> Better know the coefficient table</a></li>
  <li><a href="#the-emmeans-table-is-a-table-of-modeled-means-and-inferential-statistics" id="toc-the-emmeans-table-is-a-table-of-modeled-means-and-inferential-statistics" class="nav-link" data-scroll-target="#the-emmeans-table-is-a-table-of-modeled-means-and-inferential-statistics"><span class="header-section-number">10.1.2.5</span> The emmeans table is a table of modeled means and inferential statistics</a></li>
  <li><a href="#estimates-of-the-effects-are-in-the-contrasts-table" id="toc-estimates-of-the-effects-are-in-the-contrasts-table" class="nav-link" data-scroll-target="#estimates-of-the-effects-are-in-the-contrasts-table"><span class="header-section-number">10.1.2.6</span> Estimates of the effects are in the contrasts table</a></li>
  <li><a href="#t-and-p-from-the-contrasts-table-when-there-are-only-two-levels-in-x-are-the-same-as-t-and-p-from-a-t-test" id="toc-t-and-p-from-the-contrasts-table-when-there-are-only-two-levels-in-x-are-the-same-as-t-and-p-from-a-t-test" class="nav-link" data-scroll-target="#t-and-p-from-the-contrasts-table-when-there-are-only-two-levels-in-x-are-the-same-as-t-and-p-from-a-t-test"><span class="header-section-number">10.1.2.7</span> <em>t</em> and <em>p</em> from the contrasts table – when there are only two levels in <span class="math inline">\(X\)</span> – are the same as <em>t</em> and <em>p</em> from a <em>t</em>-test</a></li>
  </ul></li>
  <li><a href="#oneway-example2" id="toc-oneway-example2" class="nav-link" data-scroll-target="#oneway-example2"><span class="header-section-number">10.1.3</span> Example 2 – three treatment levels (“groups”)</a>
  <ul class="collapse">
  <li><a href="#understand-the-experiment-design" id="toc-understand-the-experiment-design" class="nav-link" data-scroll-target="#understand-the-experiment-design"><span class="header-section-number">10.1.3.1</span> Understand the experiment design</a></li>
  <li><a href="#fig2a-m1" id="toc-fig2a-m1" class="nav-link" data-scroll-target="#fig2a-m1"><span class="header-section-number">10.1.3.2</span> fit the model</a></li>
  <li><a href="#check-the-model" id="toc-check-the-model" class="nav-link" data-scroll-target="#check-the-model"><span class="header-section-number">10.1.3.3</span> check the model</a></li>
  <li><a href="#inference-from-the-model" id="toc-inference-from-the-model" class="nav-link" data-scroll-target="#inference-from-the-model"><span class="header-section-number">10.1.3.4</span> Inference from the model</a></li>
  <li><a href="#plot-the-model" id="toc-plot-the-model" class="nav-link" data-scroll-target="#plot-the-model"><span class="header-section-number">10.1.3.5</span> plot the model</a></li>
  <li><a href="#report-the-model-results" id="toc-report-the-model-results" class="nav-link" data-scroll-target="#report-the-model-results"><span class="header-section-number">10.1.3.6</span> Report the model results</a></li>
  </ul></li>
  <li><a href="#understanding-the-analysis-with-three-or-more-treatment-levels" id="toc-understanding-the-analysis-with-three-or-more-treatment-levels" class="nav-link" data-scroll-target="#understanding-the-analysis-with-three-or-more-treatment-levels"><span class="header-section-number">10.1.4</span> Understanding the analysis with three (or more) treatment levels</a>
  <ul class="collapse">
  <li><a href="#better-know-the-coefficient-table-1" id="toc-better-know-the-coefficient-table-1" class="nav-link" data-scroll-target="#better-know-the-coefficient-table-1"><span class="header-section-number">10.1.4.1</span> Better know the coefficient table</a></li>
  <li><a href="#the-emmeans-table" id="toc-the-emmeans-table" class="nav-link" data-scroll-target="#the-emmeans-table"><span class="header-section-number">10.1.4.2</span> The emmeans table</a></li>
  <li><a href="#the-contrasts-table" id="toc-the-contrasts-table" class="nav-link" data-scroll-target="#the-contrasts-table"><span class="header-section-number">10.1.4.3</span> The contrasts table</a></li>
  <li><a href="#oneway-ttest" id="toc-oneway-ttest" class="nav-link" data-scroll-target="#oneway-ttest"><span class="header-section-number">10.1.4.4</span> <em>t</em> and <em>p</em> from the contrasts table – when there are more than two levels in <span class="math inline">\(X\)</span> – are not the same as those from pairwise <em>t</em>-tests among pairs of groups</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#working-in-r" id="toc-working-in-r" class="nav-link" data-scroll-target="#working-in-r"><span class="header-section-number">10.2</span> Working in R</a>
  <ul>
  <li><a href="#fit-the-model" id="toc-fit-the-model" class="nav-link" data-scroll-target="#fit-the-model"><span class="header-section-number">10.2.1</span> Fit the model</a>
  <ul class="collapse">
  <li><a href="#reordering-the-levels-of-the-factor-variables-to-some-meaningful-order" id="toc-reordering-the-levels-of-the-factor-variables-to-some-meaningful-order" class="nav-link" data-scroll-target="#reordering-the-levels-of-the-factor-variables-to-some-meaningful-order"><span class="header-section-number">10.2.1.1</span> Reordering the levels of the factor variables to some meaningful order</a></li>
  <li><a href="#the-r-formula-can-include-transformations-such-as-logy" id="toc-the-r-formula-can-include-transformations-such-as-logy" class="nav-link" data-scroll-target="#the-r-formula-can-include-transformations-such-as-logy"><span class="header-section-number">10.2.1.2</span> The R formula can include transformations such as log(y)</a></li>
  <li><a href="#the-r-formula-can-include-object-type-transformations-such-as-factorx" id="toc-the-r-formula-can-include-object-type-transformations-such-as-factorx" class="nav-link" data-scroll-target="#the-r-formula-can-include-object-type-transformations-such-as-factorx"><span class="header-section-number">10.2.1.3</span> The R formula can include object type transformations such as factor(x)</a></li>
  </ul></li>
  <li><a href="#controlling-the-output-in-tables-using-the-coefficient-table-as-an-example" id="toc-controlling-the-output-in-tables-using-the-coefficient-table-as-an-example" class="nav-link" data-scroll-target="#controlling-the-output-in-tables-using-the-coefficient-table-as-an-example"><span class="header-section-number">10.2.2</span> Controlling the output in tables using the coefficient table as an example</a></li>
  <li><a href="#using-the-emmeans-function" id="toc-using-the-emmeans-function" class="nav-link" data-scroll-target="#using-the-emmeans-function"><span class="header-section-number">10.2.3</span> Using the emmeans function</a></li>
  <li><a href="#using-the-contrast-function" id="toc-using-the-contrast-function" class="nav-link" data-scroll-target="#using-the-contrast-function"><span class="header-section-number">10.2.4</span> Using the contrast function</a>
  <ul class="collapse">
  <li><a href="#the-method-argument-controls-the-set-of-contrasts" id="toc-the-method-argument-controls-the-set-of-contrasts" class="nav-link" data-scroll-target="#the-method-argument-controls-the-set-of-contrasts"><span class="header-section-number">10.2.4.1</span> the method argument controls the set of contrasts</a></li>
  <li><a href="#planned-comparisons-using-custom-contrasts" id="toc-planned-comparisons-using-custom-contrasts" class="nav-link" data-scroll-target="#planned-comparisons-using-custom-contrasts"><span class="header-section-number">10.2.4.2</span> Planned comparisons using custom contrasts</a></li>
  <li><a href="#adjustment-for-multiple-tests" id="toc-adjustment-for-multiple-tests" class="nav-link" data-scroll-target="#adjustment-for-multiple-tests"><span class="header-section-number">10.2.4.3</span> Adjustment for multiple tests</a></li>
  </ul></li>
  <li><a href="#how-to-generate-anova-tables" id="toc-how-to-generate-anova-tables" class="nav-link" data-scroll-target="#how-to-generate-anova-tables"><span class="header-section-number">10.2.5</span> How to generate ANOVA tables</a>
  <ul class="collapse">
  <li><a href="#the-afex-aov_4-function" id="toc-the-afex-aov_4-function" class="nav-link" data-scroll-target="#the-afex-aov_4-function"><span class="header-section-number">10.2.5.1</span> The afex aov_4 function</a></li>
  <li><a href="#the-car-anova-function" id="toc-the-car-anova-function" class="nav-link" data-scroll-target="#the-car-anova-function"><span class="header-section-number">10.2.5.2</span> The car Anova function</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#hidden-code" id="toc-hidden-code" class="nav-link" data-scroll-target="#hidden-code"><span class="header-section-number">10.3</span> Hidden Code</a>
  <ul>
  <li><a href="#importing-and-wrangling-the-fig3d-data-for-example-1" id="toc-importing-and-wrangling-the-fig3d-data-for-example-1" class="nav-link" data-scroll-target="#importing-and-wrangling-the-fig3d-data-for-example-1"><span class="header-section-number">10.3.1</span> Importing and wrangling the fig3d data for example 1</a></li>
  <li><a href="#importing-and-wrangling-the-fig2a-data-for-example-2" id="toc-importing-and-wrangling-the-fig2a-data-for-example-2" class="nav-link" data-scroll-target="#importing-and-wrangling-the-fig2a-data-for-example-2"><span class="header-section-number">10.3.2</span> Importing and wrangling the fig2a data for example 2</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-oneway" class="quarto-section-identifier"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Linear models with a single, categorical <em>X</em> (“t-tests” and “ANOVA”)</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In the traditional hypothesis-testing strategy, researchers use a <em>t</em>-test if the factor variable has only two groups, or an ANOVA followed by <strong>post-hoc</strong> tests if the factor variable has more than two groups. In the linear-modeling strategy, we fit the same model, regardless of the number of groups.</p>
<section id="oneway-data" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="oneway-data"><span class="header-section-number">10.1</span> A linear model with a single factor (categorical <em>X</em>variable) estimates the effects of the levels of factor on the response</h2>
<p>To introduce a linear model with a single factor (categorical <span class="math inline">\(X\)</span> variable), I’ll use data from a set of experiments designed to measure the effect of the lipid 12,13-diHOME on brown adipose tissue (BAT) thermoregulation and the mechanism of this effect.</p>
<p><a href="https://www.nature.com/articles/nm.4297" target="_blank">Lynes, M.D., Leiria, L.O., Lundh, M., Bartelt, A., Shamsi, F., Huang, T.L., Takahashi, H., Hirshman, M.F., Schlein, C., Lee, A. and Baer, L.A., 2017. The cold-induced lipokine 12, 13-diHOME promotes fatty acid transport into brown adipose tissue. Nature medicine, 23(5), pp.631-637.</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5699924/pdf/nihms916046.pdf" target="_blank">Public source</a></p>
<p><a href="https://www.nature.com/articles/nm.4297#Sec14" target="_blank">Data source</a></p>
<p>Download the source data files and move to a new folder named “The cold-induced lipokine 12,13-diHOME promotes fatty acid transport into brown adipose tissue”.</p>
<p>Cold temperature and the neurotransmitter/hormone norepinephrine are known to stimulate increased thermogenesis in BAT cells. In this project, the researchers probed the question “what is the pathway that mediates the effect of cold-exposure on BAT thermogenesis?”. In the “discovery” component of this project, the researchers measured plasma levels of 88 lipids with known signaling properties in humans exposed to one hour of both normal (20 °C) and cold temperature (14 °C) temperature. Of the 88 lipids, 12,13-diHOME had the largest response to the cold treatment. The researchers followed this up with experiments on mice.</p>
<section id="oneway-example1" class="level3" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="oneway-example1"><span class="header-section-number">10.1.1</span> Example 1 (fig3d) – two treatment levels (“groups”)</h3>
<p>Let’s start with the experiment in Figure 3d, which was designed to measure the effect of 12,13-diHOME on plasma triglyceride level. If 12,13-diHOME stimulates BAT activity, then levels in the 12,13-diHOME mice should be less than levels in the control mice.</p>
<section id="step-1-understand-the-experiment-design-and-the-focal-comparisons" class="level4" data-number="10.1.1.1">
<h4 data-number="10.1.1.1" class="anchored" data-anchor-id="step-1-understand-the-experiment-design-and-the-focal-comparisons"><span class="header-section-number">10.1.1.1</span> Step 1 – Understand the experiment design and the focal comparisons</h4>
<p><strong>Design</strong>: single, categorical <em>X</em></p>
<p><strong>Response variable</strong>: <span class="math inline">\(\texttt{serum\_tg}\)</span>, A measure of serum triglycerides (mg/dl). <span class="math inline">\(\texttt{serum\_tg}\)</span> is a continuous variable.</p>
<p><strong>Factor variable</strong>: <span class="math inline">\(\texttt{treatment}\)</span>, with levels:</p>
<ol type="1">
<li>“Vehicle” – injected with saline; the negative control giving the expected response given handling and injection, but no 12,13-diHOME</li>
<li>“12,13-diHOME”</li>
</ol>
<p><strong>Contrasts of interest</strong></p>
<p>12,13-diHOME - Vehicle. Estimates the effect of 12,13-diHOME treatment. This is the focal contrast (and the only contrast).</p>
</section>
<section id="step-2-import" class="level4" data-number="10.1.1.2">
<h4 data-number="10.1.1.2" class="anchored" data-anchor-id="step-2-import"><span class="header-section-number">10.1.1.2</span> Step 2 – import</h4>
<p>Open the data and, if necessary, wrangle into an analyzable format. The script to import these data is in the section Hidden code below.</p>
</section>
<section id="step-3-inspect-the-data" class="level4" data-number="10.1.1.3">
<h4 data-number="10.1.1.3" class="anchored" data-anchor-id="step-3-inspect-the-data"><span class="header-section-number">10.1.1.3</span> Step 3 – inspect the data</h4>
<p>The second step is to examine the data to</p>
<ol type="1">
<li>get a sense of sample size and balance</li>
<li>check for biologically implausible outliers that suggest measurement failure, or transcription error (from a notebook, not in a cell)</li>
<li>assess outliers for outlier strategy or robust analysis</li>
<li>assess reasonable distributions and models for analysis.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggstripchart</span>(<span class="at">data =</span> fig3d,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"treatment"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"serum_tg"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_sd"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>       )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="one-factor_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There are no obviously implausible data points. A normal distribution model is a good, reasonable start. This can be checked more thoroughly after fitting the model.</p>
</section>
<section id="step-4-fit-the-model" class="level4" data-number="10.1.1.4">
<h4 data-number="10.1.1.4" class="anchored" data-anchor-id="step-4-fit-the-model"><span class="header-section-number">10.1.1.4</span> Step 4 – fit the model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fig3d_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(serum_tg <span class="sc">~</span> treatment, <span class="at">data =</span> fig3d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-5-check-the-model" class="level4" data-number="10.1.1.5">
<h4 data-number="10.1.1.5" class="anchored" data-anchor-id="step-5-check-the-model"><span class="header-section-number">10.1.1.5</span> Step 5 – check the model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># qqPlot(fig3d_m1, id=FALSE)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># spreadLevelPlot(fig3d_m1, id=FALSE)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcheck_the_model</span>(fig3d_m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="one-factor_files/figure-html/ggcheck-fig3d-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The Q-Q plot indicates that the distribution of residuals is well within that expected for a normal sample and there is no cause for concern with inference. The spread-location plot shows no conspicuous trend in how the spread changes with the conditonal mean. There is no cause for concern with inference.</p>
<p>Write something like this in your .Rmd file following the model check code chunk:</p>
<p>“The residuals are well within the range expected from sampling from a Normal distribution. The heterogeneity of the residuals is well within the range expected from sampling from a single distribution.”</p>
</section>
<section id="step-6-inference" class="level4" data-number="10.1.1.6">
<h4 data-number="10.1.1.6" class="anchored" data-anchor-id="step-6-inference"><span class="header-section-number">10.1.1.6</span> Step 6 – inference</h4>
<section id="coefficient-table" class="level5" data-number="10.1.1.6.1">
<h5 data-number="10.1.1.6.1" class="anchored" data-anchor-id="coefficient-table"><span class="header-section-number">10.1.1.6.1</span> coefficient table</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fig3d_m1_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(fig3d_m1)),</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">confint</span>(fig3d_m1))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>fig3d_m1_coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Estimate Std. Error   t value     Pr(&gt;|t|)     2.5 %
(Intercept)           42.620042   1.667226 25.563447 1.926081e-10  38.90523
treatment12,13-diHOME -7.167711   2.357813 -3.039982 1.246296e-02 -12.42125
                         97.5 %
(Intercept)           46.334853
treatment12,13-diHOME -1.914175</code></pre>
</div>
</div>
</section>
<section id="emmeans-table" class="level5" data-number="10.1.1.6.2">
<h5 data-number="10.1.1.6.2" class="anchored" data-anchor-id="emmeans-table"><span class="header-section-number">10.1.1.6.2</span> emmeans table</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fig3d_m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(fig3d_m1, <span class="at">specs =</span> <span class="st">"treatment"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(fig3d_m1_emm, <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">treatment</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">emmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Vehicle</td>
<td style="text-align: right;">42.6</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">38.9</td>
<td style="text-align: right;">46.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">12,13-diHOME</td>
<td style="text-align: right;">35.5</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">31.7</td>
<td style="text-align: right;">39.2</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="contrasts-table" class="level5" data-number="10.1.1.6.3">
<h5 data-number="10.1.1.6.3" class="anchored" data-anchor-id="contrasts-table"><span class="header-section-number">10.1.1.6.3</span> contrasts table</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fig3d_m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(fig3d_m1_emm,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">method =</span> <span class="st">"revpairwise"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(fig3d_m1_pairs, <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(12,13-diHOME) - Vehicle</td>
<td style="text-align: right;">-7.2</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">-12.4</td>
<td style="text-align: right;">-1.9</td>
<td style="text-align: right;">-3.04</td>
<td style="text-align: right;">0.0125</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="step-6-plot-the-model" class="level4" data-number="10.1.1.7">
<h4 data-number="10.1.1.7" class="anchored" data-anchor-id="step-6-plot-the-model"><span class="header-section-number">10.1.1.7</span> Step 6 – plot the model</h4>
<p>The norm in bench biology research is a response plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">ggplot_the_response</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  fig3d_m1,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  fig3d_m1_emm,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  fig3d_m1_pairs,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">"none"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="st">"Serum TG (µg/dL)"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>gg1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-oneway-fig3d_m1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-oneway-fig3d_m1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="one-factor_files/figure-html/fig-oneway-fig3d_m1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-oneway-fig3d_m1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.1: 12,13 diHOME reduced serum TG lvels. Six mice per group. P-value computed using lm(serum_tg ~ treatment) in R.
</figcaption>
</figure>
</div>
</div>
</div>
<p>If the researchers want to explicitly communicate more about the treatment effect, then they should “plot the model”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> <span class="fu">ggplot_the_model</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  fig3d_m1,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  fig3d_m1_emm,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  fig3d_m1_pairs,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">"none"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="st">"Serum TG (µg/dL)"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">effect_label =</span> <span class="st">"Effects (µg/dL)"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>gg2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-oneway-fig3d_m1-plot-model" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-oneway-fig3d_m1-plot-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="one-factor_files/figure-html/fig-oneway-fig3d_m1-plot-model-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-oneway-fig3d_m1-plot-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.2: 12,13 diHOME reduced serum TG lvels. Six mice per group. P-value computed using lm(serum_tg ~ treatment) in R.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="step-7-report-the-model-results" class="level4" data-number="10.1.1.8">
<h4 data-number="10.1.1.8" class="anchored" data-anchor-id="step-7-report-the-model-results"><span class="header-section-number">10.1.1.8</span> Step 7 – report the model results</h4>
<ol type="1">
<li>Different ways of reporting the results.</li>
</ol>
<ul>
<li>“12,13-diHOME reduced serum TG (p = 0.012)”</li>
<li>“12,13-diHOME reduced serum TG (Estimate = -7.17 µg/dL; 95% CI: -12.4, -1.9; p = 0.012)”</li>
<li>“The estimated effect of 12,13-diHOME on serum TG is -7.17 µg/dL (95% CI: -12.4, -1.9, <span class="math inline">\(p = 0.012\)</span>).”</li>
</ul>
<ol start="2" type="1">
<li>Don’t do this</li>
</ol>
<ul>
<li>“12,13-diHOME significantly reduced serum TG (<span class="math inline">\(p = 0.012\)</span>)”</li>
</ul>
<p>Why this is problematic: Significance applies to a <em>p</em>-value and not the effect. In English usage, “significant” means “large” or “important” and the <em>p</em>-value is not good evidence for either the size of an effect or the importance of an effect (see the p-value chapter). We interpret the size of effect from the estimated effect size and CI and the importance of an effect from knowledge of the physiological consequences of TG reduction over the range of the CI.</p>
</section>
</section>
<section id="understanding-the-analysis-with-two-treatment-levels" class="level3" data-number="10.1.2">
<h3 data-number="10.1.2" class="anchored" data-anchor-id="understanding-the-analysis-with-two-treatment-levels"><span class="header-section-number">10.1.2</span> Understanding the analysis with two treatment levels</h3>
<p>The variable <span class="math inline">\(\texttt{treatment}\)</span> in the Figure 3d mouse experiment, is a single, categorical <span class="math inline">\(X\)</span> variable. In a linear model, categorical variables are called <strong>factors</strong>. <span class="math inline">\(\texttt{treatment}\)</span> can take two different values, “Vehicle” and “12,13-diHOME”. The different values in a factor are the <strong>factor levels</strong> (or just “levels”). “Levels” is a strange usage of this word; a less formal name for levels is “groups”. In a <strong>Nominal</strong> categorical factor, the levels have no units and are unordered, even if the variable is based on a numeric measurement. For example, I might design an experiment in which mice are randomly assigned to one of three treatments: one hour at 14 °C, one hour at 18 °C, or one hour at 26 °C. If I model this treatment as a nominal categorical factor, then I simply have three levels. While I would certainly choose to arrange these levels in a meaningful way in a plot, for the analysis itself, these levels have no units and there is no order. <strong>Ordinal</strong> categorical factors have levels that are ordered but there is no information on relative distance. The treatment at 18 °C is not more similar to 14 °C than to 26 °C. Nominal categorical factors is the default in R and how all factors are analyzed in this text.</p>
<section id="linear-models-are-regression-models" class="level4" data-number="10.1.2.1">
<h4 data-number="10.1.2.1" class="anchored" data-anchor-id="linear-models-are-regression-models"><span class="header-section-number">10.1.2.1</span> Linear models are regression models</h4>
<p>The linear model fit to the serum TG data is</p>
<p><span id="eq-reg-model-example-1"><span class="math display">\[
\begin{align}
serum\_tg &amp;= \beta_0 + \beta_1 treatment_{12,13-diHOME} + \varepsilon\\
\varepsilon &amp;\sim N(0, \sigma^2)
\end{align}
\tag{10.1}\]</span></span></p>
<p>Model <a href="#eq-reg-model-example-1" class="quarto-xref">Equation&nbsp;<span>10.1</span></a> is a regression model where <span class="math inline">\(treatment_{12,13-diHOME}\)</span> is not the variable <span class="math inline">\(\texttt{treatment}\)</span>, containing the words “Vehicle” or “12,13-diHOME” but a numeric variable that indicates membership in the group “12,13-diHOME”. This variable contains the number 1 if the mouse belongs to “12,13-diHOME” and the number 0 if the mouse doesn’t belong to “12,13-diHOME”. <span class="math inline">\(treatment_{12,13-diHOME}\)</span> is known as an <strong>indicator variable</strong> because it indicates group membership. There are several ways of coding indicator variables and the way described here is called <strong>dummy</strong> or treatment coding. Dummy-coded indicator variables are sometimes called <strong>dummy variables</strong>.</p>
<p>The <code>lm</code> function creates indicator variables under the table, in something called the <strong>model matrix</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> treatment, <span class="at">data =</span> fig3d)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span><span class="sc">:</span>N,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) treatment12,13-diHOME
1            1                     0
2            1                     0
3            1                     0
4            1                     0
5            1                     0
6            1                     0
7            1                     1
8            1                     1
9            1                     1
10           1                     1
11           1                     1
12           1                     1</code></pre>
</div>
</div>
<p>The columns of the model matrix are the names of the <strong>model terms</strong> in the fit model. R names dummy variables by combining the names of the factor and the name of the level within the factor. So the <span class="math inline">\(X\)</span> variable that R creates in the model matrix for the fit linear model in model <a href="#eq-reg-model-example-1" class="quarto-xref">Equation&nbsp;<span>10.1</span></a> is <span class="math inline">\(treatment12,13-diHOME\)</span>. You can see these names as terms in the coefficient table of the fit model.</p>
<p>You should prove to yourself that <code>lm</code> fits the regression model <code>serum_tg ~ X</code> where X is the model matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(serum_tg <span class="sc">~</span> treatment, <span class="at">data =</span> fig3d)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(m1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)           42.620042   1.667226 25.563447 1.926081e-10
treatment12,13-diHOME -7.167711   2.357813 -3.039982 1.246296e-02</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> treatment, <span class="at">data =</span> fig3d)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(serum_tg <span class="sc">~</span> X, <span class="at">data =</span> fig3d)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(m2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)            42.620042   1.667226 25.563447 1.926081e-10
Xtreatment12,13-diHOME -7.167711   2.357813 -3.039982 1.246296e-02</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expand For Phenomenal Cosmic Power – alternatives to dummy coding
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are alternatives to dummy coding for creating indicator variables. Dummy coding is the default in R and it makes sense when thinking about experimental data with an obvious control level. I also like the interpretation of a “interaction effect” using Dummy coding. The classical coding for ANOVA is deviation effect coding, which creates coefficients that are deviations from the grand mean. In contrast to R, Deviation coding is the default in many statistical software packages including SAS, SPSS, and JMP. The method of coding can make a difference in an ANOVA table. Watch out for this – I’ve found several published papers where the researchers used the default dummy coding but interpreted the ANOVA table as if they had used deviation coding. This is both getting ahead of ourselves and somewhat moot, because I don’t advocate reporting ANOVA tables.</p>
</div>
</div>
</div>
<p><br></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expand For Phenomenal Cosmic Power – regression using matrix algebra
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Recall from stats 101 that the slope of <span class="math inline">\(X\)</span> in the model <span class="math inline">\(Y = b_0 + b_1 X\)</span> is <span class="math inline">\(b_1 = \frac{\textrm{COV}(X,Y)}{\textrm{VAR}(X)}\)</span>. This can be generalized using the equation</p>
<p><span class="math display">\[
\mathbf{b} = (\mathbf{X}^\top \mathbf{X})^{-1} \mathbf{X}^\top \mathbf{y}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{X}\)</span> is the model matrix containing a column for an intercept, columns for all indicator variables, and columns for all numeric covariates. <span class="math inline">\(\mathbf{b}\)</span> is a vector containing the model coefficients, including the intercept in the first element. The first part of the RHS (<span class="math inline">\(\mathbf{X}^\top \mathbf{X}\)</span>) is a matrix of the “sums of squares and cross-products” of the columns of <span class="math inline">\(\mathbf{X}\)</span>. Dividing each element of this matrix by <span class="math inline">\(N-1\)</span> gives us the covariance matrix of the <span class="math inline">\(\mathbf{X}\)</span>, which contains the variances of the <span class="math inline">\(X\)</span> columns along the diagonal, so this component has the role of the denominator in the stats 101 equation. Matrix algebra doesn’t do division, so the inverse of this matrix is multiplied by the second part. The second part or the RHS (<span class="math inline">\(\mathbf{X}^\top \mathbf{y}\)</span>) is a vector containing the cross-products of each column of <span class="math inline">\(\mathbf{X}\)</span> with <span class="math inline">\(\mathbf{y}\)</span>. Dividing each element of this vector by <span class="math inline">\(N-1\)</span> gives us the covariances of each <span class="math inline">\(X\)</span> with <span class="math inline">\(y\)</span>, so this component has the role of the numerator in the stats 101 equation.</p>
</div>
</div>
</div>
</section>
<section id="the-estimates-in-the-coefficient-table-are-estimates-of-the-parameters-of-the-linear-model-fit-to-the-data." class="level4" data-number="10.1.2.2">
<h4 data-number="10.1.2.2" class="anchored" data-anchor-id="the-estimates-in-the-coefficient-table-are-estimates-of-the-parameters-of-the-linear-model-fit-to-the-data."><span class="header-section-number">10.1.2.2</span> The Estimates in the coefficient table are estimates of the parameters of the linear model fit to the data.</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                       Estimate Std. Error   t value     Pr(&gt;|t|)     2.5 %
(Intercept)           42.620042   1.667226 25.563447 1.926081e-10  38.90523
treatment12,13-diHOME -7.167711   2.357813 -3.039982 1.246296e-02 -12.42125
                         97.5 %
(Intercept)           46.334853
treatment12,13-diHOME -1.914175</code></pre>
</div>
</div>
<p>The row names of the coefficient table are the column names of the model matrix. These are the model terms. There are two terms (two rows) because there are two parameters in the regression model <a href="#eq-reg-model-example-1" class="quarto-xref">Equation&nbsp;<span>10.1</span></a>. The values in the column <span class="math inline">\(\texttt{Estimate}\)</span> in the coefficient table are the estimates of the regression parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. These estimates are the coefficients of the fit model, <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>.</p>
</section>
<section id="oneway-what-coefs-are" class="level4" data-number="10.1.2.3">
<h4 data-number="10.1.2.3" class="anchored" data-anchor-id="oneway-what-coefs-are"><span class="header-section-number">10.1.2.3</span> The coefficients of a linear model using dummy coding have a useful interpretation</h4>
<div class="cell" data-filters="parse-latex">
<div id="tbl-example1-coef-understanding" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-filters="parse-latex">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example1-coef-understanding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.1: Understanding model coefficients of a linear model with a single treatment variable with two groups. The means in the interpretation column are conditional means.
</figcaption>
<div aria-describedby="tbl-example1-coef-understanding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
coefficient
</th>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:left;">
model term
</th>
<th style="text-align:left;">
interpretation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(b_0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\beta_0\)</span>
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:left;">
<span class="math inline">\(\overline{Vehicle}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(b_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\beta_1\)</span>
</td>
<td style="text-align:left;">
treatment12,13-diHOME
</td>
<td style="text-align:left;">
<span class="math inline">\(\overline{12,13\;diHOME} - \overline{Vehicle}\)</span>
</td>
</tr>
</tbody>
</table>
<p>.</p>
</div>
</div>
</figure>
</div>
</div>
<p>It is important to understand the interpretation of the coefficients of the fit linear model <a href="#eq-reg-model-example-1" class="quarto-xref">Equation&nbsp;<span>10.1</span></a> ( <a href="#tbl-example1-coef-understanding" class="quarto-xref">Table&nbsp;<span>10.1</span></a>).</p>
<ol type="1">
<li>The coefficient <span class="math inline">\(b_0\)</span> is the is the conditional mean of the response for the reference level, which is “Vehicle”. Remember that a conditional mean is the mean of a group that all have the same value for one or more <span class="math inline">\(X\)</span> variables.</li>
<li>The coefficient <span class="math inline">\(b_1\)</span> is the difference between the conditional means of the “12,13-diHOME” level and the reference (“Vehicle”) level:</li>
</ol>
<p><span class="math display">\[
\mathrm{E}[serum\_tg|treatment = \texttt{"12,13-diHOME"}] - \mathrm{E}[serum\_tg|treatment = \texttt{"Vehicle"}]
\]</span></p>
<p>Because there are no additional covariates in model, this difference is equal to the difference between the sample means <span class="math inline">\(\bar{Y}_{12,13-diHOME} - \bar{Y}_{Vehicle}\)</span>. The <em>direction</em> of this difference is important – it is non-reference level minus the reference level.</p>
<p>The estimate <span class="math inline">\(b_1\)</span> is the <strong>effect</strong> that we are interested in. Specifically, it is the measured effect of 12,13-diHOME on serum TG. When we inject 12,13-diHOME, we find the mean serum TG decreased by -7.2 µg/dL relative to the mean serum TG in the mice that were injected with saline. Importantly, the reference level is not a property of an experiment but is set by whomever is analyzing the data. Since the non-reference estimates are differences in means, it often makes sense to set the “control” treatment level as the reference level.</p>
<p>Many beginners mistakenly memorize the coefficient <span class="math inline">\(b_1\)</span> to equal the mean of the non-reference group (“12,13-diHOME”). Don’t do this. In a regression model, only <span class="math inline">\(b_0\)</span> is a mean. The coefficient <span class="math inline">\(b_1\)</span> in model <a href="#eq-reg-model-example-1" class="quarto-xref">Equation&nbsp;<span>10.1</span></a> is a difference in means.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-oneway-coef-fig" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-oneway-coef-fig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="one-factor_files/figure-html/fig-oneway-coef-fig-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-oneway-coef-fig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.3: What the coefficients of a linear model with a single categorical X mean. The means of the two treatment levels for the serum TG data are shown with the large, filled circles and the dashed lines. The intercept (<span class="math inline">\(b_0\)</span>) is the mean of the reference treatment level (“Vehicle”). The coefficient <span class="math inline">\(b_1\)</span> is the difference between the treatment level’s mean and the reference mean. As with a linear model with a continuous <span class="math inline">\(X\)</span>, the coefficient <span class="math inline">\(b_1\)</span> is an effect.
</figcaption>
</figure>
</div>
</div>
</div>
<p>A geometric interpretation of the coefficients is illustrated in Figure <a href="#fig-oneway-coef-fig" class="quarto-xref">Figure&nbsp;<span>10.3</span></a>. <span class="math inline">\(b_0\)</span> is the conditional mean of the reference level (“Vehicle”) and is an estimate of <span class="math inline">\(\beta_0\)</span>, the true, conditional mean of the population. <span class="math inline">\(b_1\)</span> is the difference in the conditional means of the first non-reference level (“12,13-diHOME”) and the reference level (“Vehicle”) and is an estimate of <span class="math inline">\(\beta_1\)</span>, the true difference in the conditional means of the population with and without the treatment 12,13-diHOME.</p>
</section>
<section id="better-know-the-coefficient-table" class="level4" data-number="10.1.2.4">
<h4 data-number="10.1.2.4" class="anchored" data-anchor-id="better-know-the-coefficient-table"><span class="header-section-number">10.1.2.4</span> Better know the coefficient table</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fig3d_m1_coef<span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 26%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 23%">
<col style="width: 7%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">t value</th>
<th style="text-align: right;">Pr(&gt;|t|)</th>
<th style="text-align: right;">2.5 %</th>
<th style="text-align: right;">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">42.6</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">25.6</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">38.9</td>
<td style="text-align: right;">46.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatment12,13-diHOME</td>
<td style="text-align: right;">-7.2</td>
<td style="text-align: right;">2.36</td>
<td style="text-align: right;">-3.0</td>
<td style="text-align: right;">0.0125</td>
<td style="text-align: right;">-12.4</td>
<td style="text-align: right;">-1.9</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol type="1">
<li>The <span class="math inline">\(\texttt{(Intercept)}\)</span> row contains the statistics for <span class="math inline">\(b_0\)</span> (the estimate of <span class="math inline">\(\beta_0\)</span>). Remember that <span class="math inline">\(b_0\)</span> is the conditional mean of the reference treatment (“Vehicle”).</li>
<li>The <span class="math inline">\(\texttt{treatment12,13-diHOME}\)</span> row contains the statistics for <span class="math inline">\(b_1\)</span> (the estimate of <span class="math inline">\(\beta_1\)</span>). Remember that <span class="math inline">\(b_1\)</span> is the difference in conditional means of the groups “12,13-diHOME” and “Vehicle”.</li>
<li>The column <span class="math inline">\(\texttt{Estimate}\)</span> contains the model coefficients, which are estimates of the parameters.</li>
<li>The column <span class="math inline">\(\texttt{Std. Error}\)</span> contains the model SEs of the coefficients. The SE of <span class="math inline">\(\texttt{(Intercept)}\)</span> is a standard error of a mean (SEM). The SE of <span class="math inline">\(\texttt{treatment12,13-diHOME}\)</span> is a standard error of a difference (SED).</li>
<li>The column <span class="math inline">\(\texttt{t value}\)</span> contains the test statistic of the coefficients. This value is the ratio <span class="math inline">\(\frac{Estimate}{SE}\)</span>. For this model, we are only interested in the test statistic for <span class="math inline">\(b_1\)</span>. Effectively, we will never be interested in the test statistic for <span class="math inline">\(b_0\)</span> because the mean of a group will never be zero.</li>
<li>The column <span class="math inline">\(\texttt{Pr(&gt;|t|)}\)</span> contains the <em>p</em>-values for the test statistic of the coefficients. For this model, and all models in this text, we are only interested in the <em>p</em>-value for the non-intercept coefficients.</li>
<li>The columns <span class="math inline">\(\texttt{2.5 %}\)</span> and <span class="math inline">\(\texttt{97.5 %}\)</span> contain the lower and upper limits of the 95% confidence interval of the estimate.</li>
</ol>
</section>
<section id="the-emmeans-table-is-a-table-of-modeled-means-and-inferential-statistics" class="level4" data-number="10.1.2.5">
<h4 data-number="10.1.2.5" class="anchored" data-anchor-id="the-emmeans-table-is-a-table-of-modeled-means-and-inferential-statistics"><span class="header-section-number">10.1.2.5</span> The emmeans table is a table of modeled means and inferential statistics</h4>
<div class="cell">
<div id="tbl-oneway-fig3d-emm" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-oneway-fig3d-emm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.2: Estimated marginal means table for model fig3d_m1.
</figcaption>
<div aria-describedby="tbl-oneway-fig3d-emm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">treatment</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">emmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Vehicle</td>
<td style="text-align: right;">42.6</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">38.9</td>
<td style="text-align: right;">46.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">12,13-diHOME</td>
<td style="text-align: right;">35.5</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">31.7</td>
<td style="text-align: right;">39.2</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p>The table of marginal means of a fit model gives the **modeled* mean, standard error and confidence interval for all specified groups. We use these <em>modeled</em> means, SEs, and CIs, for the response plot. Note that here is no test-statistic with a <em>p</em>-value because there is no significance test.</p>
<ol class="example" type="1">
<li>In this text, I’ll refer to this table as the “emmeans table”, since it is the output from the <code>emmeans</code> function (“em” is the abbreviation for “estimated marginal”).</li>
<li>I’ll use “modeled means”, “modeled SEs”, and “modeled CIs” to refer to the statistics in the table, as these are the estimate of means, SE, and CI from a fit linear model.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Better Know: marginal mean">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Better Know: marginal mean
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>marginal mean</strong> is the mean over a set of conditional means. For example, if a treatment factor has three levels, the conditional means are the means for each level and the marginal mean is the mean of the three means. Or, if the conditional means are the expected values given a continous covariate, the marginal mean is the expected value at the mean of covariate. The specified emmeans table of the fig3d data is not too exciting because it simply contains the conditional means – the values are not marginalized over any <span class="math inline">\(X\)</span>. Because the emmeans table contains different sorts of means (conditional, marginal, adjusted), this text will generally refer to the means in this table as “modeled means”</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is exceptionally important to understand the difference between the means, SEs, and CIs in the emmeans table and the statistics of the same name in a summary table of the data.</p>
</div>
</div>
<p>The emmeans table and a summary statistics table show different statistics – this is important to know for plotting.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>A summary table contains sampled means, SE, and CIs.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">treatment</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Vehicle</td>
<td style="text-align: right;">42.62004</td>
<td style="text-align: right;">1.77325</td>
<td style="text-align: right;">38.66899</td>
<td style="text-align: right;">46.57109</td>
</tr>
<tr class="even">
<td style="text-align: left;">12,13-diHOME</td>
<td style="text-align: right;">35.45233</td>
<td style="text-align: right;">1.55398</td>
<td style="text-align: right;">31.98984</td>
<td style="text-align: right;">38.91482</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Estimated marginal means table for model fig3d_m1.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">treatment</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">emmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Vehicle</td>
<td style="text-align: right;">42.62004</td>
<td style="text-align: right;">1.66723</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">38.90523</td>
<td style="text-align: right;">46.33485</td>
</tr>
<tr class="even">
<td style="text-align: left;">12,13-diHOME</td>
<td style="text-align: right;">35.45233</td>
<td style="text-align: right;">1.66723</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">31.73752</td>
<td style="text-align: right;">39.16714</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The top table is the summary statistics table for fig3d data. The bottom table is a the emmeans table of the fit model (m1). I show both to five decimal places for comparison of the values.</p>
<ol start="3" class="example" type="1">
<li>The statistics in a summary table are <strong>sampled</strong> means, SEs, and CIs – these statistics are computed for the group using <em>only the data in the group</em>.</li>
<li>The means in the emmeans table are modeled means. Here, and for many linear models, these will be equal to the sampled means. This will not be the case in some more complex models.</li>
<li>The modeled SEs and CIs show the range of means that are consistent with the data. This is important for understanding any mismatch between the data and the model (the model assumptions).</li>
<li>Unlike the modeled means, the modeled standard errors and confidence intervals will never equal sample standard errors and confidence intervals. In more complex models, plots using sample statistics can lead to very deceiving inference of differences between groups.</li>
<li>To understand modeled SEs and CIs, recall that the standard error of a sample mean is <span class="math inline">\(\frac{s}{\sqrt{n}}\)</span>, where <span class="math inline">\(s\)</span> is the sample standard deviation and <span class="math inline">\(n\)</span> is the sample size in the group. The computation of the SE in the emmeans table uses the same equation, except the numerator is not the sample standard deviation of the group but the model standard deviation, which is an estimate of the true standard deviation <span class="math inline">\(\sigma\)</span>. As with the sample SE, the denominator for the modeled SE is the sample size <span class="math inline">\(n\)</span> for the group. Since the numerator of the modeled SE is the same for all groups, the modeled SE will be the same in all groups that have the same sample size, as seen in the marginal means table for the model fit to the Figure 3d data. This is not true for sampled SEs, since sampled standard deviations will always differ.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Better Know: model sigma">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Better Know: model sigma
</div>
</div>
<div class="callout-body-container callout-body">
<p>It may seem odd to use a common standard deviation in the computation of the modeled SEs. It is not. Remember that an assumption of the linear model is homogeneity of variances – that all residuals <span class="math inline">\(e_i\)</span> are drawn from the same distribution (<span class="math inline">\(N(0, \sigma^2)\)</span>) (a “single hat”) regardless of group. The model standard deviation <span class="math inline">\(\hat{\sigma}\)</span> is the estimate of the square root of the variance of this distribution. Given this interpretation, it is useful to think of each sample standard deviation as an estimate of <span class="math inline">\(\sigma\)</span> (the linear model assumes that all differences among the sample standard deviations are due entirely to sampling). The model standard deviation is a more precise estimate of <span class="math inline">\(\sigma\)</span> since it is computed from a larger sample (all <span class="math inline">\(N\)</span> residuals).</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Better Know: model sigma">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Better Know: model sigma
</div>
</div>
<div class="callout-body-container callout-body">
<p>The model standard deviation is called the “pooled” standard deviation in the ANOVA literature and is computed as a sample-size weighted average of the sample standard deviations.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Better Know: model sigma">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Better Know: model sigma
</div>
</div>
<div class="callout-body-container callout-body">
<p>The modeled standard error of the mean uses the estimate of <span class="math inline">\(\sigma\)</span> from the fit model. This estimate is</p>
<p><span class="math display">\[\begin{equation}
\hat{\sigma} = \sqrt{\frac{\sum{(y_i - \hat{y}_i)^2}}{df}}
\end{equation}\]</span></p>
<p>Create a code chunk that computes this. Recall that <span class="math inline">\((y_i - \hat{y}_i)\)</span> is the set of residuals from the model, which can be extracted using <code>residuals(fit)</code> where “fit” is the fit model object. <span class="math inline">\(df\)</span> is the model degrees of freedom, which is <span class="math inline">\(N-k\)</span>, where <span class="math inline">\(N\)</span> is the total sample size and <span class="math inline">\(k\)</span> is the number of parameters that are fit. This makes sense – for the sample variance there is one parameter that is fit, the mean of the group, so the denominator is <span class="math inline">\(n - 1\)</span>. In model fig3d_m1, there are two parameters that are fit, the intercept and the coefficient of treatment12,13-diHOME, so the denominator is <span class="math inline">\(N - 2\)</span> where <span class="math inline">\(N\)</span> is the total sample size (the sum of the <span class="math inline">\(n\)</span> for each treatment level).</p>
</div>
</div>
</section>
<section id="estimates-of-the-effects-are-in-the-contrasts-table" class="level4" data-number="10.1.2.6">
<h4 data-number="10.1.2.6" class="anchored" data-anchor-id="estimates-of-the-effects-are-in-the-contrasts-table"><span class="header-section-number">10.1.2.6</span> Estimates of the effects are in the contrasts table</h4>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(12,13-diHOME) - Vehicle</td>
<td style="text-align: right;">-7.2</td>
<td style="text-align: right;">2.36</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">-12.4</td>
<td style="text-align: right;">-1.9</td>
<td style="text-align: right;">-3</td>
<td style="text-align: right;">0.012</td>
</tr>
</tbody>
</table>


</div>
</div>
<ol type="1">
<li>This table is important for reporting treatment effects and CIs and for plotting the model. A contrast is a difference in means. With only two treatment levels, the table of contrasts doesn’t give any more information than the coefficient table – the single contrast is the coefficient <span class="math inline">\(b_1\)</span> in the coefficient table. Nevertheless, I advocate computing this table to stay consistent and because the script (or function) to plot the model uses this table and not the coefficient table.</li>
<li>The value in the column <span class="math inline">\(\texttt{Estimate}\)</span> is the mean of the non-reference group (“12,13-diHOME”) minus the mean of the reference group (“Vehicle”).</li>
<li>The value in the “SE” column is the standard error of the difference (SED), specifically the difference in the estimate column. This SE is computed using the model standard deviation <span class="math inline">\(\sigma\)</span>.</li>
<li>The values in the “lower.CL” and “upper.CL” columns are the bounds of the 95% confidence interval of the estimate. Remember (from Chapter @ref(variability)) to think of this interval as containing potential values of the true parameter (the true difference in means between the two groups) that are reasonably compatible with the data. Don’t think of the interval as having 95% probability of containing the true effect. Remember that a confidence interval applies to the procedure and not a parameter – 95% of the CIs from hypothetical, replicate experiments that meet all the assumptions used to compute the CI will include the true effect.</li>
<li>The columns “t.ratio” and “p.value” contains the <em>t</em> and <em>p</em> values of the significance (not hypothesis!) test of the estimate. The <em>t</em>-statistic is the ratio of the estimate to the SE of the estimate (use the console to confirm this given the values in the table). It is a signal (the estimate) to noise (SE of the estimate) ratio. The <em>p</em>-value is the probability of sampling from normal distribution with the observed standard deviation, randomly assigning the sampled values to either “Vehicle” or “12,13-diHOME”, fitting the linear model, and observing a <em>t</em>-value as or more extreme than the observed <em>t</em>. A very small <em>p</em>-value is consistent with the experiment “not sampling from distributions with the same mean” – meaning that adding a treatment affects the mean of the distribution. This is the logic used to infer a treatment effect. Unfortunately, it is also consistent with the experiment not approximating other conditions of the model, including non-random assignment, non-independence, non-normal conditional responses, and variance heterogeneity. It is up to the rigorous researcher to be sure that these other model conditions are approximated or “good enough” to use the <em>p</em>-value to infer a treatment effect on the mean.</li>
</ol>
</section>
<section id="t-and-p-from-the-contrasts-table-when-there-are-only-two-levels-in-x-are-the-same-as-t-and-p-from-a-t-test" class="level4" data-number="10.1.2.7">
<h4 data-number="10.1.2.7" class="anchored" data-anchor-id="t-and-p-from-the-contrasts-table-when-there-are-only-two-levels-in-x-are-the-same-as-t-and-p-from-a-t-test"><span class="header-section-number">10.1.2.7</span> <em>t</em> and <em>p</em> from the contrasts table – when there are only two levels in <span class="math inline">\(X\)</span> – are the same as <em>t</em> and <em>p</em> from a <em>t</em>-test</h4>
<p>Compare</p>
<p>coefficient table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(serum_tg <span class="sc">~</span> treatment, <span class="at">data =</span> fig3d)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(m1)) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 30%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 14%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">t value</th>
<th style="text-align: right;">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">42.62004</td>
<td style="text-align: right;">1.667226</td>
<td style="text-align: right;">25.563447</td>
<td style="text-align: right;">0.000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatment12,13-diHOME</td>
<td style="text-align: right;">-7.16771</td>
<td style="text-align: right;">2.357813</td>
<td style="text-align: right;">-3.039982</td>
<td style="text-align: right;">0.012463</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>contrast table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="st">"treatment"</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"revpairwise"</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(12,13-diHOME) - Vehicle</td>
<td style="text-align: right;">-7.16771</td>
<td style="text-align: right;">2.357813</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">-3.039982</td>
<td style="text-align: right;">0.012463</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>t-test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(fig3d[treatment <span class="sc">==</span> <span class="st">"12,13-diHOME"</span>, serum_tg],</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>             fig3d[treatment <span class="sc">==</span> <span class="st">"Vehicle"</span>, serum_tg],</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(m2) <span class="sc">|&gt;</span> <span class="co"># glance is from the broom package</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">parameter</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">alternative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-7.16771</td>
<td style="text-align: right;">35.45233</td>
<td style="text-align: right;">42.62004</td>
<td style="text-align: right;">-3.039982</td>
<td style="text-align: right;">0.012463</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">-12.42125</td>
<td style="text-align: right;">-1.914175</td>
<td style="text-align: left;">Two Sample t-test</td>
<td style="text-align: left;">two.sided</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Notes</p>
<ol type="1">
<li>The default <code>t.test</code> in R is the Welch t-test for heterogenous variance. To compute the Student t-test, use <code>var.equal = TRUE</code>.</li>
<li>The “statistic” in the t-test output contains the <em>t</em>-value of the <em>t</em>-test. It is precisely the same as the <em>t</em>-statistic in the coefficient table and the contrast table.</li>
<li>The <em>p</em>-values in all three tables are precisely the same.</li>
</ol>
<p>The <em>t</em> and <em>p</em> values for the <em>t</em>-test are the same as those for the linear model, because the <em>t</em>-test is a specific case of the linear model. Reasons to abandon classic <em>t</em>-tests and learn the linear modeling strategy include</p>
<ol type="1">
<li>A linear modeling strategy encourages researchers to think about the effect and uncertainty in the effect and not just a <em>p</em>-value.</li>
<li>The linear model is nearly infinitely flexible and expandible while the <em>t</em>-test is limited to a few variations.</li>
</ol>
<p>There is rarely a reason to ever use the <code>t.test()</code> function. Throw the function away. Ignore web pages that teach you to use it. The <em>t</em>-test is easy to learn, which encourages its overuse. If your only tool is a t-test, every problem looks like a comparison between two-means.</p>
</section>
</section>
<section id="oneway-example2" class="level3" data-number="10.1.3">
<h3 data-number="10.1.3" class="anchored" data-anchor-id="oneway-example2"><span class="header-section-number">10.1.3</span> Example 2 – three treatment levels (“groups”)</h3>
<section id="understand-the-experiment-design" class="level4" data-number="10.1.3.1">
<h4 data-number="10.1.3.1" class="anchored" data-anchor-id="understand-the-experiment-design"><span class="header-section-number">10.1.3.1</span> Understand the experiment design</h4>
<p>The data come from the experiment reported in Figure 2a of the 12,13-diHOME article described above. This experiment was designed to probe the hypothesis that 12,13-diHOME is a mediator of known stimulators of increased BAT activity (exposure to cold temperature and sympathetic nervous system activation). Mice were assigned to control (30 °C), one-hour exposure to 4 °C, or 30 minute norepinephrine (NE) treatment level (NE is the neurotransmitter of the sympathetic neurons targeting peripheral tissues).</p>
<p><strong>design</strong>: single, categorical <em>X</em> with three levels.</p>
<p><strong>response variable</strong>: <span class="math inline">\(\texttt{diHOME}\)</span>, the serum concentration of 12,13-diHOME. a continuous variable.</p>
<p><strong>factor variable</strong>: <span class="math inline">\(\texttt{treatment}\)</span>, with levels:</p>
<ol type="1">
<li>“Control” – the negative control. We expect diHOME to be low relative to the two treated conditions.</li>
<li>“Cold” – focal treatment 1. Given the working model of 12,13-diHome as a mediator between stimulation and BAT, this response should be relatively high compared to Control. In the archived data, this group is “1 hour cold”.</li>
<li>“NE” – focal treatment 2. Given the working model of 12,13-diHome as a mediator between stimulation and BAT, this response should be relatively high compared to Control. In the archived data, this group is “30 min NE”.</li>
</ol>
<p><strong>planned contrasts</strong></p>
<ol type="1">
<li>Cold - Control – If diHOME is a mediator of cold, then difference should be positive.</li>
<li>NE - Control – If diHOME is a mediator of NE, then difference should be positive.</li>
</ol>
<p>The contrast Cold - NE is not of interest.</p>
</section>
<section id="fig2a-m1" class="level4" data-number="10.1.3.2">
<h4 data-number="10.1.3.2" class="anchored" data-anchor-id="fig2a-m1"><span class="header-section-number">10.1.3.2</span> fit the model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fig2a_m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(diHOME <span class="sc">~</span> treatment, <span class="at">data =</span> fig2a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-the-model" class="level4" data-number="10.1.3.3">
<h4 data-number="10.1.3.3" class="anchored" data-anchor-id="check-the-model"><span class="header-section-number">10.1.3.3</span> check the model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcheck_the_model</span>(fig2a_m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in rlm.default(x, y, weights, method = method, wt.method = wt.method, :
'rlm' failed to converge in 20 steps</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="one-factor_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The Q-Q plot indicates that the distribution of residuals is within that expected for a normal sample. The spread-location plot shows no conspicuous trend in how the spread changes with the conditonal mean. There is little cause for concern with inference from a linear model.</p>
<p>Write something like this in your .Rmd file following the model check code chunk:</p>
<p>“The residuals are within the range expected from sampling from a Normal distribution. The heterogeneity of the residuals is well within the range expected from sampling from a single distribution.”</p>
</section>
<section id="inference-from-the-model" class="level4" data-number="10.1.3.4">
<h4 data-number="10.1.3.4" class="anchored" data-anchor-id="inference-from-the-model"><span class="header-section-number">10.1.3.4</span> Inference from the model</h4>
<section id="coefficient-table-1" class="level5" data-number="10.1.3.4.1">
<h5 data-number="10.1.3.4.1" class="anchored" data-anchor-id="coefficient-table-1"><span class="header-section-number">10.1.3.4.1</span> coefficient table</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fig2a_m1_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(fig2a_m1)),</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">confint</span>(fig2a_m1))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>fig2a_m1_coef<span class="sc">|&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 25%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">t value</th>
<th style="text-align: right;">Pr(&gt;|t|)</th>
<th style="text-align: right;">2.5 %</th>
<th style="text-align: right;">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">0.0016</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">18.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatmentCold</td>
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">4.57</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.1405</td>
<td style="text-align: right;">-2.7</td>
<td style="text-align: right;">16.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treatmentNE</td>
<td style="text-align: right;">14.8</td>
<td style="text-align: right;">4.36</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">0.0044</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">24.1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="emmeans-table-1" class="level5" data-number="10.1.3.4.2">
<h5 data-number="10.1.3.4.2" class="anchored" data-anchor-id="emmeans-table-1"><span class="header-section-number">10.1.3.4.2</span> emmeans table</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fig2a_m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(fig2a_m1, <span class="at">specs =</span> <span class="st">"treatment"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>fig2a_m1_emm<span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">treatment</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">emmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">18.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cold</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">3.38</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">11.9</td>
<td style="text-align: right;">26.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NE</td>
<td style="text-align: right;">26.8</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">20.2</td>
<td style="text-align: right;">33.4</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="contrasts-table-1" class="level5" data-number="10.1.3.4.3">
<h5 data-number="10.1.3.4.3" class="anchored" data-anchor-id="contrasts-table-1"><span class="header-section-number">10.1.3.4.3</span> contrasts table</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fig2a_m1_planned <span class="ot">&lt;-</span> <span class="fu">contrast</span>(fig2a_m1_emm,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"trt.vs.ctrl"</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">adjust =</span> <span class="st">"none"</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">level =</span> <span class="fl">0.95</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>fig2a_m1_planned<span class="sc">|&gt;</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cold - Control</td>
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">-2.7</td>
<td style="text-align: right;">16.9</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">0.1405</td>
</tr>
<tr class="even">
<td style="text-align: left;">NE - Control</td>
<td style="text-align: right;">14.8</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">24.1</td>
<td style="text-align: right;">3.40</td>
<td style="text-align: right;">0.0044</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Notes:</p>
<ol type="1">
<li>the <code>adjust =</code> argument is used to choose the method of <em>p</em>-value adjustment. This is a big topic and this book has a hot-take, which is all covered in <a href="multiple-testing.html" class="quarto-xref"><span>Chapter 12</span></a>.</li>
</ol>
</section>
</section>
<section id="plot-the-model" class="level4" data-number="10.1.3.5">
<h4 data-number="10.1.3.5" class="anchored" data-anchor-id="plot-the-model"><span class="header-section-number">10.1.3.5</span> plot the model</h4>
<p>The usual response plot…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_the_response</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  fig2a_m1,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  fig2a_m1_emm,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  fig2a_m1_planned,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">"none"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="st">"12,13-diHOME (pmol/mL)"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="one-factor_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Or, if we want to emphasize the effect…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_the_model</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  fig2a_m1,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  fig2a_m1_emm,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  fig2a_m1_planned,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend_position =</span> <span class="st">"none"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_label =</span> <span class="st">"12,13-diHOME (pmol/mL)"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">effect_label =</span> <span class="st">"Effects (pmol/mL)"</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> pal_okabe_ito_blue,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="one-factor_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="report-the-model-results" class="level4" data-number="10.1.3.6">
<h4 data-number="10.1.3.6" class="anchored" data-anchor-id="report-the-model-results"><span class="header-section-number">10.1.3.6</span> Report the model results</h4>
<ol type="1">
<li>Different ways of reporting the results in increasing order of making claims that are evidenced by the statistical analysis,</li>
</ol>
<ul>
<li>“NE exposure increased 12,13-diHOME but the effect of cold exposure on 12,13-diHOME is not clear”.</li>
<li>“The estimated effect of NE exposure is consistent with a NE-induced increase in 12,13-diHOME while the estimated effect of cold exposure is less clear”.</li>
<li>“The estimated effect of NE exposure is consistent with a NE-induced increase in 12,13-diHOME (Estimate = 14.8 pmol/mL; 95% CI: 5.4, 24.1; <span class="math inline">\(p = 0.004\)</span>) while the estimated effect of cold exposure is less clear (Estimate = 7.1 pmol/mL; 95% CI: -2.7, 16.9; <span class="math inline">\(p = 0.14\)</span>)”.</li>
</ul>
<p>The first statement makes the definitive claim that NE causes the increase but there is not unreasonable probability of this magnitude of effect occurring by random sampling. In addition the experiment could be infected by experiment implementation decisions that make this p-value unreliable. The second statement makes a tentative claim. The third statement adds the statistics that provide the evidence for the tentative claim. The statistics could be moved to some combination of the figure, the figure caption, and a supplement.</p>
<ol start="2" type="1">
<li>Don’t do this</li>
</ol>
<ul>
<li>NE exposures significantly increased 12,13-diHOME (<span class="math inline">\(p = 0.004\)</span>)”</li>
<li>There is no effect of cold exposure on 12,13-diHOME (<span class="math inline">\(p = 0.14\)</span>)”</li>
</ul>
<p>Why the first statement is problematic: Significance applies to a <em>p</em>-value and not the effect. In English usage, “significant” means “large” or “important” and the <em>p</em>-value is not good evidence for either the size of an effect or the importance of an effect (see the p-value chapter). We interpret the size of effect from the estimated effect size and CI and the importance of an effect from knowledge of the physiological consequences of TG reduction over the range of the CI.</p>
<p>Why the second statement is problematic: <em>p &gt; 0.05</em>, or a high p-value more generally, is not evidence of no effect because a <em>p</em>-value (or <em>1 - p</em>) does not give the probability that a treatment effect is zero. One could use an <strong>equivalence test</strong> to give [the probability that an effect is less than some physiologically meaningful magnitude][https://journals.sagepub.com/doi/abs/10.1177/1948550617697177]</p>
</section>
</section>
<section id="understanding-the-analysis-with-three-or-more-treatment-levels" class="level3" data-number="10.1.4">
<h3 data-number="10.1.4" class="anchored" data-anchor-id="understanding-the-analysis-with-three-or-more-treatment-levels"><span class="header-section-number">10.1.4</span> Understanding the analysis with three (or more) treatment levels</h3>
<section id="better-know-the-coefficient-table-1" class="level4" data-number="10.1.4.1">
<h4 data-number="10.1.4.1" class="anchored" data-anchor-id="better-know-the-coefficient-table-1"><span class="header-section-number">10.1.4.1</span> Better know the coefficient table</h4>
<p>The fit regression model for the data in Figure 2a is</p>
<p><span class="math display">\[\begin{equation}
diHOME_i = b_0 + b_1 treatment_{Cold,i} + b_2 treatment_{NE,i} + e_i
(\#eq:fit-dihome)
\end{equation}\]</span></p>
<p>The coefficients of the model are in the <span class="math inline">\(\texttt{Estimate}\)</span> column of the coefficient table.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 25%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">t value</th>
<th style="text-align: right;">Pr(&gt;|t|)</th>
<th style="text-align: right;">2.5 %</th>
<th style="text-align: right;">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">0.0016</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">18.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatmentCold</td>
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.1405</td>
<td style="text-align: right;">-2.7</td>
<td style="text-align: right;">16.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treatmentNE</td>
<td style="text-align: right;">14.8</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">0.0044</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">24.1</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol type="1">
<li>The <span class="math inline">\(\texttt{(Intercept)}\)</span> row contains the statistics for <span class="math inline">\(b_0\)</span> (the estimate of <span class="math inline">\(\beta_0\)</span>). Here, <span class="math inline">\(b_0\)</span> is the mean of the reference group, which is “Control”.</li>
<li>The <span class="math inline">\(\texttt{treatmentCold}\)</span> row contains the statistics for <span class="math inline">\(b_1\)</span> (the estimate of <span class="math inline">\(\beta_1\)</span>). Here, <span class="math inline">\(b_1\)</span> is the difference <span class="math inline">\(\mathrm{E}[diHOME|treatment = \texttt{"Cold"}] - \mathrm{E}[diHOME|treatment = \texttt{"Control"}]\)</span>. This difference in conditional means is equal to the difference in the sample means of the two groups <em>for this model</em> because there are no additional covariates in the model.</li>
<li>The <span class="math inline">\(\texttt{treatmentNE}\)</span> row contains the statistics for <span class="math inline">\(b_2\)</span> (the estimate of <span class="math inline">\(\beta_2\)</span>). Here, <span class="math inline">\(b_2\)</span> is the difference <span class="math inline">\(\mathrm{E}[diHOME|treatment = \texttt{"NE"}] - \mathrm{E}[diHOME|treatment = \texttt{"Control"}]\)</span>. Do not make the mistake in thinking that the value in <span class="math inline">\(\texttt{Estimate}\)</span> is the mean of the “NE” group.</li>
<li>The number of non-intercept coefficients generalizes to any number of levels of the factor variable. If there are <span class="math inline">\(k\)</span> levels of the factor, there are <span class="math inline">\(k-1\)</span> indicator variables, each with its own coefficient (<span class="math inline">\(b_1\)</span> through <span class="math inline">\(b_{k-1}\)</span>) estimating the effect of that treatment level relative to the control (if using dummy coding).</li>
</ol>
<p>Again – Do not make the mistake in thinking that the values in <span class="math inline">\(\texttt{Estimate}\)</span> for the <span class="math inline">\(\texttt{treatmentCold}\)</span> and <span class="math inline">\(\texttt{treatmentNE}\)</span> rows are the <em>means</em> of the “Cold” and “NE” groups. These coefficients are differences in means. And, to emphasize further understanding of these coefficients, both <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> are “slopes”. Don’t visualize this as a single line from the control mean through both non-control means. Slopes is plural – there are two regression lines. <span class="math inline">\(b_1\)</span> is the slope of the line from the control mean to the “Cold” mean while <span class="math inline">\(b_2\)</span> is the slope of the line from the control mean to the “NE” mean. The numerator of each slope is the difference between that group’s mean and the control mean. The denominator of each slope is 1 (because each has the value 1 when the row is assigned to that group).</p>
<p>Two understand the names of the model terms, it’s useful to recall the order of the factor levels of <span class="math inline">\(\texttt{treatment}\)</span>, which is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(fig2a<span class="sc">$</span>treatment) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Control" "Cold"    "NE"     </code></pre>
</div>
</div>
<p>Given this ordering, the <code>lm</code> function creates a regression model with an intercept column for the “Control” group (because the first group in the list is the reference level), an indicator variable for the “Cold” group called <code>treatmentCold</code>, and an indicator variable for the “NE” group called <code>treatmentNE</code>. We can see these model names by peeking at the model matrix of the fit model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>fig2a_m1_X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(fig2a_m1)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fig2a_m1_X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) treatmentCold treatmentNE
1           1             0           0
2           1             1           0
3           1             0           1
4           1             0           0
5           1             1           0
6           1             0           1</code></pre>
</div>
</div>
<p>The column <span class="math inline">\(\texttt{treatmentCold}\)</span> is a dummy-coded indicator variable containing the number 1, if the individual is in the “Cold” group, or the number 0, otherwise. The column <span class="math inline">\(\texttt{treatmentNE}\)</span> is a dummy-coded indicator variable containing the number 1, if the individual is in the “NE” group, or the number 0, otherwise.</p>
<p>The model coefficients, parameters, model term, and interpretation are summarized in the following table.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Understanding model coefficients of a linear model with a single treatment variable with three groups. The means in the interpreation column are conditional means.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">coefficient</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">parameter</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">model term</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">$b_0$</td>
<td style="text-align: left;">$\beta_0$</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: left;">$\overline{Control}$</td>
</tr>
<tr class="even">
<td style="text-align: left;">$b_1$</td>
<td style="text-align: left;">$\beta_1$</td>
<td style="text-align: left;">treatmentCold</td>
<td style="text-align: left;">$\overline{1\;hour\;cold} - \overline{Control}$</td>
</tr>
<tr class="odd">
<td style="text-align: left;">$b_2$</td>
<td style="text-align: left;">$\beta_2$</td>
<td style="text-align: left;">treatmentNE</td>
<td style="text-align: left;">$\overline{30\;min\;NE} - \overline{Control}$</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="the-emmeans-table" class="level4" data-number="10.1.4.2">
<h4 data-number="10.1.4.2" class="anchored" data-anchor-id="the-emmeans-table"><span class="header-section-number">10.1.4.2</span> The emmeans table</h4>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">treatment</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">emmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">18.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cold</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">3.38</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">11.9</td>
<td style="text-align: right;">26.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NE</td>
<td style="text-align: right;">26.8</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">20.2</td>
<td style="text-align: right;">33.4</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>This table is important for reporting means and CIs and for plotting the model. As in example 1, the modeled means in the column “emmean” are the sample means of each group (what you would compute if you simply computed the mean for that group). Again, this is true for this model, but is not generally true.</p>
<p>And again, as in example 1, the SE for each mean is <em>not</em> the sample SE but the modeled SE – the numerator is the estimate of <span class="math inline">\(\sigma\)</span> from the fit model, which includes residuals from all groups combined. <em>These are the SEs that you should report</em> because it is these SEs that are used to compute the <em>p</em>-value and CI that you report, that is, they tell the same “story”. The SE for the “Cold” group is a bit higher because the sample size <span class="math inline">\(n\)</span> for this group is smaller by 1.</p>
</section>
<section id="the-contrasts-table" class="level4" data-number="10.1.4.3">
<h4 data-number="10.1.4.3" class="anchored" data-anchor-id="the-contrasts-table"><span class="header-section-number">10.1.4.3</span> The contrasts table</h4>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cold - Control</td>
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">4.57</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">-2.7</td>
<td style="text-align: right;">16.9</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.1405</td>
</tr>
<tr class="even">
<td style="text-align: left;">NE - Control</td>
<td style="text-align: right;">14.8</td>
<td style="text-align: right;">4.36</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">24.1</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">0.0044</td>
</tr>
</tbody>
</table>


</div>
</div>
<ol type="1">
<li>This table is important for reporting treatment effects and CIs and for plotting the model. A contrast is a difference in means.</li>
<li>The contrast table here has no more information than is in the coefficient table, but that is not generally true for models with treatment factors with more than two groups. In “Working in R” below, I show how to compute a contrast table with all pairwise comparisons (contrasts between all possible pairings of the groups)</li>
<li>The column <span class="math inline">\(\texttt{Contrast}\)</span> contains the names of the contrasts. Note that the name gives the direction of the difference.</li>
<li>The values in the column <span class="math inline">\(\texttt{estimate}\)</span> are the contrasts. These are the differences in the conditional means of the groups identified in the <span class="math inline">\(\texttt{Contrast}\)</span> column. These are the <strong>effects</strong> that we are interested in.</li>
<li>The value in the “SE” column is the standard error of the difference (SED) of each contrast. This SE is computed using the model standard deviation <span class="math inline">\(\sigma\)</span>.</li>
<li>The values in the “lower.CL” and “upper.CL” columns are the bounds of the 95% confidence interval of the estimate. Remember (from Chapter @ref(variability)) to think of this interval as containing potential values of the true parameter (the true difference in means between the two groups) that are reasonably compatible with the data. Don’t think of the interval as having 95% probability of containing the true effect. Remember that a confidence interval applies to the procedure and not a parameter – 95% of the CIs from hypothetical, replicate experiments that meet all the assumptions used to compute the CI will include the true effect.</li>
<li>The columns “t.ratio” and “p.value” contains the <em>t</em> and <em>p</em> values of the significance (not hypothesis!) test of the estimate. The <em>t</em>-statistic is the ratio of the estimate to the SE of the estimate (use the console to confirm this given the values in the table). It is a signal (the estimate) to noise (SE of the estimate) ratio. The <em>p</em>-value is the probability of sampling from normal distribution with the observed standard deviation, randomly assigning the sampled values to the three groups (using the original sample sizes for each), fitting the linear model, and observing a <em>t</em>-value as or more extreme than the observed <em>t</em>. A very small <em>p</em>-value is consistent with the experiment “not sampling from distributions with the same mean” – meaning that adding a treatment affects the mean of the distribution. This is the logic used to infer a treatment effect. Unfortunately, it is also consistent with the experiment not approximating other conditions of the model, including non-random assignment, non-independence, non-normal conditional responses, and variance heterogeneity. It is up to the rigorous researcher to be sure that these other model conditions are approximated or “good enough” to use the <em>p</em>-value to infer a treatment effect on the mean.</li>
</ol>
</section>
<section id="oneway-ttest" class="level4" data-number="10.1.4.4">
<h4 data-number="10.1.4.4" class="anchored" data-anchor-id="oneway-ttest"><span class="header-section-number">10.1.4.4</span> <em>t</em> and <em>p</em> from the contrasts table – when there are more than two levels in <span class="math inline">\(X\)</span> – are not the same as those from pairwise <em>t</em>-tests among pairs of groups</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>fig2a_m1_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(fig2a_m1_emm,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"revpairwise"</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The chunk above computes a contrast table that includes comparisons of all pairs of groups in the factor <span class="math inline">\(\texttt{treatment}\)</span> (this adds a 3rd comparison to the contrast table of planned comparisons above). The <em>t</em>-tests for the contrasts are derived from a single fit linear model.</p>
<p>In contrast to the analysis in the chunk above, researchers commonly fit separate <em>t</em>-tests for each pair of treatment levels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># classic t-test</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>test1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(fig2a[treatment <span class="sc">==</span> <span class="st">"Cold"</span>, diHOME],</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                fig2a[treatment <span class="sc">==</span> <span class="st">"Control"</span>, diHOME],</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(fig2a[treatment <span class="sc">==</span> <span class="st">"NE"</span>, diHOME],</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                fig2a[treatment <span class="sc">==</span> <span class="st">"Control"</span>, diHOME],</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>test3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(fig2a[treatment <span class="sc">==</span> <span class="st">"NE"</span>, diHOME],</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                fig2a[treatment <span class="sc">==</span> <span class="st">"Cold"</span>, diHOME],</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes</p>
<ol type="1">
<li>Again, the default t.test in R is the Welch t-test for heterogenous variance. To compute the Student t-test, use <code>var.equal = TRUE</code></li>
<li>To see the full <code>t.test</code> output, type “test1” into the console.</li>
</ol>
<p>Compare the <em>t</em> and <em>p</em> values from the three independent tests with the <em>t</em> and <em>p</em>-values from the single linear model.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t (lm)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p (lm)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t (t-test)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p (t-test)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cold - Control</td>
<td style="text-align: right;">1.562324</td>
<td style="text-align: right;">0.1405278</td>
<td style="text-align: right;">2.415122</td>
<td style="text-align: right;">0.0389207</td>
</tr>
<tr class="even">
<td style="text-align: left;">NE - Cold</td>
<td style="text-align: right;">1.674696</td>
<td style="text-align: right;">0.1161773</td>
<td style="text-align: right;">1.380666</td>
<td style="text-align: right;">0.2007006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NE - Control</td>
<td style="text-align: right;">3.395015</td>
<td style="text-align: right;">0.0043559</td>
<td style="text-align: right;">3.238158</td>
<td style="text-align: right;">0.0088971</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The <em>t</em> and <em>p</em>-values computed from three separate tests differ from the <em>t</em> and <em>p</em>-values computed from the single linear model shown in the contrasts table above. The values differ because the SE in the denominators used to compute the <span class="math inline">\(t\)</span>-values differ. The linear model uses the same value of <span class="math inline">\(\sigma\)</span> to compute the SED (the denominator of <em>t</em>) for all three t-tests in the contrast table. Each separate t-test uses a different value of <span class="math inline">\(\sigma\)</span> to compute the SED. Which is correct? Neither – they simply make different assumptions about the data generating model.</p>
<ol type="1">
<li>Most importantly, <strong>never</strong> do both methods, look at the <em>p</em>-values, and then convince yourself that the method with the <em>p</em>-values that match your hypothesis is the correct method. Human brains are very, very good at doing this. This is called p-hacking. When you p-hack, the interpretation of the <em>p</em>-value is effectively meaningless. P-hacking leads to irreproducible science.</li>
<li>In general, using the linear model is a better practice than the separate <em>t</em>-tests. The reason is the homogeneity of variance assumption. If we assume homogeneity of variances, then we can think of the sample standard deviation of all three groups as an estimate of <span class="math inline">\(\sigma\)</span>. In the linear model, we use three groups to estimate <span class="math inline">\(\sigma\)</span> but in each separate <em>t</em>-test, we use only two groups. Consequently, our estimate of <span class="math inline">\(\sigma\)</span> in the linear model is more precise than that in the <em>t</em>-tests. While the difference can be large with any individual data set (it’s pretty big with the fig2a data), the long-run advantage of using the linear model instead of separate <em>t</em>-tests is pretty small, especially with only three groups (the precision increases with more groups).</li>
<li>We can drop the homogeneity of variance assumption with either the linear model or the three, separate <em>t</em>-tests. This is outlined below in “Heterogeneity of variance”. In this case, the <em>t</em> and <em>p</em>-values for the three comparisons are the same. Still, the linear model (that models heterogenity) is better practice than the separate <em>t</em>-tests because the linear model is much more flexible and expandable.</li>
</ol>
</section>
</section>
</section>
<section id="working-in-r" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="working-in-r"><span class="header-section-number">10.2</span> Working in R</h2>
<section id="fit-the-model" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="fit-the-model"><span class="header-section-number">10.2.1</span> Fit the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(diHOME <span class="sc">~</span> treatment, <span class="at">data =</span> fig2a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>The two arguments are the model formula <code>diHOME ~ treatment</code> and the data object <code>fig2a</code>.</li>
<li>The model formula has the form <code>y ~ x</code>. I read this as “y as a function of x” but say “y squiggly x” when I’m speaking it out loud. <code>y</code> is the response variable <code>diHome</code>. Here, <code>x</code> is the factor <code>treatment</code>.</li>
<li>In this text, the <code>y</code> and <code>x</code> parts of the model formula will always be the names of columns of data in the data object. But, either or both can be vectors or matrices that are not in a data.table (or other kind of data object).</li>
<li>All functions that will be used to fit models in this text will use a model formula.</li>
<li>Many base R and package functions that are meant to be either “easy” or follow an ANOVA strategy use lists of dependent and independent variables instead of a model formula. We won’t use these because they are not consistent with a linear modeling way of thinking about data analysis.</li>
<li><code>treatment</code> was specifically coded as a factor variable in the import and wrangle chunk above and R will automatically create the correct indicator variables.</li>
<li>If categorical variables on the RHS of the formula have not be converted to factors by the user, then R will treat character variables as factors and create the indicator variables.</li>
</ol>
<section id="reordering-the-levels-of-the-factor-variables-to-some-meaningful-order" class="level4" data-number="10.2.1.1">
<h4 data-number="10.2.1.1" class="anchored" data-anchor-id="reordering-the-levels-of-the-factor-variables-to-some-meaningful-order"><span class="header-section-number">10.2.1.1</span> Reordering the levels of the factor variables to some meaningful order</h4>
<p>This book emphasizes ordering our factor levels in order to contro</p>
<ol type="1">
<li>the direction of coefficients in the coefficient table from the fit model</li>
<li>the order of groups of the emmeans table</li>
<li>the direction of contrasts in the contrast table</li>
<li>the ordering of the groups on the X axis of a ggplot</li>
</ol>
<p>To understand this better, peek at the ordering of the levels of <code>treatment</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(fig2a<span class="sc">$</span>treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Control" "Cold"    "NE"     </code></pre>
</div>
</div>
<ol type="1">
<li>The first level in this list is the <strong>reference level</strong>. Contrasts with this will be computed using the direction non_reference - reference. Almost always, we want our “control” or “wildtype” to be the reference because we want our contrast to be the effect of intervention.</li>
<li>To set the order of levels within a factor variable, use code like this, which I typically include within the import chunk immediately after the import</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>treatment_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Cold"</span>, <span class="st">"NE"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>fig2a[, treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(treatment,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> treatment_order)] <span class="co"># order levels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>The first line simply creates an object containing the group labels in the order that I want.</li>
<li>The second line converts treatment to a factor variable AND orders the levels to that in <code>treatment_order</code>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="What if I don't reorder factor levels?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What if I don’t reorder factor levels?
</div>
</div>
<div class="callout-body-container callout-body">
<p>The default ordering for a factor is alphabetical, so the default order for fig2a would be (“Cold”, “Control”, “NE”). This doesn’t change any statistical inference but it will create a plot in which the order of the groups on the horizontal axis is goofy and mindless.</p>
</div>
</div>
</section>
<section id="the-r-formula-can-include-transformations-such-as-logy" class="level4" data-number="10.2.1.2">
<h4 data-number="10.2.1.2" class="anchored" data-anchor-id="the-r-formula-can-include-transformations-such-as-logy"><span class="header-section-number">10.2.1.2</span> The R formula can include transformations such as log(y)</h4>
<p>If is common in biostatistics to log transform the response variable (this is common with count measures or things that grow geometrically). One could simply create a log-transformed column of the response variable and then use this log transformed column in the model formula.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fig2a[, diHOME_log <span class="sc">:</span><span class="er">=</span> <span class="fu">log</span>(diHOME)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A better way to do this is to simply do the transformation in the model formula itself. See the note for why!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>m1_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(diHOME) <span class="sc">~</span> treatment, <span class="at">data =</span> fig2a)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>m1_log_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1_log, <span class="at">specs =</span> <span class="st">"treatment"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>m1_log_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_log_emm,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"revpairwise"</span>) <span class="sc">|&gt;</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>m1_log_pairs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate    SE df lower.CL upper.CL t.ratio p.value
 Cold - Control    0.442 0.218 14   -0.129     1.01   2.026  0.1425
 NE - Control      0.751 0.208 14    0.206     1.30   3.606  0.0075
 NE - Cold         0.309 0.218 14   -0.263     0.88   1.413  0.3612

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 3 estimates 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>Notes</p>
<ol type="1">
<li><p>The <code>emmeans</code> and <code>contrast</code> functions are smart enough to recognize that you have a log transformation in the model formula, so these give you the estimates on the <strong>log scale</strong>. This means that the contrasts in the estimates column are the differences of the means of the log-transformed variables. And the SE and CIs are on this log scale. <em>2</em>.</p></li>
<li><p>You can see the back-transformed estimates and statistics on the <strong>response scale</strong> by adding a <code>type = "response</code> argument to the emmeans function.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>m1_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(diHOME) <span class="sc">~</span> treatment, <span class="at">data =</span> fig2a)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>m1_log_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1_log,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">specs =</span> <span class="st">"treatment"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>m1_log_pairs <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_log_emm,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"revpairwise"</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>m1_log_pairs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       ratio    SE df lower.CL upper.CL null t.ratio p.value
 Cold / Control  1.56 0.340 14    0.879     2.76    1   2.026  0.1425
 NE / Control    2.12 0.441 14    1.229     3.65    1   3.606  0.0075
 NE / Cold       1.36 0.297 14    0.769     2.41    1   1.413  0.3612

Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 3 estimates 
Intervals are back-transformed from the log scale 
P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale </code></pre>
</div>
</div>
<p>Notes</p>
<ol type="1">
<li>Now the contrast is a ratio instead of a difference. This is because the inverse log of a difference is a ratio!</li>
</ol>
<p><span class="math display">\[
log(\frac{a}{b}) = log(a) - log(b)
\]</span></p>
</section>
<section id="the-r-formula-can-include-object-type-transformations-such-as-factorx" class="level4" data-number="10.2.1.3">
<h4 data-number="10.2.1.3" class="anchored" data-anchor-id="the-r-formula-can-include-object-type-transformations-such-as-factorx"><span class="header-section-number">10.2.1.3</span> The R formula can include object type transformations such as factor(x)</h4>
<p>Sometimes we have a numeric or integer <span class="math inline">\(X\)</span> variable but want to model this as a categorical factor variable. For example, let’s create fake data with <code>glucose_uptake</code> measured at three different times in each mouse.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mouse_id =</span> <span class="fu">rep</span>(<span class="fu">paste</span>(<span class="st">"mouse"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">genotype =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"KO"</span>), <span class="at">each =</span> <span class="dv">6</span> <span class="sc">*</span> <span class="dv">3</span>),</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">glucose_uptake =</span> <span class="fu">rnorm</span>(<span class="dv">6</span> <span class="sc">*</span> <span class="dv">3</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In these data, <code>time</code> is a numeric variable. If we want to model <code>time</code> as a factor, we could create a new data column that contains the factor variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fake_data[, time_fac <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(time)]</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>m1_fake <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose_uptake <span class="sc">~</span> genotype <span class="sc">*</span> time_fac, <span class="at">data =</span> fake_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or we could just change the object time in the model formula</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>m1_fake <span class="ot">&lt;-</span> <span class="fu">lm</span>(glucose_uptake <span class="sc">~</span> genotype <span class="sc">*</span> <span class="fu">factor</span>(time), <span class="at">data =</span> fake_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes</p>
<ol type="1">
<li>In this text, we would not fit the above models but would instead use the model formula</li>
</ol>
<p><code>glucose_uptake ~ genotype * factor(time) + (1 | mouse_id)</code></p>
<p>but we haven’t gotten to this yet!</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Recognize that</p>
<p><code>glucose_uptake ~ genotype * time</code></p>
<p>and</p>
<p><code>glucose_uptake ~ genotype * factor(time)</code></p>
<p>are two different models! The first models time as a numeric variable while the second models time as a factor variable.</p>
</div>
</div>
</section>
</section>
<section id="controlling-the-output-in-tables-using-the-coefficient-table-as-an-example" class="level3" data-number="10.2.2">
<h3 data-number="10.2.2" class="anchored" data-anchor-id="controlling-the-output-in-tables-using-the-coefficient-table-as-an-example"><span class="header-section-number">10.2.2</span> Controlling the output in tables using the coefficient table as an example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(diHOME <span class="sc">~</span> treatment, <span class="at">data =</span> fig2a)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>m1_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(m1))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># or if we want the CIs of the coefficeints too</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>m1_coef <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(m1)),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">confint</span>(m1))</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>m1_coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Estimate Std. Error  t value    Pr(&gt;|t|)     2.5 %   97.5 %
(Intercept)   12.023075   3.081337 3.901902 0.001595771  5.414264 18.63189
treatmentCold  7.140386   4.570362 1.562324 0.140527829 -2.662066 16.94284
treatmentNE   14.794354   4.357669 3.395015 0.004355868  5.448083 24.14063</code></pre>
</div>
</div>
</section>
<section id="using-the-emmeans-function" class="level3" data-number="10.2.3">
<h3 data-number="10.2.3" class="anchored" data-anchor-id="using-the-emmeans-function"><span class="header-section-number">10.2.3</span> Using the emmeans function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="at">specs =</span> <span class="st">"treatment"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>m1_emm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> treatment emmean   SE df lower.CL upper.CL
 Control     12.0 3.08 14     5.41     18.6
 Cold        19.2 3.38 14    11.92     26.4
 NE          26.8 3.08 14    20.21     33.4

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Notes</p>
<ol start="8" class="example" type="1">
<li>Note that printing the <code>emmeans</code> object displays useful information. Here, this information includes the confidence level used. If the object is printed using <code>kable</code> (as in the “Inference” and “Understanding” sections above), only the table is printed and the additional information is lost.</li>
<li>emmeans computes the modeled means of all combinations of the levels of the factor variables specified in the argument <code>specs</code>.</li>
<li>An important argument of the emmeans function is <code>type =</code>, which controls the “space” of the response variable.</li>
<li>Output options are more complex if there are two or more X variables. This will be covered in the chapter “Models for two (or more) categorical X variables”.</li>
<li>If there are continuous covariates in the model, the modeled means are computed at the average values of these covariates. These covariates do not need to be passed to the <code>specs</code> argument.</li>
<li>You can pass numeric and integer covariates to <code>specs</code> to control the value of the covariates used to compute the modeled means. This is outlined in <a href="chapter-covariates">Adding covariates to a linear model</a></li>
</ol>
</section>
<section id="using-the-contrast-function" class="level3" data-number="10.2.4">
<h3 data-number="10.2.4" class="anchored" data-anchor-id="using-the-contrast-function"><span class="header-section-number">10.2.4</span> Using the contrast function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>m1_planned <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">"trt.vs.ctrl"</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">adjust =</span> <span class="st">"none"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">level =</span> <span class="fl">0.95</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>m1_planned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate   SE df lower.CL upper.CL t.ratio p.value
 Cold - Control     7.14 4.57 14    -2.66     16.9   1.562  0.1405
 NE - Control      14.79 4.36 14     5.45     24.1   3.395  0.0044

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Notes</p>
<ol type="1">
<li>Note that printing the <code>contrast</code> object displays useful information, including the confidence level used and the method of adjustment for multiple tests. If the object is printed using <code>kable() |&gt; kable_styling()</code> (as in the “Inference” and “Understanding” sections above), only the table is printed and the additional information is lost.</li>
<li>The <code>method</code> argument is used to control the set of contrasts that are computed. See below.</li>
<li>The <code>adjust</code> argument controls if and how to adjust for multiple tests. Each <code>method</code> has a default adjustment method. See below.</li>
<li>The <code>level</code> argument controls the percentile boundaries of the confidence interval. The default is 0.95. Including this argument with this value makes this level transparent.</li>
</ol>
<section id="the-method-argument-controls-the-set-of-contrasts" class="level4" data-number="10.2.4.1">
<h4 data-number="10.2.4.1" class="anchored" data-anchor-id="the-method-argument-controls-the-set-of-contrasts"><span class="header-section-number">10.2.4.1</span> the method argument controls the set of contrasts</h4>
<p>The <code>method =</code> argument is used to control the set of contrasts that are computed. Type <code>help("contrast-methods")</code> into the console to see the list of available methods. Also, read the <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html" target="_blank">comparisons and contrasts vignette</a> for more on <code>emmeans::contrast()</code></p>
<ol start="14" class="example" type="1">
<li><code>method = "revpairwise"</code> computes all pairwise contrasts. The contrasts that include the reference are in the direction <span class="math inline">\(nonreference - reference\)</span>, which is the direction prferred in this text since the result is the effect if you add the treatment. The default <em>p</em>-value adjustment is “tukey”, which is the <a href="https://en.wikipedia.org/wiki/Tukey%27s_range_test" target="_blank">Tukey’s HSD method</a></li>
<li><code>method = "pairwise"</code> is the default method. “pairwise” computes all pairwise contrasts but in the direction opposite to “revpairwise”. The default <em>p</em>-value adjustment is “tukey.”</li>
<li><code>method = "trt.vs.ctrl"</code> and <code>method = "dunnett"</code> are the same. These compute all non-reference minus reference contrasts. This method was used in the “Inference” section because it gives the two contrasts of the planned comparisons identified in the “understand the experimental design” step. The default <em>p</em>-value adjustment for multiple tests is “dunnettx”, which is <a href="https://en.wikipedia.org/wiki/Dunnett%27s_test" target="_blank">Dunnett’s test</a>.</li>
</ol>
<section id="method-revpairwise-or-pairwise" class="level5" data-number="10.2.4.1.1">
<h5 data-number="10.2.4.1.1" class="anchored" data-anchor-id="method-revpairwise-or-pairwise"><span class="header-section-number">10.2.4.1.1</span> method = “revpairwise” or “pairwise”</h5>
<p>Here are all pairwise contrasts using “revpairwise” and the default p-value adjustment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(m1_emm,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"revpairwise"</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate   SE df lower.CL upper.CL t.ratio p.value
 Cold - Control     7.14 4.57 14    -4.82     19.1   1.562  0.2936
 NE - Control      14.79 4.36 14     3.39     26.2   3.395  0.0114
 NE - Cold          7.65 4.57 14    -4.31     19.6   1.675  0.2490

Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 3 estimates 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>and using “pairwise” and the default p-value adjustment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(m1_emm,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"pairwise"</span>) <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate   SE df lower.CL upper.CL t.ratio p.value
 Control - Cold    -7.14 4.57 14    -19.1     4.82  -1.562  0.2936
 Control - NE     -14.79 4.36 14    -26.2    -3.39  -3.395  0.0114
 Cold - NE         -7.65 4.57 14    -19.6     4.31  -1.675  0.2490

Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 3 estimates 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>Notice that inference is the same, only the direction of the effect differs.</p>
</section>
<section id="method-dunnett" class="level5" data-number="10.2.4.1.2">
<h5 data-number="10.2.4.1.2" class="anchored" data-anchor-id="method-dunnett"><span class="header-section-number">10.2.4.1.2</span> method = “dunnett”</h5>
<p>Above, I used method “trt.vs.ctrl” to get only the treatment vs.&nbsp;control contrasts but, following my argument on adjusting for multiple tests, I also included the adjust = “none” argument. What if we want the classical Dunnett test, with adjustment?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(m1_emm,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"dunnett"</span>) <span class="sc">|&gt;</span> <span class="co"># could also use "trt.vs.ctrl"</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate   SE df lower.CL upper.CL t.ratio p.value
 Cold - Control     7.14 4.57 14    -4.17     18.5   1.562  0.2445
 NE - Control      14.79 4.36 14     4.01     25.6   3.395  0.0084

Confidence level used: 0.95 
Conf-level adjustment: dunnettx method for 2 estimates 
P value adjustment: dunnettx method for 2 tests </code></pre>
</div>
</div>
</section>
</section>
<section id="planned-comparisons-using-custom-contrasts" class="level4" data-number="10.2.4.2">
<h4 data-number="10.2.4.2" class="anchored" data-anchor-id="planned-comparisons-using-custom-contrasts"><span class="header-section-number">10.2.4.2</span> Planned comparisons using custom contrasts</h4>
<p>In any experiment with more than two groups, we have multiple contrasts (or “multiple tests”). Almost always, researchers are only interested in a subset of these. This subset of focal contrasts are <strong>planned comparisons</strong>. We can limit the number of contrasts computed by the <code>contrast()</code> function by passing a custom contrast object in <code>method =</code>.</p>
<p>Let’s say the focal contrasts are <code>Cold - Control</code> and <code>NE - Cold</code> but not the contrast <code>NE - Control</code>. To pass a custom contrast object with only these contrasts, I first peek at the emm object to see the order of group means.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>m1_emm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> treatment emmean   SE df lower.CL upper.CL
 Control     12.0 3.08 14     5.41     18.6
 Cold        19.2 3.38 14    11.92     26.4
 NE          26.8 3.08 14    20.21     33.4

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Now we use this to create the contrasts and send these to the <code>contrast()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>cntrl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>cold <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>ne <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>planned_contrasts <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cold - Control"</span> <span class="ot">=</span> cold <span class="sc">-</span> cntrl,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"NE - Cold"</span> <span class="ot">=</span> ne <span class="sc">-</span> cold)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(m1_emm,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> planned_contrasts,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">adjust =</span> <span class="st">"holm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate   SE df lower.CL upper.CL t.ratio p.value
 Cold - Control     7.14 4.57 14    -4.33     18.6   1.562  0.2324
 NE - Cold          7.65 4.57 14    -3.82     19.1   1.675  0.2324

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 2 estimates 
P value adjustment: holm method for 2 tests </code></pre>
</div>
</div>
<p>What did I do?</p>
<ol type="1">
<li>We have three means so I created three vectors of length 3.</li>
<li>Each vector contains a “1” in the position that indicates that group’s row in the emmeans table.</li>
<li>I then create the contrast object as a list containing the contrasts in the form</li>
</ol>
<p>“output contrast name” = group1 - group2</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Mindless <em>p</em>-values waste research time and money so contrasts take thought. Note that adjustments depend on the number of contrasts so if an advisor or reviewer or benighted colleague insists on adjusting for multiple tests, then fewer tests using this planned comparison approach will have higher power. However, all pairwise contrasts can be useful to a reader, so I would recommend creating a table with all pairwise contrasts with both unadjusted and adjusted <em>p</em>-values and adding this to a supplementary file.</p>
</div>
</div>
</section>
<section id="adjustment-for-multiple-tests" class="level4" data-number="10.2.4.3">
<h4 data-number="10.2.4.3" class="anchored" data-anchor-id="adjustment-for-multiple-tests"><span class="header-section-number">10.2.4.3</span> Adjustment for multiple tests</h4>
<p><a href="multiple-testing.html" class="quarto-xref"><span>Chapter 12</span></a> explains the hot-take – why there is no justification for adjusting <em>p</em>-values in many bench biology experiments that do adjust, but there is justification for adjusting <em>p</em>-values in many bench biology experiments that do not adjust!</p>
<p>Here, I just outline choices available in the <code>emmeans::contrast</code> function using the argument <code>adjust =</code>.</p>
<ol type="1">
<li>“none” – no adjustment</li>
<li>“dunnettx” – <a href="https://en.wikipedia.org/wiki/Dunnett%27s_test" target="_blank">Dunnett’s test</a> is a method used when comparing all treatments to a single control.</li>
<li>“tukey” – <a href="https://en.wikipedia.org/wiki/Tukey%27s_range_test" target="_blank">Tukey’s HSD method</a> is a method used to compare all pairwise comparisons.</li>
<li>“bonferroni” – <a href="https://en.wikipedia.org/wiki/Bonferroni_correction" target="_blank">Bonferroni</a> is a general purpose method to compare any set of multiple tests. The test is conservative. A better method is “holm”</li>
<li>“holm” – <a href="https://en.wikipedia.org/wiki/Holm–Bonferroni_method" target="_blank">Holm-Bonferroni</a> is a general purpose method like the Bonferroni but is more powerful.</li>
<li>“BH” or “fdr” – controls the <a href="https://en.wikipedia.org/wiki/False_discovery_rate" target="_blank">false discovery rate</a> not the Type I error rate for a family of tests.</li>
<li>“mvt” – based on the multivariate <em>t</em> distribution and using covariance structure of the variables.</li>
</ol>
</section>
</section>
<section id="how-to-generate-anova-tables" class="level3" data-number="10.2.5">
<h3 data-number="10.2.5" class="anchored" data-anchor-id="how-to-generate-anova-tables"><span class="header-section-number">10.2.5</span> How to generate ANOVA tables</h3>
<p>ANOVA is Analysis of Variance. Researchers frequently use the term “ANOVA” as the name for an analysis of an experiment with single-factor with more than two groups. However, ANOVA is a general method of inference for complex experimental designs. ANOVA models and regression models are different ways of expressing the same underlying linear model.</p>
<p>ANOVA tables can be useful for some sophisticated analyses. But for most researchers, an ANOVA table is more likely to lead to misconception than enlightenment. I would typpically recommend to never look at an ANOVA table. But, if your PI, manager, thesis committee, or journal editor insists that you do ANOVA, and you cannot convince them otherwise, here is how to generate an ANOVA table in R. Note that even though we are generating that table, the computation of the contrast table and all inference from that is not part of the ANOVA.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>ANOVA table for the Figure 2a (example 2) data.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum Sq</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Sq</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">treatment</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">656.9</td>
<td style="text-align: right;">328.4</td>
<td style="text-align: right;">5.765</td>
<td style="text-align: right;">0.015</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">797.5</td>
<td style="text-align: right;">57.0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Notes</p>
<ol type="1">
<li>Do not confuse the statistics in an ANOVA table with those in a coefficient table.</li>
<li>The ANOVA table @ref(tab:fig2a-anova-table) has two rows. The first row contains the statistics for the factor <span class="math inline">\(\texttt{treatment}\)</span>. The statistics address the null hypothesis “there is no effect of treatment – all groups have the same population mean”. This is a <em>p</em> value about the factor as a whole and not the individual comparisons of different groups within the factor.</li>
<li>The second row contains the statistics for the error – the residuals of the model.</li>
<li><span class="math inline">\(\texttt{F value}\)</span> is the test statistic. It is a ratio of variances, which is why this analysis is called Analysis of Variance. The numerator variance is the <span class="math inline">\(\texttt{Mean Sq}\)</span> of <span class="math inline">\(\texttt{treatment}\)</span>. The numerator variance is the value in $ of <span class="math inline">\(\texttt{treatment}\)</span>. The denominator variance is the value in $ of <span class="math inline">\(\texttt{Residuals}\)</span>.</li>
<li><span class="math inline">\(\texttt{Mean Sq}\)</span> contains the <strong>mean square</strong> for each term (row) in the table. The mean square is a variance. Remember that the numerator of a variance is a sum of squared differences between observed and mean values. The numerator of <span class="math inline">\(\texttt{Mean Sq}\)</span> is the value in <span class="math inline">\(\texttt{Sum Sq}\)</span> from the same row. And, remember that the denominator of a variance is a degree of freedom. The denominator of <span class="math inline">\(\texttt{Mean Sq}\)</span> is the value in <span class="math inline">\(\texttt{DF}\)</span> from the same row.</li>
</ol>
<p>An ANOVA table for a single factor with more than two groups has a single <em>p</em>-value for the treatment term. The single <em>p</em>-value is the probability of sampling a value of <em>F</em> as large or larger than the observed <em>F</em> under the null (no true effects of either treatment and all specifications of the generating model are true). There is not much we can do with this number - we want to estimate the effect sizes and their uncertainty and we don’t get this from an ANOVA table. Many textbooks, websites, and colleagues suggest to 1) fit the ANOVA, 2) check the <em>F</em>, and, if <span class="math inline">\(F &lt; 0.05\)</span>, 3) do “tests after an ANOVA”. These tests after an ANOVA are the planned comparisons and post-hoc tests described above using the linear model. In classical ANOVA, the initial computation of the cell means (means of treatment combinations) and sums of squares was a logical first step to the decomposition of these sums of squares to compute the contrasts. With modern linear models using regression, the ANOVA first step is unnecessary and not recommended.</p>
<section id="the-afex-aov_4-function" class="level4" data-number="10.2.5.1">
<h4 data-number="10.2.5.1" class="anchored" data-anchor-id="the-afex-aov_4-function"><span class="header-section-number">10.2.5.1</span> The afex aov_4 function</h4>
<p>The package afex was developed to make it much easier for researchers to generate ANOVA tables that look like those from other statistics packages including SAS, SPSS, JMP, and Graphpad Prism.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .I is a data.table function that returns the row number</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>fig2a[, fake_id <span class="sc">:</span><span class="er">=</span> <span class="fu">paste</span>(<span class="st">"mouse"</span>, .I)]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>m1_aov4 <span class="ot">&lt;-</span> <span class="fu">aov_4</span>(diHOME <span class="sc">~</span> treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>fake_id),</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> fig2a)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1_aov4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: diHOME
          num Df den Df    MSE      F     ges  Pr(&gt;F)  
treatment      2     14 56.968 5.7651 0.45163 0.01491 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Notes</p>
<ol type="1">
<li>The afex package has three function names for generating the same ANOVA table and statistics – here I’m using <code>aov_4</code> because this functions uses a linear model formula argument (specifically, that used in the lme4 package), which is consistent with the rest of this text.</li>
<li>The formula includes the addition of a random factor (<code>(1|id)</code>) even though there really is no random factor in this model. See Section @ref(oneway-paired-t) below for a brief explanation of a random factor. The random factor (the factor variable “id” created in the line before the fit model line) identifies the individual mouse from which the response variable was measured. Because the response was only measured once on each individual mouse, “id” is not really a random factor but the addition of this in the model formula is necessary for the <code>aov_4</code> function to work.</li>
<li>It is easy to get an ANOVA table that you don’t want in R. If you want an ANOVA table that matches one from Graphpad Prism or JMP or similar software, the best practice is using the ANOVA functions from the afex package.</li>
<li>What do I mean by “an ANOVA table that you don’t want”? With factorial ANOVA with unbalanced data, there are three ways to compute the sums of squares for the different terms of the ANOVA table. SAS termed these Type I, II, and III sums of squares and these names have stuck. Following SAS, almost all statistics packages use Type III as the default (or only) method for computing ANOVA tables. R uses Type I as the default. There are very good arguments for using Type II. This distinction is moot for single factor ANOVA or multi-factor ANOVA for balanced designs but is not moot for unbalanced multi-factor ANOVA or any ANOVA with covariates. If you want an ANOVA table from R to match what would be generated by Graphpad Prism or JMP (Type III), then the afex package is the best practice.</li>
</ol>
</section>
<section id="the-car-anova-function" class="level4" data-number="10.2.5.2">
<h4 data-number="10.2.5.2" class="anchored" data-anchor-id="the-car-anova-function"><span class="header-section-number">10.2.5.2</span> The car Anova function</h4>
<p>The car package has the extremely useful <code>Anova</code> function although using it is a bit like doing brain surgery having only watched a youtube video.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>type3 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">treatment =</span> contr.sum)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>m1_type3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(diHOME <span class="sc">~</span> treatment,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> fig2a,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">contrasts =</span> type3)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m1_type3, <span class="at">type=</span><span class="st">"3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: diHOME
            Sum Sq Df  F value   Pr(&gt;F)    
(Intercept) 6308.4  1 110.7355 4.95e-08 ***
treatment    656.9  2   5.7651  0.01491 *  
Residuals    797.5 14                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Notes</p>
<ol type="1">
<li><code>car::Anova</code> has arguments for reporting the Type III sum of squares. Again, this is not relevant to a single factor ANOVA with no covariates but to avoid catastrophic code in the future, its good to know about best practices now, so I’m pre-peating what is written in Section @ref(twoway-car-anova).</li>
<li>Background: The default model matrix in the <code>lm</code> function uses dummy (or treatment) coding. For a Type 3 SS ANOVA (the kind that matches that in Graphpad Prism or JMP), we need to tell <code>lm</code> to use sum (or deviation) coding.</li>
<li>The best practice method for changing the contrasts in the model matrix is using the <code>contrasts</code> argument within the <code>lm</code> function, as in the code above to fit <code>m1_type3</code>. This is the safest practice because this sets the contrasts only for this specific fit.</li>
<li>The coefficients of <code>m1_type3</code> will be different from <code>m1</code>. The intercept will be the grand mean and the coefficients of the non-reference levels (the effects) will be their deviations from the grand mean. I don’t find this definition of “effects” very useful for most experiments in biology.</li>
<li>The contrasts (differences in the means among pairs of groups) in the contrast table will be the same, regardless of the contrast coding.</li>
</ol>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Danger! Many online sites suggest this bit of code before a Type III ANOVA using car::Anova()</p>
<p><code>options(contrasts = c("contr.sum", "contr.poly")</code></p>
<p>If you’re reading this book, you almost certainly don’t want to do this because this code resets how R computes coefficients of linear models and SS of ANOVA tables. This will effect all future analyses until the contrasts are set to something else or a new R session is started.</p>
</div>
</div>
<p><strong>base R aov and anova</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>m1_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(diHOME <span class="sc">~</span> treatment, <span class="at">data =</span> fig2a)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
treatment    2  656.9   328.4   5.765 0.0149 *
Residuals   14  797.5    57.0                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
1 observation deleted due to missingness</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same as m1 in the Example 2 section</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(diHOME <span class="sc">~</span> treatment, <span class="at">data =</span> fig2a)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: diHOME
          Df Sum Sq Mean Sq F value  Pr(&gt;F)  
treatment  2 656.85  328.43  5.7651 0.01491 *
Residuals 14 797.55   56.97                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Notes</p>
<ol type="1">
<li>Many introduction to statistics textbooks and websites use the base R <code>aov</code> function. I don’t find this function useful given the afex package functions.</li>
<li>The base R <code>anova</code> is useful if you know what you are doing with it.</li>
</ol>
</section>
</section>
</section>
<section id="hidden-code" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="hidden-code"><span class="header-section-number">10.3</span> Hidden Code</h2>
<section id="importing-and-wrangling-the-fig3d-data-for-example-1" class="level3" data-number="10.3.1">
<h3 data-number="10.3.1" class="anchored" data-anchor-id="importing-and-wrangling-the-fig3d-data-for-example-1"><span class="header-section-number">10.3.1</span> Importing and wrangling the fig3d data for example 1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>data_folder <span class="ot">&lt;-</span> <span class="st">"data"</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>data_from <span class="ot">&lt;-</span> <span class="st">"The cold-induced lipokine 12,13-diHOME promotes fatty acid transport into brown adipose tissue"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># need data_folder and data_from from earlier chunk</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">"41591_2017_BFnm4297_MOESM3_ESM.xlsx"</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ignore the column with animal ID. Based on methods, I am inferring</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># that the six mice in vehicle group *are different* from the</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co"># six mice in the 1213 group.</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>col_names_3d <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Vehicle"</span>, <span class="st">"1213"</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>treatment_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Vehicle"</span>, <span class="st">"12,13-diHOME"</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>fig3d <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sheet =</span> <span class="st">"Figure 3d"</span>,</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">range =</span> <span class="st">"B3:C9"</span>,</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">measure.vars =</span> col_names_3d,</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">variable.name =</span> <span class="st">"treatment"</span>,</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">value.name =</span> <span class="st">"serum_tg"</span>)</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="co"># change group name of "1213"</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>fig3d[treatment <span class="sc">==</span> <span class="st">"1213"</span>, treatment <span class="sc">:</span><span class="er">=</span> <span class="st">"12,13-diHOME"</span>]</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a><span class="co"># make treatment a factor with the order in "treatment_levels"</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>fig3d[, treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(treatment, treatment_levels)]</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="co">#View(fig3d)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-and-wrangling-the-fig2a-data-for-example-2" class="level3" data-number="10.3.2">
<h3 data-number="10.3.2" class="anchored" data-anchor-id="importing-and-wrangling-the-fig2a-data-for-example-2"><span class="header-section-number">10.3.2</span> Importing and wrangling the fig2a data for example 2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">"41591_2017_BFnm4297_MOESM2_ESM.xlsx"</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(data_folder, data_from, file_name)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co"># assuming mice are independent and not same mouse used for all three treatment</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>melt_col_names <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Animal"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>fig2a <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sheet =</span> <span class="st">"Fig 2a"</span>,</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">range =</span> <span class="st">"A3:G6"</span>,</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">measure.vars =</span> melt_col_names,</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">variable.name =</span> <span class="st">"id"</span>,</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">value.name =</span> <span class="st">"diHOME"</span>) <span class="co"># cannot start a variable with number</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(fig2a, <span class="at">old =</span> <span class="fu">colnames</span>(fig2a)[<span class="dv">1</span>], <span class="at">new =</span> <span class="st">"treatment"</span>)</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="co"># make better group names for analysis</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>fig2a[treatment <span class="sc">==</span> <span class="st">"1 hour cold"</span>, treatment <span class="sc">:</span><span class="er">=</span> <span class="st">"Cold"</span>]</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>fig2a[treatment <span class="sc">==</span> <span class="st">"30 min NE"</span>, treatment <span class="sc">:</span><span class="er">=</span> <span class="st">"NE"</span>]</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>treatment_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Cold"</span>, <span class="st">"NE"</span>)</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>fig2a[, treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(treatment, treatment_order)] <span class="co"># order levels</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a><span class="co">#View(fig2a)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/middleprofessor\.github\.io\/benchbiostats\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/continuous_x.html" class="pagination-link" aria-label="Linear models with a single, continuous *X* (&quot;linear regression&quot;)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Linear models with a single, continuous <em>X</em> (“linear regression”)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/model-checking.html" class="pagination-link" aria-label="Model checking">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model checking</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>